Commit Message,Name,Email,Updated at,Files Changed,Contributor,All Checks Passed
"compat: Update forward compatibility horizon to 2024-04-21

PiperOrigin-RevId: 626759944",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-21 09:02:47,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Update GraphDef version to 1839.

PiperOrigin-RevId: 626759810",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-21 09:02:16,tensorflow/core/public/version.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 626733610",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-21 05:37:03,tensorflow/lite/toco/python/toco_python_api.cc,tensorflower-gardener,False
"Eliminate call to StreamExecutor::implementation() now that StreamExecutor inherits from StreamExecutorInterface.

PiperOrigin-RevId: 626685442",Kyle Lucke,klucke@google.com,2024-04-20 23:07:20,"tensorflow/core/tpu/kernels/tpu_reshard_variables_op_util.cc, third_party/xla/xla/stream_executor/command_buffer.cc, third_party/xla/xla/stream_executor/event.cc, third_party/xla/xla/stream_executor/gpu/gpu_command_buffer.cc, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/kernel.cc, third_party/xla/xla/stream_executor/stream.cc, third_party/xla/xla/stream_executor/tpu/tpu_on_demand_compiler.cc, third_party/xla/xla/stream_executor/tpu/tpu_transfer_manager.cc",klucke,False
"Automated Code Change

PiperOrigin-RevId: 626671659",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 21:02:24,"tensorflow/lite/delegates/gpu/common/tasks/BUILD, tensorflow/lite/delegates/gpu/common/tasks/elementwise.h, tensorflow/lite/delegates/gpu/common/tasks/elementwise_test_util.cc, tensorflow/lite/delegates/gpu/common/tasks/fully_connected.cc, tensorflow/lite/delegates/gpu/common/tasks/fully_connected.h, tensorflow/lite/delegates/gpu/common/tasks/fully_connected_test_util.cc, tensorflow/lite/delegates/gpu/common/tasks/gather.cc, tensorflow/lite/delegates/gpu/common/tasks/gather.h, tensorflow/lite/delegates/gpu/common/tasks/gather_test_util.cc",tensorflower-gardener,False
"Reverts ed7d077f12525083d9e0d429e57de0e9206e1935

PiperOrigin-RevId: 626641263",Kyle Lucke,klucke@google.com,2024-04-20 16:35:28,third_party/xla/xla/service/gpu/autotuner_util.h,klucke,False
"Automated Code Change

PiperOrigin-RevId: 626618114",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 13:08:20,"tensorflow/lite/toco/import_tensorflow.cc, tensorflow/lite/toco/toco_convert.cc, tensorflow/lite/toco/toco_port.cc, tensorflow/lite/toco/toco_tooling.cc, tensorflow/lite/toco/tooling_util.h, tensorflow/lite/toco/tooling_util_test.cc",tensorflower-gardener,False
"NFC: Use the free function variants for `dyn_cast/cast/isa/...`.

The member functions in `Type/Attribute/Value/Location/AffineExpr` are [deprecated](https://mlir.llvm.org/deprecation) and will go away.

PiperOrigin-RevId: 626597388",Christian Sigg,csigg@google.com,2024-04-20 10:15:57,"third_party/xla/xla/python/ifrt/ir/ifrt_dialect.cc, third_party/xla/xla/python/ifrt/ir/ifrt_ops.cc, third_party/xla/xla/python/ifrt/ir/transforms/ifrt_verify_sharding_specified_pass.cc, third_party/xla/xla/python/ifrt/ir/transforms/spmd_expansion_pass.cc",chsigg,False
"Automated Code Change

PiperOrigin-RevId: 626594463",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 09:54:33,tensorflow/core/ir/utils/shape_inference_utils_test.cc,tensorflower-gardener,False
"Update GraphDef version to 1838.

PiperOrigin-RevId: 626587751",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 09:02:19,tensorflow/core/public/version.h,tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-20

PiperOrigin-RevId: 626587723",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 09:02:08,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"[PJRT] Change CreateErrorBuffer to take PjRtMemorySpace rather than PjRtDevice.

PiperOrigin-RevId: 626581204",Ce Zheng,zce@google.com,2024-04-20 08:14:00,"third_party/xla/xla/pjrt/cpu/cpu_client.cc, third_party/xla/xla/pjrt/cpu/cpu_client.h, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.h",cezheng,False
"Automated Code Change

PiperOrigin-RevId: 626575980",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 07:35:08,tensorflow/core/profiler/profiler.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 626569134",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 06:49:38,tensorflow/compiler/mlir/quantization/tensorflow/quantize_preprocess.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 626565285",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 06:19:44,"tensorflow/c/experimental/filesystem/plugins/windows/BUILD, tensorflow/c/experimental/filesystem/plugins/windows/windows_filesystem.cc",tensorflower-gardener,False
"Reduce log spam from AbstractAsyncHostToHostMemoryTransferManager

PiperOrigin-RevId: 626565223",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 06:19:10,third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 626562306",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 05:58:56,"tensorflow/core/tfrt/saved_model/python/saved_model_load_and_run.cc, tensorflow/core/tfrt/saved_model/python/saved_model_load_and_run.h",tensorflower-gardener,False
"Add support for nested tuples in BorrowingLiteral

PiperOrigin-RevId: 626559447",Eugene Zhulenev,ezhulenev@google.com,2024-04-20 05:35:57,"third_party/xla/xla/BUILD, third_party/xla/xla/literal.cc, third_party/xla/xla/literal.h, third_party/xla/xla/literal_test.cc",ezhulenev,False
"Add a ShapeTree::Map with StatusOr result.

PiperOrigin-RevId: 626558073",Eugene Zhulenev,ezhulenev@google.com,2024-04-20 05:25:09,third_party/xla/xla/shape_tree.h,ezhulenev,False
"Automated Code Change

PiperOrigin-RevId: 626552328",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 04:42:32,"tensorflow/compiler/mlir/tfrt/BUILD, tensorflow/compiler/mlir/tfrt/function/function.cc",tensorflower-gardener,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/cba970ca884bbfcce18a020a0afb32dd1e6581a0.

PiperOrigin-RevId: 626532654",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 02:30:43,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Integrate LLVM at llvm/llvm-project@7fcca112034f

Updates LLVM usage to match
[7fcca112034f](https://github.com/llvm/llvm-project/commit/7fcca112034f)

PiperOrigin-RevId: 626525725",Jorge Gorbe Moya,jgorbe@google.com,2024-04-20 01:51:46,third_party/llvm/workspace.bzl,slackito,False
"Moves the 'Solver took' time logic to include construction of the solver & model.

PiperOrigin-RevId: 626524232",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-20 01:41:49,third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_solver.cc,tensorflower-gardener,False
"Move the host tensor sharding from IfrtLoadVariable kernel to IfrtCallOp Kernel.

PiperOrigin-RevId: 626507751",Siqiao Wu,siqiaowu@google.com,2024-04-20 00:18:00,"tensorflow/compiler/mlir/tensorflow/ir/host_runtime/tfrt_ops.td, tensorflow/compiler/mlir/tfrt/transforms/ifrt/ifrt_backend_compiler.cc, tensorflow/core/tfrt/ifrt/BUILD, tensorflow/core/tfrt/ifrt/ifrt_executable_registry_test.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.h, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils_test.cc, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.cc, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.h, tensorflow/core/tfrt/ifrt/ifrt_serving_executable_test.cc, tensorflow/core/tfrt/mlrt/kernel/BUILD, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel.cc, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel_test.cc",SiqiaoWu1993,False
"[XLA] Fix some comments, remove last bits of special handling of 4-bit types

PiperOrigin-RevId: 626490268",David Majnemer,majnemer@google.com,2024-04-19 22:51:31,"third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/primitive_util.h, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/service/convert_mover.cc, third_party/xla/xla/service/cpu/cpu_compiler.cc, third_party/xla/xla/service/gpu/fusions/input_slices.h, third_party/xla/xla/service/gpu/fusions/input_slices_mlir.h, third_party/xla/xla/service/gpu/fusions/loop.cc, third_party/xla/xla/service/gpu/hlo_fusion_analysis.cc, third_party/xla/xla/service/gpu/hlo_fusion_analysis.h, third_party/xla/xla/service/gpu/horizontal_loop_fusion.cc, third_party/xla/xla/service/gpu/ir_emitter_unnested.cc, third_party/xla/xla/service/sub_byte_normalization.h, third_party/xla/xla/translate/hlo_to_mhlo/hlo_utils.cc, third_party/xla/xla/util.h",majnemer,False
"Don't call StreamExecutor::GetAllocator in AutotuneConfig as an intermediate step to eliminate a circular dependency with DeviceMemoryAllocator.

PiperOrigin-RevId: 626488600",Kyle Lucke,klucke@google.com,2024-04-19 22:43:21,third_party/xla/xla/service/gpu/autotuner_util.h,klucke,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/fc58ce0031ace5ccbcb8c9c1fb390fc22e88996c.

PiperOrigin-RevId: 626483957",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 22:24:27,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Integrate LLVM at llvm/llvm-project@82c320ca5974

Updates LLVM usage to match
[82c320ca5974](https://github.com/llvm/llvm-project/commit/82c320ca5974)

PiperOrigin-RevId: 626475373",Jorge Gorbe Moya,jgorbe@google.com,2024-04-19 21:47:44,"third_party/llvm/generated.patch, third_party/llvm/workspace.bzl",slackito,False
"Fix the CPU full failure. Initialize the data in default constructor.

PiperOrigin-RevId: 626470781",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 21:29:50,tensorflow/lite/experimental/shlo/i4.h,tensorflower-gardener,False
"Create a DeviceMemoryAllocator in HloRunner as a step in resolving circular dependencies between DeviceMemoryAllocator and StreamExecutor.

PiperOrigin-RevId: 626461910",Kyle Lucke,klucke@google.com,2024-04-19 20:56:30,"third_party/xla/xla/service/hlo_runner.cc, third_party/xla/xla/service/hlo_runner.h",klucke,False
"Add containers with CUDA 12.3, CUDNN 8.9.

PiperOrigin-RevId: 626461662",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 20:55:34,"tensorflow/tools/ci_build/Dockerfile.rbe.cuda12.3-cudnn8.9-ubuntu22.04-manylinux2014-multipython, tensorflow/tools/toolchains/remote_config/configs.bzl, tensorflow/tools/toolchains/remote_config/containers.bzl, third_party/xla/third_party/tsl/tools/toolchains/remote_config/configs.bzl, third_party/xla/third_party/tsl/tools/toolchains/remote_config/containers.bzl, third_party/xla/tools/toolchains/remote_config/configs.bzl, third_party/xla/tools/toolchains/remote_config/containers.bzl",tensorflower-gardener,False
"improve some logging in heap simulator

PiperOrigin-RevId: 626445964",Ryan M. Lefever,lefever@google.com,2024-04-19 19:54:57,third_party/xla/xla/service/heap_simulator/heap_simulator.cc,sparc1998,False
"Create and cache a DeviceMemoryAllocator in GemmFusionAutotuner rather than the one in StreamExecutor as an intermediate step in eliminating a circular dependency between the two classes.

PiperOrigin-RevId: 626445786",Kyle Lucke,klucke@google.com,2024-04-19 19:54:08,third_party/xla/xla/service/gpu/gemm_fusion_autotuner.cc,klucke,False
"Create a DeviceMemoryAllocator in HloTestBase rather than use the one in the StreamExecutor.

This is a step in reducing circular dependencies between StreamExecutor and DeviceMemoryAllocator.

PiperOrigin-RevId: 626444336",Kyle Lucke,klucke@google.com,2024-04-19 19:48:18,"third_party/xla/xla/tests/hlo_test_base.cc, third_party/xla/xla/tests/hlo_test_base.h",klucke,False
"bugfix hlo_parser output missing layout for ReplicaId and PartitionId

PiperOrigin-RevId: 626442270",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 19:39:40,"third_party/xla/xla/service/hlo_parser.cc, third_party/xla/xla/service/hlo_parser_test.cc, third_party/xla/xla/service/spmd/spmd_partitioner_test.cc, third_party/xla/xla/service/spmd/whole_graph_manual_pass_test.cc",tensorflower-gardener,False
"Use the cached allocator pointer rather than looking it up again when creating XlaScopedShapedBuffers and ScopedDeviceMemories.

PiperOrigin-RevId: 626440211",Kyle Lucke,klucke@google.com,2024-04-19 19:31:40,"third_party/xla/xla/stream_executor/tpu/c_api_conversions.cc, third_party/xla/xla/stream_executor/tpu/c_api_conversions.h, third_party/xla/xla/stream_executor/tpu/tpu_executable.cc",klucke,False
"Use a stream from GetDeviceToHostStream instead of BorrowStreamFromPool

PiperOrigin-RevId: 626436159",Yifan Jiang,yifanjiang@google.com,2024-04-19 19:15:05,third_party/xla/xla/pjrt/gpu/se_gpu_pjrt_client.cc,yifjiang,False
"PR #11654: [ROCm] Remove AllocateOwnedArray from rocm code.

Imported from GitHub PR https://github.com/openxla/xla/pull/11654

Copybara import of the project:

--
30ce2b21d9e9ea7e8c474441f0b3745eef5ecd5b by Zoran Jovanovic <zjovanov@amd.com>:

[ROCm] Remove AllocateOwnedArray from rocm code.

Merging this change closes #11654

PiperOrigin-RevId: 626425756",zoranjovanovic-ns,126815388+zoranjovanovic-ns@users.noreply.github.com,2024-04-19 18:36:12,"third_party/xla/xla/service/gpu/runtime/cholesky_thunk.cc, third_party/xla/xla/stream_executor/rocm/rocm_dnn.cc",zoranjovanovic-ns,False
"Remove duplicate dependency in TSL

PiperOrigin-RevId: 626414844",David Dunleavy,ddunleavy@google.com,2024-04-19 18:01:19,third_party/xla/third_party/tsl/workspace2.bzl,ddunl,False
"Move ScopedModuleHandle into its own header file and add unit tests.

PiperOrigin-RevId: 626412484",Kyle Lucke,klucke@google.com,2024-04-19 17:53:46,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/gpu_executable.h, third_party/xla/xla/stream_executor/BUILD, third_party/xla/xla/stream_executor/mock_stream_executor.h, third_party/xla/xla/stream_executor/scoped_module_handle.h, third_party/xla/xla/stream_executor/scoped_module_handle_test.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"Stop using DeviceMemoryAllocator to create and cache streams in AutotuneConfig.

PiperOrigin-RevId: 626411069",Kyle Lucke,klucke@google.com,2024-04-19 17:49:32,third_party/xla/xla/service/gpu/autotuner_util.h,klucke,False
"Get the Stream from the AutotuneConfig rather than the allocator in GemmFusionAutotuner.

PiperOrigin-RevId: 626410366",Kyle Lucke,klucke@google.com,2024-04-19 17:47:16,third_party/xla/xla/service/gpu/gemm_fusion_autotuner.cc,klucke,False
"[PJRT C API] Add stream extension to support DLPack and implement this extension in CUDA plugin.

PiperOrigin-RevId: 626408630",Jieying Luo,jieying@google.com,2024-04-19 17:41:20,"third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/c/BUILD, third_party/xla/xla/pjrt/c/CHANGELOG.md, third_party/xla/xla/pjrt/c/pjrt_c_api.h, third_party/xla/xla/pjrt/c/pjrt_c_api_gpu_internal.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_stream_extension.h, third_party/xla/xla/pjrt/pjrt_c_api_client.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.h",jyingl3,False
"Integrate StableHLO at openxla/stablehlo@52172972

PiperOrigin-RevId: 626403352",Michael Levesque-Dion,mlevesquedion@google.com,2024-04-19 17:24:09,"third_party/stablehlo/temporary.patch, third_party/stablehlo/workspace.bzl, third_party/xla/third_party/stablehlo/temporary.patch, third_party/xla/third_party/stablehlo/workspace.bzl, third_party/xla/xla/mlir_hlo/mhlo/IR/hlo_ops.cc",mlevesquedion,False
"Avoid overflows in check whether there is enough available input space

bytes_to_write can overflow int32 in a way that makes it look smaller than
AvailableInputSpace(). Instead do the comparison using size_t.

PiperOrigin-RevId: 626402022",Adrian Kuegel,akuegel@google.com,2024-04-19 17:19:46,third_party/xla/third_party/tsl/tsl/lib/io/zlib_outputbuffer.cc,akuegel,False
"[XLA] Use URem instead of SRem for sub-byte index calculation

PiperOrigin-RevId: 626401440",David Majnemer,majnemer@google.com,2024-04-19 17:17:57,"third_party/xla/xla/service/llvm_ir/ir_array.cc, third_party/xla/xla/service/llvm_ir/ir_array.h, third_party/xla/xla/service/llvm_ir/ir_array_test.cc",majnemer,False
"Automated Code Change

PiperOrigin-RevId: 626389307",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 16:33:56,tensorflow/lite/delegates/xnnpack/BUILD,tensorflower-gardener,False
"Internal Code Change

PiperOrigin-RevId: 626385736",Shawn Lu,xiaoxlu@google.com,2024-04-19 16:20:31,tensorflow/lite/kernels/BUILD,xiaoxlu,False
Enable quantized matmul fusions.,mdfaijul,md.faijul.amin@intel.com,2023-09-07 00:56:01,"tensorflow/core/kernels/mkl/BUILD, tensorflow/core/kernels/mkl/mkl_fused_ops_test.cc, tensorflow/core/kernels/mkl/mkl_kernel_util.cc, tensorflow/core/kernels/mkl/mkl_kernel_util.h, tensorflow/core/kernels/mkl/mkl_matmul_op_fused.cc, tensorflow/core/kernels/mkl/mkl_matmul_ops_common.h, tensorflow/core/kernels/mkl/mkl_qmatmul_op.cc, tensorflow/core/kernels/mkl/mkl_qmatmul_op_test.cc, tensorflow/core/kernels/mkl/onednn_fused_matmul_ops_test.cc, tensorflow/core/ops/mkl_nn_ops.cc",mdfaijul,True
"[IFRT] Add `xla::ifrt::IoCallableProgram` type

`xla::ifrt::IoCallableProgram` represents a user program (tentatively named an
""I/O callable"") that can be compiled into and executed as an
`xla::ifrt::LoadedExecutable`.

The main role of `IoCallableProgram` is to define a standard representation for
a range of programs that satisfy:

* Can be efficiently serialized into a string.
* Have a fixed list of devices used for executions. (**)
* All inputs and outputs are IFRT `Array`s.
* Have input and output array types statically known in advance to compilation
or execution. (**)
* Do not expect the IFRT user to help manage their internal state. The IFRT
user can destroy `xla::ifrt::LoadedExecutable` any time.

(**) indicates differences from more flexible `xla::ifrt::PluginProgram`.

Similar to how IFRT implementations decide whether to support specific IFRT
program types, the implementations can decide what the types of I/O callables
to support.

PiperOrigin-RevId: 626366446",Hyeontaek Lim,hyeontaek@google.com,2024-04-19 15:00:33,"third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/io_callable_program.cc, third_party/xla/xla/python/ifrt/io_callable_program.h, third_party/xla/xla/python/ifrt/io_callable_program.proto, third_party/xla/xla/python/ifrt/io_callable_program_serdes.cc, third_party/xla/xla/python/ifrt/io_callable_program_serdes_test.cc",hyeontaek,False
Fix Windows compilation issue.,mdfaijul,md.faijul.amin@intel.com,2024-02-06 05:27:11,tensorflow/core/kernels/mkl/mkl_quantize_op.cc,mdfaijul,True
Address review comments.,mdfaijul,md.faijul.amin@intel.com,2024-01-24 16:12:05,tensorflow/core/kernels/mkl/mkl_quantize_op.cc,mdfaijul,True
Optimize MIN_FIRST quantization with oneDNN.,mdfaijul,md.faijul.amin@intel.com,2023-08-18 15:00:08,"tensorflow/core/kernels/mkl/mkl_quantize_op.cc, tensorflow/core/kernels/mkl/mkl_quantize_op_test.cc",mdfaijul,True
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/ad7abc01b63e0349f1010df04dc134476ee6031d.

PiperOrigin-RevId: 626366275",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 15:00:00,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Update the XNNPack version.

PiperOrigin-RevId: 626362741",Alan Kelly,alankelly@google.com,2024-04-19 14:42:54,"tensorflow/lite/tools/cmake/modules/xnnpack.cmake, tensorflow/workspace2.bzl",alankelly,False
"Integrate LLVM at llvm/llvm-project@7aad1ee70f2c

Updates LLVM usage to match
[7aad1ee70f2c](https://github.com/llvm/llvm-project/commit/7aad1ee70f2c)

PiperOrigin-RevId: 626358682",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 14:24:32,"third_party/llvm/generated.patch, third_party/llvm/workspace.bzl, third_party/xla/xla/mlir_hlo/tests/Dialect/bufferization/hlo_one_shot_bufferize.mlir",tensorflower-gardener,False
"Enable f8.

I decided to port the conversion function from ml_dtypes (with one fix
that's not yet submitted there) instead of the legacy XLA logic, since
the latter isn't generic and quite a bit more code.

Tested with convert_test_gpu, float8_test_gpu, JAX test suite.

PiperOrigin-RevId: 626350172",Johannes Reifferscheid,jreiffers@google.com,2024-04-19 13:40:42,"third_party/xla/xla/mlir_hlo/mhlo/transforms/map_mhlo_to_scalar_op.h, third_party/xla/xla/service/gpu/fusions/mlir/BUILD, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/expand_float_ops.cc",jreiffers,False
"[XLA:GPU] Remove unused function declaration.

PiperOrigin-RevId: 626339168",Alexander Lyashuk,crem@google.com,2024-04-19 12:45:04,third_party/xla/xla/service/gpu/gemm_algorithm_picker.h,mooskagh,False
"[XLA:GPU] Fix a bug in ProvideParameters

It did not handle the case when the subgraph has more than one root.

PiperOrigin-RevId: 626298839",Adrian Kuegel,akuegel@google.com,2024-04-19 09:15:00,"third_party/xla/xla/service/gpu/fusions/concatenate_mlir.cc, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir.cc, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir_test.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.h, third_party/xla/xla/service/gpu/fusions/reduction_mlir.cc, third_party/xla/xla/service/gpu/fusions/scatter_mlir.cc, third_party/xla/xla/service/gpu/fusions/transpose_mlir.cc",akuegel,False
"Update GraphDef version to 1837.

PiperOrigin-RevId: 626296025",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 09:02:21,tensorflow/core/public/version.h,tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-19

PiperOrigin-RevId: 626295975",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 09:02:07,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Re-enable cublas fallback test (added result to test DB)

This change makes sure that autotuning is not triggered on A100.
Testing on other GPUs will require adding more autotuning DB entries, or re-writing the test entirely.

PiperOrigin-RevId: 626295116",Sergey Kozub,sergeykozub@google.com,2024-04-19 08:58:19,"third_party/xla/xla/service/gpu/gpu_compiler_test.cc, third_party/xla/xla/service/gpu/gpu_compiler_test_autotune_db.textproto",sergeykozub,False
"Fix llvm_gpu_backend build defines

PiperOrigin-RevId: 626282953",Sergey Kozub,sergeykozub@google.com,2024-04-19 08:01:02,third_party/xla/xla/service/gpu/llvm_gpu_backend/BUILD,sergeykozub,False
"Automated Code Change

PiperOrigin-RevId: 626276420",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 07:24:48,"tensorflow/core/grappler/verifiers/BUILD, tensorflow/core/grappler/verifiers/structure_verifier_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 626276362",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 07:24:27,"tensorflow/core/summary/summary_converter.cc, tensorflow/core/summary/summary_db_writer.cc, tensorflow/core/summary/summary_file_writer.cc, tensorflow/core/summary/summary_file_writer_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 626268001",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 06:43:42,"tensorflow/core/framework/resource_op_kernel.h, tensorflow/core/framework/resource_op_kernel_test.cc, tensorflow/core/framework/resource_var.cc, tensorflow/core/framework/run_handler.cc, tensorflow/core/framework/run_handler_test.cc, tensorflow/core/framework/shape_inference.cc, tensorflow/core/framework/shape_inference.h, tensorflow/core/framework/shape_inference_test.cc, tensorflow/core/framework/shape_inference_testutil.cc, tensorflow/core/framework/shape_inference_testutil_test.cc, tensorflow/core/framework/tensor.cc, tensorflow/core/framework/tensor_shape.cc, tensorflow/core/framework/tensor_shape.h, tensorflow/core/framework/tensor_shape_test.cc, tensorflow/core/framework/tensor_slice.cc, tensorflow/core/framework/tensor_util.cc, tensorflow/core/framework/variant_op_registry.cc, tensorflow/core/framework/variant_op_registry_test.cc, tensorflow/core/framework/versions.cc",tensorflower-gardener,False
"Move PJRT integration doc to XLA docs.

PiperOrigin-RevId: 626259635",Elliot English,elliotenglish@google.com,2024-04-19 05:58:56,"third_party/xla/docs/_toc.yaml, third_party/xla/docs/pjrt_integration.md, third_party/xla/xla/pjrt/c/docs/pjrt_integration_guide.md",,False
"Merge pull request #58818 from psunn:string_attr

PiperOrigin-RevId: 626244168",TensorFlower Gardener,gardener@tensorflow.org,2024-04-19 04:36:27,"tensorflow/compiler/mlir/lite/tests/prepare-composite-functions-tf.mlir, tensorflow/compiler/mlir/lite/transforms/prepare_composite_functions_tf.cc",tensorflower-gardener,False
"Migrate to new header

No functional change is intended, just a refactoring.

PiperOrigin-RevId: 626242678",David Majnemer,majnemer@google.com,2024-04-19 04:15:20,"tensorflow/core/BUILD, third_party/py/ml_dtypes/ml_dtypes.BUILD, third_party/py/ml_dtypes/ml_dtypes.tests.BUILD, third_party/py/non_hermetic/ml_dtypes/ml_dtypes.BUILD, third_party/py/non_hermetic/ml_dtypes/ml_dtypes.tests.BUILD, third_party/xla/third_party/py/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/py/ml_dtypes/ml_dtypes.tests.BUILD, third_party/xla/third_party/py/non_hermetic/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/py/non_hermetic/ml_dtypes/ml_dtypes.tests.BUILD, third_party/xla/third_party/tsl/third_party/py/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/tsl/third_party/py/ml_dtypes/ml_dtypes.tests.BUILD, third_party/xla/third_party/tsl/third_party/py/non_hermetic/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/tsl/third_party/py/non_hermetic/ml_dtypes/ml_dtypes.tests.BUILD, third_party/xla/third_party/tsl/tsl/platform/BUILD, third_party/xla/third_party/tsl/tsl/platform/ml_dtypes.h",majnemer,False
"Modify IfrtIRCompileOptions to use shared_ptr for LoadedExecutable instead of a raw pointer.

PiperOrigin-RevId: 626237035",Ionel Gog,icgog@google.com,2024-04-19 03:39:10,"third_party/xla/xla/python/ifrt/ir/BUILD, third_party/xla/xla/python/ifrt/ir/compiler.h, third_party/xla/xla/python/ifrt/ir/tests/BUILD, third_party/xla/xla/python/ifrt/ir/tests/executable_impl_test_lib.cc, third_party/xla/xla/python/py_executable.cc, third_party/xla/xla/python/py_executable.h",ICGog,False
"Disable GPU load tracker.

PiperOrigin-RevId: 626231555",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 03:05:29,"tensorflow/compiler/jit/xla_launch_util.cc, tensorflow/core/common_runtime/gpu/gpu_serving_device_selector.h",tensorflower-gardener,False
"Make StreamExecutor inherit from StreamExecutorInterface, and make all concrete StreamExecutorInterface implementations inherit from StreamExecutor.

PiperOrigin-RevId: 626216114",Kyle Lucke,klucke@google.com,2024-04-19 01:48:39,"tensorflow/c/experimental/stream_executor/stream_executor.cc, third_party/xla/xla/backends/interpreter/executor.h, third_party/xla/xla/backends/interpreter/platform.cc, third_party/xla/xla/stream_executor/cuda/cuda_dnn.cc, third_party/xla/xla/stream_executor/cuda/cuda_platform.cc, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/host/host_executor.h, third_party/xla/xla/stream_executor/host/host_platform.cc, third_party/xla/xla/stream_executor/integrations/device_mem_allocator.h, third_party/xla/xla/stream_executor/rocm/rocm_platform.cc, third_party/xla/xla/stream_executor/stream.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h, third_party/xla/xla/stream_executor/tpu/tpu_executor.h, third_party/xla/xla/stream_executor/tpu/tpu_executor_interface.h, third_party/xla/xla/stream_executor/tpu/tpu_platform.cc",klucke,False
"Loosen unit tests that check strings derived from Protobuf DebugString

PiperOrigin-RevId: 626214762",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 01:42:22,"tensorflow/core/data/service/dispatcher_client_test.cc, third_party/xla/xla/python/outfeed_receiver_test.cc",tensorflower-gardener,False
"Support restoring tfhub modules under ParameterServerStrategy

PiperOrigin-RevId: 626214545",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-19 01:41:11,tensorflow/python/ops/partitioned_variables.py,tensorflower-gardener,False
"Add PrivacyInfo.xcprivacy for TFLite ios xcframeworks. Apple is enforcing apps and sdks to provide [Privacy Manifests files](https://developer.apple.com/documentation/bundleresources/privacy_manifest_files) and the enforcement will go into effect in three weeks.

PiperOrigin-RevId: 626188011",Yishuang Pang,ypang@google.com,2024-04-18 23:46:28,"tensorflow/lite/ios/TensorFlowLiteC.podspec.template, tensorflow/lite/ios/TensorFlowLiteC.xcprivacy, tensorflow/lite/ios/TensorFlowLiteCCoreML.xcprivacy, tensorflow/lite/ios/TensorFlowLiteCMetal.xcprivacy, tensorflow/lite/ios/TensorFlowLiteSelectTfOps.podspec.template, tensorflow/lite/ios/TensorFlowLiteSelectTfOps.xcprivacy, tensorflow/lite/objc/PrivacyInfo.xcprivacy, tensorflow/lite/objc/TensorFlowLiteObjC.podspec.template, tensorflow/lite/swift/PrivacyInfo.xcprivacy, tensorflow/lite/swift/TensorFlowLiteSwift.podspec.template",yishuangP,False
"#tf-data Optimizes the parameters only after the first root GetNext is finished.

PiperOrigin-RevId: 626177049",Jim Lin,jimlintw@google.com,2024-04-18 23:03:56,"tensorflow/core/framework/model.cc, tensorflow/core/framework/model_test.cc, tensorflow/core/kernels/data/iterator_ops.cc",jimlinntu,False
"[XLA:GPU] Minor refactoring to cleanup argument passing in `conv_algorithm_picker`.

The `PickBest...` methods have more arguments that necessary. This change removes the unnecessary arguments, pushing some logic to leaf methods. This makes the top level `PickBestAlgorithmNoCache` simpler and symmetrical when it comes to the different platforms.

PiperOrigin-RevId: 626162732",Dimitar (Mitko) Asenov,dasenov@google.com,2024-04-18 22:09:58,"third_party/xla/xla/service/gpu/conv_algorithm_picker.cc, third_party/xla/xla/service/gpu/conv_algorithm_picker.h",dimitar-asenov,False
"#tf-data Clean up a TODO.

PiperOrigin-RevId: 626161644",Yang Chen,yangchen@google.com,2024-04-18 22:05:32,tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc,yangustc07,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/3703d27cfb6a542a84d1df2097bbe8166003f3f8.

PiperOrigin-RevId: 626151547",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 21:28:42,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Integrate LLVM at llvm/llvm-project@63d8058ef50a

Updates LLVM usage to match
[63d8058ef50a](https://github.com/llvm/llvm-project/commit/63d8058ef50a)

PiperOrigin-RevId: 626138873",Jorge Gorbe Moya,jgorbe@google.com,2024-04-18 20:48:04,third_party/llvm/workspace.bzl,slackito,False
"[XLA] Add support for two-bit types

PiperOrigin-RevId: 626127281",David Majnemer,majnemer@google.com,2024-04-18 20:09:23,"third_party/xla/xla/BUILD, third_party/xla/xla/literal.cc, third_party/xla/xla/literal.h, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc, third_party/xla/xla/primitive_util.cc, third_party/xla/xla/primitive_util.h, third_party/xla/xla/primitive_util_test.cc, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/service/algebraic_simplifier.cc, third_party/xla/xla/service/convert_mover.cc, third_party/xla/xla/service/convert_mover_test.cc, third_party/xla/xla/service/cpu_gpu_shape_verifier.cc, third_party/xla/xla/service/cpu_gpu_shape_verifier_test.cc, third_party/xla/xla/service/generic_transfer_manager.cc, third_party/xla/xla/service/generic_transfer_manager.h, third_party/xla/xla/service/gpu/gemm_fusion_test.cc, third_party/xla/xla/service/gpu/gpu_hlo_schedule_test.cc, third_party/xla/xla/service/gpu/ir_emission_utils.cc, third_party/xla/xla/service/gpu/ir_emitter_triton_test.cc, third_party/xla/xla/service/gpu/model/gpu_hlo_cost_analysis_test.cc, third_party/xla/xla/service/gpu/move_copy_to_users_test.cc, third_party/xla/xla/service/gpu/parallel_loop_emitter.cc, third_party/xla/xla/service/hlo_creation_utils.cc, third_party/xla/xla/service/layout_normalization_test.cc, third_party/xla/xla/service/llvm_ir/ir_array.cc, third_party/xla/xla/service/llvm_ir/ir_array.h, third_party/xla/xla/service/llvm_ir/ir_array_test.cc, third_party/xla/xla/service/llvm_ir/llvm_util.cc, third_party/xla/xla/service/sub_byte_normalization.cc, third_party/xla/xla/service/value_range_test.cc, third_party/xla/xla/shape_util.cc, third_party/xla/xla/tools/driver.cc, third_party/xla/xla/translate/mhlo_to_hlo/mlir_hlo_to_hlo.cc, third_party/xla/xla/types.h, third_party/xla/xla/util.cc, third_party/xla/xla/util.h, third_party/xla/xla/util_test.cc, third_party/xla/xla/xla_data.proto",majnemer,False
"Migrate StableHLO to use Properties

PiperOrigin-RevId: 626126640",Kevin Gleason,gleasonk@google.com,2024-04-18 20:07:41,"tensorflow/compiler/mlir/lite/stablehlo/tests/compose-uniform-quantized-type.mlir, tensorflow/compiler/mlir/lite/stablehlo/transforms/uniform_quantized_stablehlo_to_tfl_pass.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/defer_activation_transpose.cc, tensorflow/compiler/mlir/quantization/stablehlo/tests/components/post_calibration_component.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/defer_activation_transpose.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/post_quantize.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize_op_with_region.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions_weight_only.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/pipelines/process_nchw_tensor.mlir, third_party/stablehlo/temporary.patch, third_party/xla/third_party/stablehlo/temporary.patch, third_party/xla/xla/mlir_hlo/tests/Dialect/mhlo/canonicalize/canonicalize.mlir, third_party/xla/xla/mlir_hlo/tests/Dialect/mhlo/hlo-legalize-to-stablehlo-experimental.mlir, third_party/xla/xla/mlir_hlo/tests/Dialect/mhlo/hlo-legalize-to-stablehlo.mlir",GleasonK,False
"[Cleanup] Add comments for fields.

PiperOrigin-RevId: 626123599",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 19:57:07,"tensorflow/core/framework/resource_handle.proto, tensorflow/core/framework/tensor.proto",tensorflower-gardener,False
"[XLA:GPU] Unify the Redzone buffer creation for autotuning.

The three different autotuning passes (cublas, cudnn, triton) have similar code for creating redzone allocators and initializing the buffers. This changes unifies the logic in order to ensure consistency and to make it easier to use this logic in future code.

PiperOrigin-RevId: 626122610",Dimitar (Mitko) Asenov,dasenov@google.com,2024-04-18 19:53:51,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/autotuner_compile_util.cc, third_party/xla/xla/service/gpu/autotuner_compile_util.h, third_party/xla/xla/service/gpu/conv_algorithm_picker.cc, third_party/xla/xla/service/gpu/conv_algorithm_picker.h, third_party/xla/xla/service/gpu/gemm_algorithm_picker.cc, third_party/xla/xla/service/gpu/gemm_fusion_autotuner.cc",dimitar-asenov,False
"Update Riegeli version.

PiperOrigin-RevId: 626120622",Marcin Kowalczyk,qrczak@google.com,2024-04-18 19:46:11,"tensorflow/tools/proto_splitter/cc/BUILD, tensorflow/tools/proto_splitter/cc/composable_splitter_base.cc, tensorflow/tools/proto_splitter/cc/composable_splitter_test.cc, tensorflow/tools/proto_splitter/cc/util.cc, tensorflow/tools/proto_splitter/cc/util.h, tensorflow/workspace2.bzl, third_party/riegeli_fix.patch",QrczakMK,False
"Provide a runtime option to lower bound the number of batch threads.

PiperOrigin-RevId: 626118642",Deqiang Chen,deqiangc@google.com,2024-04-18 19:39:06,"tensorflow/compiler/mlir/tfrt/BUILD, tensorflow/compiler/mlir/tfrt/tests/lower_bound_batch_threads.mlir, tensorflow/compiler/mlir/tfrt/transforms/lower_bound_batch_threads.cc, tensorflow/compiler/mlir/tfrt/transforms/passes.cc, tensorflow/compiler/mlir/tfrt/transforms/passes.h, tensorflow/compiler/mlir/tfrt/transforms/tfrt_pipeline_options.h, tensorflow/compiler/mlir/tfrt/translate/import_model.cc, tensorflow/compiler/mlir/tfrt/translate/tfrt_compile_options.cc, tensorflow/compiler/mlir/tfrt/translate/tfrt_compile_options.h",deqiangc,False
add ops back to MklList for auto_mixed_precision; accidentally removed in another PR,Gauri1 Deshpande,gauri1.deshpande@intel.com,2024-04-18 19:41:41,tensorflow/core/grappler/optimizers/auto_mixed_precision_lists.h,gaurides,True
"Rename RemoveSendDone to RemoveSendAndSendDone. Ditto for RemoveRecvDone. Make them virtual and return the new custom calls.

PiperOrigin-RevId: 626101568",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 18:40:35,"third_party/xla/xla/tools/hlo_control_flow_flattening.cc, third_party/xla/xla/tools/hlo_control_flow_flattening.h",tensorflower-gardener,False
"Wait for compilation to complete in PyClient::CompileIfrtProgram

Users expect jax compile() API to raise an exception when compilation fails.
Some backends return a future of an executable rather than the compilation result.
This does not raise exceptions in case of failures.

jax.stages.Compiled object in python is not a Future. To get an exception, users must wait on the compilation to complete. Only way to wait for the compilation to complete is to wait for compilation using APIs like get_compiled_memory_stats on the executable that internally materialize the executable.

Users already can run compilation asynchonously in a threadpool to have it generally be non-blocking across backends.

To simplify semantics, this CL makes JAX compilation always blocking regardless of whether IFRT implementations support async compilation so that it raises an exception in case of a failure to compile.

PiperOrigin-RevId: 626093908",Krishna Haridasan,krishnahari@google.com,2024-04-18 18:17:41,third_party/xla/xla/python/py_client.cc,krishnaharidasan,False
"Merge pull request #65726 from tensorflow:Surya_CropAndResize_checkfail

PiperOrigin-RevId: 626086252",TensorFlower Gardener,gardener@tensorflow.org,2024-04-18 18:02:32,tensorflow/core/kernels/image/crop_and_resize_op.cc,tensorflower-gardener,False
"Reverts 4cc17617fe8fb0bcd2400429d3be08acd87972c4

PiperOrigin-RevId: 626078105",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 17:28:52,"tensorflow/core/common_runtime/gpu/BUILD, tensorflow/core/common_runtime/gpu/gpu_serving_device_selector.cc, tensorflow/core/common_runtime/gpu/gpu_serving_device_selector.h, tensorflow/core/common_runtime/gpu/gpu_serving_device_selector_test.cc, third_party/xla/third_party/tsl/tsl/framework/serving_device_selector.h, third_party/xla/third_party/tsl/tsl/framework/test_util/mock_serving_device_selector.h",tensorflower-gardener,False
"Skip `test_spmd_preserves_input_sharding_vmap_grad` unless `xla_extension_version >= 258`

PiperOrigin-RevId: 626062015",Yash Katariya,yashkatariya@google.com,2024-04-18 16:37:15,third_party/xla/xla/python/xla_client.py,yashk2810,False
"Disable flaky test caused by the GEMM autotuner refactoring

PiperOrigin-RevId: 626057312",Sergey Kozub,sergeykozub@google.com,2024-04-18 16:21:56,third_party/xla/xla/service/gpu/gpu_compiler_test.cc,sergeykozub,False
"Eliminate StreamExecutor::AllocatedOwnedScalar to enable eliminate circular dependency between device_memory_allocator and stream_executor_pimpl.h.

PiperOrigin-RevId: 626037980",Kyle Lucke,klucke@google.com,2024-04-18 15:09:02,"third_party/xla/xla/service/gpu/buffer_comparator.cc, third_party/xla/xla/stream_executor/gpu/redzone_allocator.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"#shlo_ref Add `SI64` data type.

That type is not planned for support for the operations but some of them hard specify it for their attributes (eg. `dot_general`).

PiperOrigin-RevId: 626036982",Quentin Khan,qkhan@google.com,2024-04-18 15:05:40,"tensorflow/lite/experimental/shlo/data_type.h, tensorflow/lite/experimental/shlo/tensor_matcher.h",qukhan,False
"Stop using `usePropertiesForAttributes` in TFRT MLIR dialects

PiperOrigin-RevId: 626033675",Rohit Upadhyaya,rohitju@google.com,2024-04-18 14:54:24,"tensorflow/compiler/mlir/tfrt/ir/gpu_ops.td, tensorflow/compiler/mlir/tfrt/ir/mlrt/mlrt_dialect.td, tensorflow/compiler/mlir/tfrt/ir/mlrt/tf_mlrt_dialect.td, tensorflow/compiler/mlir/tfrt/ir/tfrt_fallback.td, tensorflow/compiler/mlir/tfrt/ir/tfrt_fallback_async.td, tensorflow/compiler/mlir/tfrt/tests/mlrt/rewrite_ifrt_load_variable.mlir, tensorflow/compiler/mlir/tfrt/tests/mlrt/tf_to_mlrt.mlir",rohitju,False
"#shlo_ref Factor `Storage` template definition.

PiperOrigin-RevId: 626024842",Quentin Khan,qkhan@google.com,2024-04-18 14:18:03,tensorflow/lite/experimental/shlo/data_type.h,qukhan,False
"[xla][gpu] Move sparse tests from Triton repo to XLA repo.

PiperOrigin-RevId: 626019600",Christian Sigg,csigg@google.com,2024-04-18 13:54:30,"third_party/triton/xla_extensions/sparse_dot_base.patch, third_party/triton/xla_extensions/sparse_dot_nvgpu.patch, third_party/triton/xla_extensions/sparse_dot_passes.patch, third_party/xla/third_party/triton/xla_extensions/sparse_dot_base.patch, third_party/xla/third_party/triton/xla_extensions/sparse_dot_nvgpu.patch, third_party/xla/third_party/triton/xla_extensions/sparse_dot_passes.patch, third_party/xla/xla/service/gpu/tests/BUILD, third_party/xla/xla/service/gpu/tests/sparse_add_layout.mlir, third_party/xla/xla/service/gpu/tests/sparse_convert_to_llvm_ampere.mlir, third_party/xla/xla/service/gpu/tests/sparse_convert_to_llvm_hopper.mlir, third_party/xla/xla/service/gpu/tests/sparse_test_wgmma.mlir, third_party/xla/xla/service/gpu/tests/sparse_ttg_accelerate_matmul.mlir, third_party/xla/xla/service/gpu/tests/sparse_ttg_fence_insertion.mlir, third_party/xla/xla/service/gpu/tests/sparse_ttg_loop_pipeline.mlir, third_party/xla/xla/service/gpu/tests/sparse_ttg_reduce_data_duplication.mlir, third_party/xla/xla/service/gpu/tests/sparse_validation.mlir",chsigg,False
"Re-enable quantized reduce mean.

PiperOrigin-RevId: 626014873",Alan Kelly,alankelly@google.com,2024-04-18 13:33:03,tensorflow/lite/delegates/xnnpack/xnnpack_delegate.cc,alankelly,False
"Fix fusion parameter resolving in indexing analysis

PiperOrigin-RevId: 626011888",Henning Becker,hebecker@google.com,2024-04-18 13:19:23,"third_party/xla/xla/service/gpu/model/coalescing_analysis_test.cc, third_party/xla/xla/service/gpu/model/indexing_analysis.cc",beckerhe,False
"Support non-scalar constants in mlir fusion emitters.

We can reuse some code from RewriteAllocateShared rewrite pattern to create a
GlobalOp.

PiperOrigin-RevId: 626005961",Adrian Kuegel,akuegel@google.com,2024-04-18 12:54:50,"third_party/xla/xla/service/gpu/fusions/loop_mlir_test.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir_test.cc, third_party/xla/xla/service/gpu/fusions/mlir/lower_tensors.cc, third_party/xla/xla/service/gpu/fusions/mlir/tests/lower_tensors.mlir",akuegel,False
"[XLA:GPU] Preserve metadata when removing degenerate reduce dims.

When removing degenerate (equals to 1) dimensions, bitcast op inherits the metadata (through ReplaceWithNewInstruction()), but not the new reduce instruction. Explicitly copy the metadata to the new reduce instruction.

PiperOrigin-RevId: 625994824",Alexander Lyashuk,crem@google.com,2024-04-18 12:04:25,third_party/xla/xla/service/gpu/reduction_degenerate_dim_remover.cc,mooskagh,False
"[XLA:GPU] Add RTVar support to SymbolicTile

This is neccesary for codegen of operations with dynamic offsets, such as dynamic-{update-}slice, gather, scatter...

PiperOrigin-RevId: 625994801",Tamás Danyluk,tdanyluk@google.com,2024-04-18 12:04:19,"third_party/xla/xla/service/gpu/model/indexing_map.cc, third_party/xla/xla/service/gpu/model/indexing_map.h, third_party/xla/xla/service/gpu/model/symbolic_tile.cc, third_party/xla/xla/service/gpu/model/symbolic_tile.h, third_party/xla/xla/service/gpu/model/symbolic_tile_test.cc",tdanyluk,False
"Automated Code Change

PiperOrigin-RevId: 625992810",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 11:55:46,"tensorflow/core/lib/db/BUILD, tensorflow/core/lib/db/sqlite.cc, tensorflow/core/lib/db/sqlite.h, tensorflow/core/lib/db/sqlite_test.cc",tensorflower-gardener,False
"Sync `ml_dtype` version with the one used in XLA.

PiperOrigin-RevId: 625992809",Quentin Khan,qkhan@google.com,2024-04-18 11:55:46,tensorflow/lite/tools/cmake/modules/ml_dtypes.cmake,qukhan,False
"Automated Code Change

PiperOrigin-RevId: 625985519",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 11:16:42,"tensorflow/core/runtime_fallback/util/attr_util.cc, tensorflow/core/runtime_fallback/util/attr_util_test.cc",tensorflower-gardener,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/940356ccac805874a2043be2e10b79bbd7538b0f.

PiperOrigin-RevId: 625978773",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 10:44:42,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Refactor GEMM autotuner

The refactoring is trying to fix two issues:
1) Expose API for compiling and autotuning dot fusions - previously the implementation was hidden in an anonymous namespace and used a global object for storing the results (autotuning cache). This might be useful for modelling matmul performance.
2) Reduce code duplication - previously the filtering of the triton configs was done separately for default and exhaustive search. Some configs need to be adjusted to be correctly compiled by Triton, for example:
- when there are less elements in a tensor than the number of threads (happens for sparse dot metadata with small tiles);
- when compiling for Hopper with `wgmma` enabled (block_m or num_warps may need to be adjusted).
Notably, `kDefaultGemmTiling` could need such adjustments, so returning it as-is may result in fatal compilation errors. With this patch, the same config generator is used for all code paths.

There are a few more changes:
- do not handle reference implementation (cuBLAS) separately; instead, use it in the `Config` variant along with the other options (cuDNN, triton).
- do not repeat cuDNN conditions - put them in one place.
- use actual tile sizes and SM count for calculating the split-K upper bound (more accurate heuristic than a global limit).

PiperOrigin-RevId: 625975092",Sergey Kozub,sergeykozub@google.com,2024-04-18 10:28:04,"third_party/xla/xla/service/gpu/gemm_fusion_autotuner.cc, third_party/xla/xla/service/gpu/gemm_fusion_autotuner.h, third_party/xla/xla/service/gpu/gemm_fusion_autotuner_test.cc",sergeykozub,False
"Integrate LLVM at llvm/llvm-project@676d3bafc09d

Updates LLVM usage to match
[676d3bafc09d](https://github.com/llvm/llvm-project/commit/676d3bafc09d)

PiperOrigin-RevId: 625970768",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 10:07:03,"tensorflow/compiler/mlir/tosa/transforms/legalize_tfl.cc, third_party/llvm/workspace.bzl",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625965435",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 09:40:34,"tensorflow/cc/experimental/libtf/impl/BUILD, tensorflow/cc/experimental/libtf/impl/iostream_test.cc, tensorflow/cc/experimental/libtf/impl/tensor_spec_test.cc",tensorflower-gardener,False
"Update GraphDef version to 1836.

PiperOrigin-RevId: 625956989",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 09:02:26,tensorflow/core/public/version.h,tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-18

PiperOrigin-RevId: 625956875",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 09:02:07,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Move fMHA test temporarily to H100

fMHA is broken on A100 when used with cuDNN 9. It seems the
tested pattern is not supported on A100 in cuDNN 9.

Moving the test temporarily to H100 until we had time to investigate
and fix it properly.

PiperOrigin-RevId: 625953778",Henning Becker,hebecker@google.com,2024-04-18 08:47:00,third_party/xla/xla/service/gpu/tests/BUILD,beckerhe,False
"[XLA:GPU] Print the correct error message when dumping llvm ir in trtion.

If `log_stream.emplace` returns error, we destruct `log_stream` and keep trying to use it later. Changed to fail earlier on and print a corresponding error message.

PiperOrigin-RevId: 625941297",Aliia Khasanova,aliia@google.com,2024-04-18 07:46:46,third_party/xla/xla/service/gpu/ir_emitter_triton.cc,,False
"Replace `ConstantR1` with templated version `ConstantR1<int32_t>`.

PiperOrigin-RevId: 625901423",Gunhyun Park,gunhyun@google.com,2024-04-18 04:08:47,third_party/xla/xla/client/xla_builder.cc,ghpvnist,False
"#tf-data Add `output_cardinality` to `index_flat_map`.

PiperOrigin-RevId: 625870208",Yang Chen,yangchen@google.com,2024-04-18 01:24:04,"tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc, tensorflow/core/ops/compat/ops_history_v2/IndexFlatMapDataset.pbtxt, tensorflow/core/ops/experimental_dataset_ops.cc, tensorflow/core/ops/ops.pbtxt, tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py, tensorflow/python/data/experimental/ops/BUILD, tensorflow/python/data/experimental/ops/index_flat_map_op.py, tensorflow/tools/api/golden/v1/tensorflow.raw_ops.pbtxt, tensorflow/tools/api/golden/v2/tensorflow.raw_ops.pbtxt",yangustc07,False
"Transfer `_quantization_method` attribute to the converted quantized `CallOp`.

PiperOrigin-RevId: 625869942",Dan Suh,dansuh@google.com,2024-04-18 01:22:41,"tensorflow/compiler/mlir/quantization/stablehlo/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantization_patterns.cc, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize_weight_only.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions_weight_only.mlir",dansuh17,False
"Eliminate StreamExecutor::AllocateOwnedArray interface to help eliminate circular includes between ScopedDeviceMemory and StreamExecutor.

PiperOrigin-RevId: 625866441",Kyle Lucke,klucke@google.com,2024-04-18 01:09:02,"third_party/xla/xla/service/gpu/buffer_comparator_test.cc, third_party/xla/xla/service/gpu/kernels/topk_kernel_test.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"[XLA:TPU] Refactor TryInputStreaming into a top-down approach, starting from entry computation parameters with host memory space.

This refactor allows for a more direct traversal of the graph for streamed parameters, but should not change behavior in any way.

PiperOrigin-RevId: 625863109",Jackson Stokes,jacksonstokes@google.com,2024-04-18 00:58:25,"third_party/xla/xla/service/host_offloader.cc, third_party/xla/xla/service/host_offloader.h",jvstokes,False
"Remove unnecessary `xla::` namespace qualifiers.

PiperOrigin-RevId: 625853273",Gunhyun Park,gunhyun@google.com,2024-04-18 00:16:07,third_party/xla/xla/client/xla_builder.cc,ghpvnist,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/fc9cb9f1253679cb2b645c26e0198cd0213d4378.

PiperOrigin-RevId: 625851893",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 00:10:25,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Updates TensorFlow Lite C Library cmake build instructions to be more clear for all OS's

PiperOrigin-RevId: 625850282",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-18 00:04:32,tensorflow/lite/g3doc/guide/build_cmake.md,tensorflower-gardener,False
"[XLA:MSA] Refactor `MsaAlgorithm` out of `memory_space_assignment.h/cc` files.
1. Move `MsaAlgorithm` to `algorithm.h/cc` files under `memory_space_assignment` directory.
1. Move `AllocationValue`, `AsynchronousCopyOrdering`, `AsynchronousCopyResource`, `AsynchronousCopy` to `algorithm.h/cc`.
1. Change remaining usages of `BufferInterval` and `BufferIntervalCompare` to `MsaBufferInterval` and `MsaBufferIntervalCompare`
1. Move functions related to AllocationSequence in allocation.h/cc

PiperOrigin-RevId: 625805759",Subhankar Shah,subhankarshah@google.com,2024-04-17 21:22:27,"third_party/xla/xla/service/memory_space_assignment/BUILD, third_party/xla/xla/service/memory_space_assignment/algorithm.cc, third_party/xla/xla/service/memory_space_assignment/algorithm.h, third_party/xla/xla/service/memory_space_assignment/allocation.cc, third_party/xla/xla/service/memory_space_assignment/allocation.h, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.cc, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.h, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment_test.cc",subhankarshah,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/87b56f63a6be054b4a9f59c7b2def04eff1966d5.

PiperOrigin-RevId: 625803331",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 21:15:21,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Previously, we rely on p2p-schedule-preparation pass to add control dependence
to represent how we want to order a Send-Recv chain etc. It turns out that the
dependence from Recv-Done to Send need to be visible to passes, in particular,
to prevent the fusion of the Send-data computation and the computation using
to Recv-Done result.

PiperOrigin-RevId: 625801276",Bixia Zheng,bixia@google.com,2024-04-17 21:08:56,"third_party/xla/xla/service/collective_permute_decomposer.cc, third_party/xla/xla/service/collective_permute_decomposer_test.cc",bixia1,False
"Skip custom_gradient_memory_test.testRecomputeGradXla.

Has been failing for a few days now.

PiperOrigin-RevId: 625800062",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 21:05:04,tensorflow/python/ops/memory_tests/custom_gradient_memory_test.py,tensorflower-gardener,False
"[tsl] Mark `tsl::NullTerminatedMessage()` with `ABSL_DEPRECATE_AND_INLINE`

PiperOrigin-RevId: 625799970",Lawrence Wolf-Sonkin,lawrencews@google.com,2024-04-17 21:04:45,third_party/xla/third_party/tsl/tsl/platform/status.h,lwolfsonkin,False
"[tsl] Mark `gtl::InlinedVector` with `ABSL_DEPRECATE_AND_INLINE`

PiperOrigin-RevId: 625788172",Lawrence Wolf-Sonkin,lawrencews@google.com,2024-04-17 20:27:45,"third_party/xla/third_party/tsl/tsl/lib/gtl/BUILD, third_party/xla/third_party/tsl/tsl/lib/gtl/inlined_vector.h",lwolfsonkin,False
"[tsl] Implement `tsl::NullTerminatedMessage()` in terms of `absl::StatusMessageAsCStr()`

* This allows TF to outsource correct acquisition of a null-terminated C-string of the status message to the Abseil library itself
* The previous implementation happened to work currently, but depended on internal implementation details of `absl::Status::message()` (namely, that when the message isn't empty, the returned `absl::string_view` is backed by a null-terminated `std::string`)
* Unfortunately we currently have to duplicate the definition depending on the platform due to linker-issues in the Windows build

PiperOrigin-RevId: 625785085",Lawrence Wolf-Sonkin,lawrencews@google.com,2024-04-17 20:17:44,"third_party/xla/third_party/tsl/tsl/platform/status.cc, third_party/xla/third_party/tsl/tsl/platform/status.h",lwolfsonkin,False
"Create a dependency on pywrap_calibration.so for the tensorflow wheel

PiperOrigin-RevId: 625783437",Jake Harmon,jakeharmon@google.com,2024-04-17 20:12:37,tensorflow/tools/pip_package/BUILD,jakeharmon8,False
"[XLA-oneDNN] Add missing BUILD dependencies for oneDNN matmul.

PiperOrigin-RevId: 625775737",Penporn Koanantakool,penporn@google.com,2024-04-17 19:48:31,third_party/xla/xla/service/cpu/BUILD,penpornk,False
"[xla][gpu] Fixed two problems in p2p-schedule-preparation.

Previously, we record the address of a P2PGroupNode for a complement-group that
forms a cycle with a group. This address can be changed as P2PGroupNode is an
entity of a map. Fixing this problem by recording the channel ID of the
complement-group instead.

Make sure that a group and its complement-group are both annotated with
a stream for pipelining.

PiperOrigin-RevId: 625770614",Bixia Zheng,bixia@google.com,2024-04-17 19:30:37,"third_party/xla/xla/service/BUILD, third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/p2p_schedule_preparation.cc, third_party/xla/xla/service/p2p_schedule_preparation_test.cc",bixia1,False
"Reverts changelist 570504216

PiperOrigin-RevId: 625769893",Jian Cai,jiancai@google.com,2024-04-17 19:28:16,"tensorflow/compiler/mlir/tf2xla/internal/mlir_bridge_pass_util.cc, tensorflow/compiler/mlir/tf2xla/internal/mlir_bridge_pass_util_test.cc",jcai19,False
"Uses a `btree_set` instead of a `flat_hash_set` to store entering & evicting primitives.

PiperOrigin-RevId: 625768656",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 19:23:47,"third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory_test.cc",tensorflower-gardener,False
"Create repo_mapping so that tf_runtime can refer to XLA and TSL differently from TF

Right now this is a noop, but this enables a future change to move tf_runtime to refer to XLA as `@xla` rather than `@local_xla`, and similar for TSL.

PiperOrigin-RevId: 625763425",David Dunleavy,ddunleavy@google.com,2024-04-17 19:06:27,"tensorflow/tensorflow.bzl, third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl, third_party/xla/workspace4.bzl",ddunl,False
"Reverts 603690b3ea5c656dcf228543d91e3f594f0807d0

PiperOrigin-RevId: 625759459",Chenguang Wang,chenguangwang@google.com,2024-04-17 18:54:09,"tensorflow/compiler/mlir/quantization/common/BUILD, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.cc, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.h, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints_test.cc, tensorflow/compiler/mlir/quantization/common/lift_as_function_call.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/pass_pipeline.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/insert_weight_param.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/passes.td, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantization_patterns.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantization_patterns.h, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize_composite_functions.cc, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/insert_weight_param.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize_weight_only.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions_weight_only.mlir",wecing,False
"#tf-data Add a test for WeightedFlatMap checkpoints without shuffling.

PiperOrigin-RevId: 625758364",Yang Chen,yangchen@google.com,2024-04-17 18:50:52,"tensorflow/core/kernels/data/experimental/weighted_flat_map_dataset_op.cc, tensorflow/python/data/experimental/kernel_tests/weighted_flat_map_test.py",yangustc07,False
"Refactor constructors of memory space impls to take device instead. It doesn't make sense to create a memory space with no device attached. This is mostly true for non-CPU devices.

PiperOrigin-RevId: 625756469",Yunlong Liu,yunlongl@google.com,2024-04-17 18:44:41,"third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/host_memory_spaces.cc, third_party/xla/xla/pjrt/host_memory_spaces.h",yliu120,False
"Remove outside compilation in Non-replicated Phase1 Bridge

Remove the support as part of the deprecation of Pepperjack M1.

PiperOrigin-RevId: 625756444",Jian Cai,jiancai@google.com,2024-04-17 18:44:37,"tensorflow/compiler/jit/flags.cc, tensorflow/compiler/jit/flags.h, tensorflow/compiler/mlir/tensorflow/tests/xla_rewrite_v2.mlir, tensorflow/compiler/mlir/tensorflow/transforms/BUILD, tensorflow/compiler/mlir/tensorflow/transforms/host_runtime/lower_cluster_to_runtime_ops.cc, tensorflow/compiler/mlir/tensorflow/transforms/passes.h, tensorflow/compiler/mlir/tensorflow/transforms/tf_device_passes.td, tensorflow/compiler/mlir/tensorflow/transforms/xla_rewrite_v2.cc, tensorflow/compiler/mlir/tf2xla/internal/clustering_bridge_passes.cc",jcai19,False
"[TSL] Add support for two-bit types

PiperOrigin-RevId: 625749348",David Majnemer,majnemer@google.com,2024-04-17 18:23:46,"third_party/py/ml_dtypes/ml_dtypes.BUILD, third_party/py/ml_dtypes/workspace.bzl, third_party/py/non_hermetic/ml_dtypes/ml_dtypes.BUILD, third_party/py/non_hermetic/ml_dtypes/workspace.bzl, third_party/xla/third_party/py/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/py/ml_dtypes/workspace.bzl, third_party/xla/third_party/py/non_hermetic/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/py/non_hermetic/ml_dtypes/workspace.bzl, third_party/xla/third_party/tsl/third_party/py/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/tsl/third_party/py/ml_dtypes/workspace.bzl, third_party/xla/third_party/tsl/third_party/py/non_hermetic/ml_dtypes/ml_dtypes.BUILD, third_party/xla/third_party/tsl/third_party/py/non_hermetic/ml_dtypes/workspace.bzl, third_party/xla/third_party/tsl/tsl/platform/ml_dtypes.h",majnemer,False
"Remove unused functions & structs from device_memory.h

PiperOrigin-RevId: 625736110",Kyle Lucke,klucke@google.com,2024-04-17 17:47:15,third_party/xla/xla/stream_executor/device_memory.h,klucke,False
"Introduce ifrt::Device and ifrt::Memory abstractions.

Previously ifrt::Device and ifrt::Memory were aliases for PJRT objects. But in general IFRT should not require the use of PJRT under the hood, and IFRT should define its own types.

This change introduces the new types and migrates users to refer to them.

PiperOrigin-RevId: 625719300",Peter Hawkins,phawkins@google.com,2024-04-17 17:00:14,"tensorflow/core/tfrt/ifrt/ifrt_serving_executable.cc, tensorflow/core/tfrt/ifrt/sharding_utils.cc, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/python/BUILD, third_party/xla/xla/python/dlpack.cc, third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/array_spec_test.cc, third_party/xla/xla/python/ifrt/client.h, third_party/xla/xla/python/ifrt/client_impl_test_lib.cc, third_party/xla/xla/python/ifrt/device.cc, third_party/xla/xla/python/ifrt/device.h, third_party/xla/xla/python/ifrt/device_test.cc, third_party/xla/xla/python/ifrt/ir/compiler.h, third_party/xla/xla/python/ifrt/ir/tests/executable_impl_test_lib.cc, third_party/xla/xla/python/ifrt/memory.cc, third_party/xla/xla/python/ifrt/memory.h, third_party/xla/xla/python/ifrt/mock.cc, third_party/xla/xla/python/ifrt/mock.h, third_party/xla/xla/python/ifrt/sharding_serdes.cc, third_party/xla/xla/python/ifrt/sharding_test_util.cc, third_party/xla/xla/python/ifrt_proxy/client/BUILD, third_party/xla/xla/python/ifrt_proxy/client/client.cc, third_party/xla/xla/python/ifrt_proxy/client/client.h, third_party/xla/xla/python/ifrt_proxy/client/client_test.cc, third_party/xla/xla/python/ifrt_proxy/client/compiler.cc, third_party/xla/xla/python/ifrt_proxy/client/compiler_test.cc, third_party/xla/xla/python/ifrt_proxy/client/device.cc, third_party/xla/xla/python/ifrt_proxy/client/device.h, third_party/xla/xla/python/ifrt_proxy/client/executable.cc, third_party/xla/xla/python/ifrt_proxy/client/executable_test.cc, third_party/xla/xla/python/ifrt_proxy/client/memory.h, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend_test.cc, third_party/xla/xla/python/outfeed_receiver.cc, third_party/xla/xla/python/outfeed_receiver.h, third_party/xla/xla/python/outfeed_receiver_py.cc, third_party/xla/xla/python/outfeed_receiver_test.cc, third_party/xla/xla/python/pjit.cc, third_party/xla/xla/python/pjrt_ifrt/BUILD, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_device.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_device.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_memory.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_memory.h, third_party/xla/xla/python/pjrt_ifrt/xla_executable_impl_test_lib.cc, third_party/xla/xla/python/pjrt_ifrt/xla_sharding.h, third_party/xla/xla/python/pmap_lib.cc, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/python/py_client.cc, third_party/xla/xla/python/py_client.h, third_party/xla/xla/python/py_compile_only_client.cc, third_party/xla/xla/python/py_device.cc, third_party/xla/xla/python/py_device_list.cc, third_party/xla/xla/python/py_memory_space.cc, third_party/xla/xla/python/py_memory_space.h, third_party/xla/xla/python/xla_client_test.py",hawkinsp,False
"Define MtkNeuronSettings in configuration.proto

PiperOrigin-RevId: 625679194",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 14:41:06,"tensorflow/lite/acceleration/configuration/configuration.proto, tensorflow/lite/acceleration/configuration/configuration_generated.h, tensorflow/lite/acceleration/configuration/flatbuffer_to_proto.cc, tensorflow/lite/acceleration/configuration/flatbuffer_to_proto_test.cc, tensorflow/lite/acceleration/configuration/proto_to_flatbuffer.cc, tensorflow/lite/acceleration/configuration/proto_to_flatbuffer_test.cc, tensorflow/lite/acceleration/configuration/testdata/configuration.proto_prev",tensorflower-gardener,False
"[XLA:GPU] Take the workspace size from the result shape when autotuning CuBlas.

The last part of the result tuple represents the workspace. We should use this to make the code simpler and also to allocate a more precise amount of memory.

PiperOrigin-RevId: 625666452",Dimitar (Mitko) Asenov,dasenov@google.com,2024-04-17 13:48:51,third_party/xla/xla/service/gpu/gemm_algorithm_picker.cc,dimitar-asenov,False
"Fix checkfail in GatherV2

The Op GatherV2 leads to check fail particularly when axis=kint64max. Anything less than or greater than that leads to valid exception.",Surya,116063290+SuryanarayanaY@users.noreply.github.com,2024-04-17 13:17:30,tensorflow/core/kernels/gather_op.cc,SuryanarayanaY,True
"Automated Code Change

PiperOrigin-RevId: 625647366",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 12:19:09,"third_party/xla/third_party/tsl/tsl/platform/base64.cc, third_party/xla/third_party/tsl/tsl/platform/base64.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625644008",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 12:03:33,tensorflow/compiler/mlir/lite/python/saved_model_to_tfl_flatbuffer.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625643824",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 12:02:50,"tensorflow/lite/tools/signature/signature_def_util.cc, tensorflow/lite/tools/signature/signature_def_util_test.cc, tensorflow/lite/tools/signature/signature_def_util_wrapper_pybind11.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625639855",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 11:44:08,"third_party/xla/xla/tools/hlo_opt/BUILD, third_party/xla/xla/tools/hlo_opt/gpu_opt.cc, third_party/xla/xla/tools/hlo_opt/opt_lib.cc, third_party/xla/xla/tools/hlo_opt/opt_lib.h, third_party/xla/xla/tools/hlo_opt/opt_main.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625637642",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 11:32:11,"tensorflow/lite/toco/graph_transformations/remove_trivial_quantized_activation_func.cc, tensorflow/lite/toco/graph_transformations/remove_trivial_quantized_min_max.cc, tensorflow/lite/toco/graph_transformations/remove_trivial_reshape.cc, tensorflow/lite/toco/graph_transformations/remove_trivial_slice.cc, tensorflow/lite/toco/graph_transformations/remove_unused_op.cc, tensorflow/lite/toco/graph_transformations/reorder_elementwise_unary.cc, tensorflow/lite/toco/graph_transformations/reorder_reshape_transpose.cc, tensorflow/lite/toco/graph_transformations/resolve_batch_normalization.cc, tensorflow/lite/toco/graph_transformations/resolve_batch_to_space_nd_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_binary.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_concatenation.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_fake_quant.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_fill.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_gather.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_pack.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_random_uniform.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_range.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_reshape.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_select.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_shape_or_rank.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_slice.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_strided_slice.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_tile.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_transpose.cc, tensorflow/lite/toco/graph_transformations/resolve_constant_unary.cc, tensorflow/lite/toco/graph_transformations/resolve_fake_quant_args_from_vars.cc, tensorflow/lite/toco/graph_transformations/resolve_gather_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_multiply_by_zero.cc, tensorflow/lite/toco/graph_transformations/resolve_pad_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_padv2_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_reduce_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_reorder_axes.cc, tensorflow/lite/toco/graph_transformations/resolve_reshape_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_slice_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_space_to_batch_nd_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_squeeze_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_strided_slice_attributes.cc, tensorflow/lite/toco/graph_transformations/resolve_tensorflow_concat.cc, tensorflow/lite/toco/graph_transformations/resolve_tensorflow_matmul.cc, tensorflow/lite/toco/graph_transformations/resolve_tensorflow_merge.cc, tensorflow/lite/toco/graph_transformations/resolve_tensorflow_switch.cc, tensorflow/lite/toco/graph_transformations/resolve_transpose_attributes.cc, tensorflow/lite/toco/graph_transformations/shuffle_fc_weights.cc, tensorflow/lite/toco/graph_transformations/unfuse_activation_functions.cc, tensorflow/lite/toco/graph_transformations/unpartition_embedding_lookup.cc, tensorflow/lite/toco/graph_transformations/unroll_batch_matmul.cc",tensorflower-gardener,False
"Enable int4.

This is a port of the current i4 logic in IRArray. Tested with int4_test.

PiperOrigin-RevId: 625634011",Johannes Reifferscheid,jreiffers@google.com,2024-04-17 11:13:59,"third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/lower_tensors.cc, third_party/xla/xla/service/gpu/fusions/mlir/tests/lower_tensors.mlir",jreiffers,False
"Automated Code Change

PiperOrigin-RevId: 625631109",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 11:02:08,tensorflow/compiler/mlir/lite/debug/debug_test.cc,tensorflower-gardener,False
"Fix DUS emitter when the output is bitcast.

PiperOrigin-RevId: 625626847",Johannes Reifferscheid,jreiffers@google.com,2024-04-17 10:38:39,"third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir.cc, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir_test.cc",jreiffers,False
"Enable complex.

Tested with JAX test suite.

PiperOrigin-RevId: 625614317",Johannes Reifferscheid,jreiffers@google.com,2024-04-17 09:38:54,third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc,jreiffers,False
"Fix xla_gpu.shuffle_reduce with complex arguments.

complex can't be bitcast to vector directly.

PiperOrigin-RevId: 625614029",Johannes Reifferscheid,jreiffers@google.com,2024-04-17 09:37:43,"third_party/xla/xla/service/gpu/fusions/mlir/lower_xla_gpu_to_scf.cc, third_party/xla/xla/service/gpu/fusions/mlir/tests/lower_xla_gpu_to_scf.mlir",jreiffers,False
"Fix allocate_shared with complex tensors.

complex<...> is not a valid element type for LLVM arrays.

PiperOrigin-RevId: 625613960",Johannes Reifferscheid,jreiffers@google.com,2024-04-17 09:37:31,"third_party/xla/xla/service/gpu/fusions/mlir/lower_tensors.cc, third_party/xla/xla/service/gpu/fusions/mlir/tests/lower_tensors.mlir",jreiffers,False
"Automated Code Change

PiperOrigin-RevId: 625611352",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 09:25:28,tensorflow/core/profiler/lib/profiler_disabled_test.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625610904",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 09:23:27,tensorflow/compiler/mlir/lite/transforms/lift_tflite_flex_ops.cc,tensorflower-gardener,False
"Remove unused `this` in lambda capture.

PiperOrigin-RevId: 625606757",Dan Suh,dansuh@google.com,2024-04-17 09:05:00,"tensorflow/compiler/mlir/quantization/stablehlo/cc/post_calibration.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/pre_calibration.cc",dansuh17,False
"Update GraphDef version to 1835.

PiperOrigin-RevId: 625606085",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 09:02:30,tensorflow/core/public/version.h,tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-17

PiperOrigin-RevId: 625606050",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 09:02:22,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"PR #11449: [XLA:GPU] replace is_causal_mask with enum mask_type to support more cudnn mask generation

Imported from GitHub PR https://github.com/openxla/xla/pull/11449

* replace is_causal_mask in backend_config with enum mask_type.
* cudnn also supports padding mask and alibi mask.

Copybara import of the project:

--
5780ffd6622978c0a173d90cc562d32f354bfbfd by cjkkkk <ske@nvidia.com>:

replace is_causal_mask with mask_type to support more mask

--
73555dba8f8cc1319cf75ed9cf8fe49ad88948bd by cjkkkk <ske@nvidia.com>:

add newline

--
2fed993035a2e5c17c990b60b7268ea9dbaeb7e5 by cjkkkk <ske@nvidia.com>:

add is_causal_mask back in backend_config

Merging this change closes #11449

PiperOrigin-RevId: 625595798",Shanbin Ke,ske@nvidia.com,2024-04-17 08:15:11,"third_party/xla/third_party/tsl/tsl/protobuf/dnn.proto, third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/backend_configs.proto, third_party/xla/xla/service/gpu/cublas_cudnn.h, third_party/xla/xla/service/gpu/cudnn_fused_mha_rewriter.cc, third_party/xla/xla/service/gpu/cudnn_fused_mha_rewriter_test.cc, third_party/xla/xla/service/gpu/cudnn_workspace_rewriter.cc, third_party/xla/xla/service/gpu/gpu_fused_mha_runner.cc, third_party/xla/xla/service/gpu/gpu_fused_mha_runner.h, third_party/xla/xla/service/gpu/ir_emitter_unnested.cc, third_party/xla/xla/service/gpu/stream_executor_util.cc, third_party/xla/xla/service/gpu/stream_executor_util.h, third_party/xla/xla/stream_executor/cuda/cuda_dnn.cc, third_party/xla/xla/stream_executor/cuda/cuda_dnn.h, third_party/xla/xla/stream_executor/dnn.cc, third_party/xla/xla/stream_executor/dnn.h, third_party/xla/xla/stream_executor/lazy_op_runner.h",Cjkkkk,False
"Use data layout attributes for index bit widths.

This fixes an issue in our code where we use too wide indices, and also works
around a bug in LLVM's separate-const-offset-from-gep pass, which produces
incorrect results in the presence of truncations. After this change, we will
use the same bit width for GEPs as for other indices, so there will never be
any truncs.

PiperOrigin-RevId: 625595331",Johannes Reifferscheid,jreiffers@google.com,2024-04-17 08:13:12,"third_party/xla/xla/service/gpu/fusions/mlir/BUILD, third_party/xla/xla/service/gpu/fusions/mlir/lower_tensors.cc, third_party/xla/xla/service/gpu/fusions/mlir/lower_to_llvm.cc, third_party/xla/xla/service/gpu/fusions/mlir/mlir_fusion_emitter.cc, third_party/xla/xla/service/gpu/fusions/mlir/mlir_fusion_emitter_test.cc, third_party/xla/xla/service/gpu/fusions/mlir/tests/BUILD, third_party/xla/xla/service/gpu/fusions/mlir/tests/lower_tensors.mlir, third_party/xla/xla/service/gpu/fusions/mlir/tests/mlir_fusions_opt.cc",jreiffers,False
"Clean up accidentally submitted std::err logging.

PiperOrigin-RevId: 625594192",Johannes Reifferscheid,jreiffers@google.com,2024-04-17 08:08:24,third_party/xla/xla/service/gpu/fusions/transpose_mlir.cc,jreiffers,False
"Automated Code Change

PiperOrigin-RevId: 625589566",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-17 07:46:59,tensorflow/lite/tools/command_line_flags_test.cc,tensorflower-gardener,False
"Reverts 9f8089490ad2ceb78e8ef02f17e941d70f093f41

PiperOrigin-RevId: 625554374",Kuangyuan Chen,chky@google.com,2024-04-17 04:43:20,"tensorflow/compiler/mlir/tfrt/BUILD, tensorflow/compiler/mlir/tfrt/function/function.cc, tensorflow/compiler/mlir/tfrt/function/function.h, tensorflow/compiler/mlir/tfrt/transforms/passes.h, tensorflow/compiler/mlir/tfrt/transforms/tf_to_tfrt.cc, tensorflow/compiler/mlir/tfrt/translate/import_model.cc, tensorflow/compiler/mlir/tfrt/translate/import_model.h",cky9301,False
"Refer to `Method` for weight-only quantization

PiperOrigin-RevId: 625548761",Doyeon Kim,doyeonkim@google.com,2024-04-17 04:10:19,"tensorflow/compiler/mlir/quantization/common/BUILD, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.cc, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.h, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints_test.cc, tensorflow/compiler/mlir/quantization/common/lift_as_function_call.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/pass_pipeline.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/insert_weight_param.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/passes.td, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantization_patterns.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantization_patterns.h, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize_composite_functions.cc, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/insert_weight_param.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize_weight_only.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions_weight_only.mlir",doyeonkim0,False
"Store variable's dtype and shape in `IfrtRestoreTensorRegistry` and store the `IfrtRestoreTensorRegistry` in IfrtServingExecutable for looking up the dtype and shape.

PiperOrigin-RevId: 625527802",Siqiao Wu,siqiaowu@google.com,2024-04-17 02:19:36,"tensorflow/compiler/mlir/tfrt/transforms/ifrt/ifrt_backend_compiler.cc, tensorflow/core/tfrt/ifrt/BUILD, tensorflow/core/tfrt/ifrt/ifrt_executable_registry_test.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_registry.h, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.h, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils_test.cc, tensorflow/core/tfrt/ifrt/ifrt_restore_tensor_registry.cc, tensorflow/core/tfrt/ifrt/ifrt_restore_tensor_registry.h, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.cc, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.h, tensorflow/core/tfrt/ifrt/ifrt_serving_executable_test.cc, tensorflow/core/tfrt/mlrt/kernel/BUILD, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel.cc, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel_test.cc",SiqiaoWu1993,False
"[xla:gpu] Define what execution stream id means and how it should work with async operations

PiperOrigin-RevId: 625518793",Eugene Zhulenev,ezhulenev@google.com,2024-04-17 01:37:48,third_party/xla/xla/service/gpu/runtime/thunk.h,ezhulenev,False
"#tf-data Add a repetition test for the `index_flat_map` dataset.

PiperOrigin-RevId: 625502609",Yang Chen,yangchen@google.com,2024-04-17 00:21:37,"tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py",yangustc07,False
"Add folders for tfl.maximum/tfl.minimum with +-FLT_MAX arg

This commit adds folders for the ops `tfl.maximum` and `tfl.minimum` for the case where one of the arguments is `-FLT_MAX` and `FLT_MAX`, respectively.

PiperOrigin-RevId: 625494071",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 23:46:29,"tensorflow/compiler/mlir/lite/ir/tfl_ops.cc, tensorflow/compiler/mlir/lite/ir/tfl_ops.td, tensorflow/compiler/mlir/lite/tests/const-fold.mlir",tensorflower-gardener,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/9fdfdeada1eb04e11e0db68461b5bd1dcdb02062.

PiperOrigin-RevId: 625477536",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 22:46:11,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"#tf-data Add a range check for `index_flat_map`.

Without this check, it could crash if `index_map_fn` returns an
out-of-bound index due to:
https://github.com/tensorflow/tensorflow/blob/69a908420c5c5b90027f23905cd842c76ca3955c/tensorflow/core/framework/tensor.cc#L1104

PiperOrigin-RevId: 625476301",Yang Chen,yangchen@google.com,2024-04-16 22:41:37,"tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py",yangustc07,False
"Don't load `tf_runtime` in TSL

This will allow tf_runtime to depend on XLA in a followup change

PiperOrigin-RevId: 625474344",David Dunleavy,ddunleavy@google.com,2024-04-16 22:34:25,"third_party/xla/third_party/tsl/workspace2.bzl, third_party/xla/third_party/tsl/workspace3.bzl",ddunl,False
"Reenable test as the original change is rolled back

Reverts 94350b84b5deb780e6d3ae01f8f1a5c7ba71b302

PiperOrigin-RevId: 625469451",Carlos Guia,guia@google.com,2024-04-16 22:17:49,"tensorflow/lite/testing/build_def.bzl, tensorflow/lite/testing/generated_examples_zip_test.cc",carlos-guia,False
"Integrate LLVM at llvm/llvm-project@694c444b5bbb

Updates LLVM usage to match
[694c444b5bbb](https://github.com/llvm/llvm-project/commit/694c444b5bbb)

PiperOrigin-RevId: 625464884",Jorge Gorbe Moya,jgorbe@google.com,2024-04-16 22:03:14,"third_party/llvm/generated.patch, third_party/llvm/workspace.bzl",slackito,False
"Update `tsl.bzl` with the knowledge that `distributed_runtime` is moved

PiperOrigin-RevId: 625455577",David Dunleavy,ddunleavy@google.com,2024-04-16 21:32:56,third_party/xla/xla/tsl/tsl.bzl,ddunl,False
"Skip adding reshapes for resharding tensors where their dimension sizes are not divisible by the mesh dimensions.

Also get rid of a duplicate debug print statement

PiperOrigin-RevId: 625454917",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 21:30:51,"third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_util.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_util.h",tensorflower-gardener,False
"Reverts c6644112a83e6bc09b848978ae9a373cf8b7c9fe

PiperOrigin-RevId: 625439915",Shawn Lu,xiaoxlu@google.com,2024-04-16 20:44:06,tensorflow/lite/BUILD,xiaoxlu,False
"Remove unused workflow

This workflow is no longer relevant.

PiperOrigin-RevId: 625430005",Jacques Pienaar,jpienaar@google.com,2024-04-16 20:13:50,third_party/xla/.github/workflows/benchmark.yml,jpienaar,False
"#tf-data Fix the graph mode tests for index flat map.

Otherwise, I'm getting this error:
```
Tensor(""Const:0"", shape=(4, 3), dtype=int64) must be from the same graph
 as Tensor(""TensorSliceDataset:0"", shape=(), dtype=variant)
```

PiperOrigin-RevId: 625429037",Yang Chen,yangchen@google.com,2024-04-16 20:10:28,tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py,yangustc07,False
"PR #11353: Implement async dynamic slicing

Imported from GitHub PR https://github.com/openxla/xla/pull/11353

This implements async dynamic-slice and dynamic-update-slice for host memory offloading on GPU.

Since the emitter does not understand dynamic slicing instructions in async computation, we wrap them in a fusion node and mark them for execution on a different stream. This is all we need to execute the offloading of slices asynchronously.
Copybara import of the project:

--
905db6df8130300014728bf4eceb2ee2fc23d6e1 by Jaroslav Sevcik <jsevcik@nvidia.com>:

Wrap async dynamic slicing into fusion

Merging this change closes #11353

PiperOrigin-RevId: 625428675",Jaroslav Sevcik,jsevcik@nvidia.com,2024-04-16 20:09:19,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/stream_attribute_annotator.cc, third_party/xla/xla/service/gpu/stream_attribute_annotator_test.cc",jaro-sevcik,False
"Remove unnecessary mentions of tf_runtime in visibilities

PiperOrigin-RevId: 625426863",David Dunleavy,ddunleavy@google.com,2024-04-16 20:03:49,"third_party/xla/xla/mlir/memref/BUILD, third_party/xla/xla/mlir/runtime/BUILD",ddunl,False
"PR #11478: [XLA:GPU] add guards for flash attention graph with cuDNN >= 8.9.4

Imported from GitHub PR https://github.com/openxla/xla/pull/11478

* Build XLA with cuDNN 8.6 will cause compilation error because flash attention graph will use `CudnnfMHAUid` which is only defined with cuDNN > 8.8.
* Add a guard for flash attention graph with at least cuDNN 8.9.4. So the current logic would be only compile FMHA with cuDNN > 8.8 and only compile flash attention with cuDNN > 8.9.4.
Copybara import of the project:

--
a1aa585f4e6ce42c7486336549447151cd5f7690 by cjkkkk <ske@nvidia.com>:

add guards for flash attention graph with at least 8.9.4

Merging this change closes #11478

PiperOrigin-RevId: 625425491",Shanbin Ke,ske@nvidia.com,2024-04-16 19:59:57,third_party/xla/xla/stream_executor/cuda/cuda_dnn.cc,Cjkkkk,False
"Reverts changelist 592550538

PiperOrigin-RevId: 625419138",Jian Cai,jiancai@google.com,2024-04-16 19:36:44,"tensorflow/compiler/mlir/tf2xla/internal/passes/BUILD, tensorflow/compiler/mlir/tf2xla/internal/passes/tpu_cluster_formation.cc, tensorflow/compiler/mlir/tf2xla/internal/passes/tpu_cluster_formation_test.cc",jcai19,False
"Integrate StableHLO at openxla/stablehlo@e81411ef

PiperOrigin-RevId: 625413358",Michael Levesque-Dion,mlevesquedion@google.com,2024-04-16 19:14:48,"third_party/stablehlo/temporary.patch, third_party/stablehlo/workspace.bzl, third_party/xla/third_party/stablehlo/temporary.patch, third_party/xla/third_party/stablehlo/workspace.bzl",mlevesquedion,False
"Attach sharding to `tuple` in mhlo -> hlo conversion when the following two conditions are true.
1. converting `mhlo::ReturnOp` or `mlir::func::ReturnOp`
2. `num_return_values == 1`
3. `!return_tuple || !is_entry_function`

PiperOrigin-RevId: 625411731",Zixuan Jiang,zixuanjiang@google.com,2024-04-16 19:08:58,"third_party/xla/xla/translate/mhlo_to_hlo/mlir_hlo_to_hlo.cc, third_party/xla/xla/translate/mhlo_to_hlo/tests/sharding.mlir",ZixuanJiang,False
"Fix the field used to calculate struct size.

PiperOrigin-RevId: 625409989",Jieying Luo,jieying@google.com,2024-04-16 19:03:17,third_party/xla/xla/pjrt/c/pjrt_c_api_profiler_extension.h,jyingl3,False
"Disable sqrt conversions tests

PiperOrigin-RevId: 625394661",Carlos Guia,guia@google.com,2024-04-16 18:17:52,"tensorflow/lite/testing/build_def.bzl, tensorflow/lite/testing/generated_examples_zip_test.cc",carlos-guia,False
"#tf-data Support global shuffling for the memory cache dataset.

PiperOrigin-RevId: 625391182",Yang Chen,yangchen@google.com,2024-04-16 18:07:27,"tensorflow/core/kernels/data/BUILD, tensorflow/core/kernels/data/cache_dataset_ops.cc, tensorflow/python/data/kernel_tests/BUILD, tensorflow/python/data/kernel_tests/cache_test.py",yangustc07,False
"Change `BuildGetTupleElementsForTupleResults` to allow for a non-tuple sharding on a tuple op, by using the same sharding for all get-tuple-elements.

PiperOrigin-RevId: 625384767",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 17:50:12,"third_party/xla/xla/translate/mhlo_to_hlo/mlir_hlo_to_hlo.cc, third_party/xla/xla/translate/mhlo_to_hlo/tests/sharding.mlir",tensorflower-gardener,False
"[xla:ifrt] Switch ifrt::Value and ifrt::Array to stateless Future<> futures to communicate events completion

PiperOrigin-RevId: 625375855",Eugene Zhulenev,ezhulenev@google.com,2024-04-16 17:24:11,"tensorflow/core/tfrt/ifrt/sharding_utils.cc, tensorflow/dtensor/cc/parallel_executor.h, third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/array.h, third_party/xla/xla/python/ifrt/executable.h, third_party/xla/xla/python/ifrt/future.cc, third_party/xla/xla/python/ifrt/future.h, third_party/xla/xla/python/ifrt/future_test.cc, third_party/xla/xla/python/ifrt/mock.h, third_party/xla/xla/python/ifrt/value.h, third_party/xla/xla/python/ifrt_proxy/client/array.cc, third_party/xla/xla/python/ifrt_proxy/client/array.h, third_party/xla/xla/python/ifrt_proxy/client/executable.cc, third_party/xla/xla/python/ifrt_proxy/integration_tests/mock_array_test.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend_test.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_tuple.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_tuple.h, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/python/py_executable.cc, third_party/xla/xla/python/util.cc",ezhulenev,False
"[IFRT] Revise comments for proto messages

Proto messages for IFRT types may be used for various goals other than
transferring them over wire. This change reflects it on the proto comments.

Also set up a linter directive for `DType::Kind` and `DTypeProto::Kind` whose
mirroring is easy to miss.

PiperOrigin-RevId: 625365783",Hyeontaek Lim,hyeontaek@google.com,2024-04-16 16:56:18,"third_party/xla/xla/python/ifrt/device.proto, third_party/xla/xla/python/ifrt/dtype.h, third_party/xla/xla/python/ifrt/dtype.proto, third_party/xla/xla/python/ifrt/shape.proto, third_party/xla/xla/python/ifrt/sharding.proto, third_party/xla/xla/python/ifrt/sharding_serdes.proto",hyeontaek,False
"Merge pull request #63344 from tensorflow:Surya_MatrixDiagV3_checkfail_fix

PiperOrigin-RevId: 625362770",TensorFlower Gardener,gardener@tensorflow.org,2024-04-16 17:20:46,tensorflow/core/kernels/linalg/matrix_diag_op.cc,tensorflower-gardener,False
"PR #11352: [ROCm] Triton in XLA for ROCm - changed ir_emitter_triton_test

Imported from GitHub PR https://github.com/openxla/xla/pull/11352

Modified the test case to pass on rocm and cuda.
There will be at least one more XLA related PR - to switch on Triton usage for ROCm, but only after PR for adding Triton build files for ROCm on openxla/triton.
Copybara import of the project:

--
dd80a6f44295642efd3ae6af6ffd3e2a3302d36e by Zoran Jovanovic <zjovanov@amd.com>:

[ROCm] Triton in XLA for ROCm - changed ir_emitter_triton_test to pass on rocm and cuda

Merging this change closes #11352

PiperOrigin-RevId: 625361694",zoranjovanovic-ns,126815388+zoranjovanovic-ns@users.noreply.github.com,2024-04-16 16:42:57,third_party/xla/xla/service/gpu/ir_emitter_triton_test.cc,zoranjovanovic-ns,False
"[IFRT] Add ArraySpec

`ArraySpec` holds static properties of `Array`. This provides a common and
convenient way of describing an expected or requested static properties of an
input/output array of an operation.

This does not change IFRT Proxy's proto messages as they reflect the IFRT API,
most of which does not use `ArraySpec` yet.

PiperOrigin-RevId: 625361614",Hyeontaek Lim,hyeontaek@google.com,2024-04-16 16:42:43,"third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/array_spec.cc, third_party/xla/xla/python/ifrt/array_spec.h, third_party/xla/xla/python/ifrt/array_spec.proto, third_party/xla/xla/python/ifrt/array_spec_test.cc",hyeontaek,False
"Create a separate callback for restored tensor propagation and move it out of LoadRestoredTensorAsIfrtLoadedVariable.

PiperOrigin-RevId: 625357164",Siqiao Wu,siqiaowu@google.com,2024-04-16 16:28:17,"tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.h, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils_test.cc, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel.cc",SiqiaoWu1993,False
"Avoid cuDNN initialization in Stream::DeallocateStream

`DeallocateStream` used to call `AsDnn()` which initializes
cuDNN if it wasn't initialized before.

This is not intended in `DeallocateStream` which runs as part
of the destructor.

Instead I access the `dnn_` member variable directly.
Only if cuDNN was initialized previously we do the cleanup.

This was easy to do thanks to Kyle's cleanup from cl/623542918.

This avoid some stack overflow issues seen in
`//third_party/tensorflow/python/distribute:cross_device_ops_test_gpu`
due to excessive cuDNN initialization (even though cuDNN is not needed at all in this test).

Here is a run of this test that demonstrates the fix: http://sponge2/5c72bcc3-380f-4be3-a1f7-6c63d94848af

PiperOrigin-RevId: 625346679",Henning Becker,hebecker@google.com,2024-04-16 15:53:19,"third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc",beckerhe,False
"[xla:ffi] Add test case for tuple input to CPU custom call tests

Add a test case for handling tuple input to CPU custom call typed FFI API tests.
Implements #10056.

PiperOrigin-RevId: 625342766",Adam Banaś,adambanas@google.com,2024-04-16 15:38:18,third_party/xla/xla/tests/custom_call_test.cc,Adam-Banas,False
"Update the XNNPack version.

PiperOrigin-RevId: 625342742",Quentin Khan,qkhan@google.com,2024-04-16 15:38:11,"tensorflow/lite/tools/cmake/modules/xnnpack.cmake, tensorflow/workspace2.bzl",qukhan,False
"Reverts a080cbad71e4c483a1851d802da2ea997bc4352f

PiperOrigin-RevId: 625342079",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 15:35:55,third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory_test.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625295451",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 12:30:09,tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625295434",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 12:30:05,"tensorflow/compiler/mlir/lite/flatbuffer_import.cc, tensorflow/compiler/mlir/lite/flatbuffer_operator.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625286613",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 11:52:50,tensorflow/core/profiler/convert/op_metrics_to_record.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625285000",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 11:44:11,"tensorflow/security/fuzzing/cc/core/framework/tensor_domains.cc, tensorflow/security/fuzzing/cc/core/framework/tensor_shape_domains.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625284317",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 11:40:35,tensorflow/core/util/sparse/sparse_tensor.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625280358",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 11:21:24,"tensorflow/python/profiler/internal/profiler_pywrap_impl.cc, tensorflow/python/profiler/internal/profiler_pywrap_impl.h",tensorflower-gardener,False
"Share StableHLO/MHLO pretty printers for ConstantOp

PiperOrigin-RevId: 625273473",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 10:51:55,"third_party/stablehlo/temporary.patch, third_party/xla/third_party/stablehlo/temporary.patch, third_party/xla/xla/mlir_hlo/mhlo/IR/hlo_ops.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625268053",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 10:27:15,"tensorflow/core/graph/graph.cc, tensorflow/core/graph/node_builder.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625267759",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 10:26:03,tensorflow/core/tpu/kernels/xla/host_compute_ops.cc,tensorflower-gardener,False
"[XLA:GPU][CoalescingAnalysis] Speed-up computation of coalescing.

PiperOrigin-RevId: 625265401",Alexander Belyaev,pifon@google.com,2024-04-16 10:14:18,"third_party/xla/xla/service/gpu/model/BUILD, third_party/xla/xla/service/gpu/model/coalescing_analysis.cc, third_party/xla/xla/service/gpu/model/coalescing_analysis.h, third_party/xla/xla/service/gpu/model/coalescing_analysis_test.cc, third_party/xla/xla/service/gpu/model/indexing_map.cc, third_party/xla/xla/service/gpu/model/indexing_map.h",pifon2a,False
"Automated Code Change

PiperOrigin-RevId: 625262185",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 10:01:21,"tensorflow/core/tfrt/graph_executor/graph_executor.cc, tensorflow/core/tfrt/graph_executor/graph_executor.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625260436",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:53:32,"tensorflow/core/tfrt/saved_model/saved_model.cc, tensorflow/core/tfrt/saved_model/saved_model.h, tensorflow/core/tfrt/saved_model/saved_model_aot_compile.cc, tensorflow/core/tfrt/saved_model/saved_model_aot_compile.h, tensorflow/core/tfrt/saved_model/saved_model_import_input.cc, tensorflow/core/tfrt/saved_model/saved_model_import_input.h, tensorflow/core/tfrt/saved_model/saved_model_util.cc, tensorflow/core/tfrt/saved_model/saved_model_util.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625260171",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:52:21,"tensorflow/core/tpu/tpu_embedding_spmd_sharding_utils.cc, tensorflow/core/tpu/tpu_embedding_spmd_sharding_utils.h, tensorflow/core/tpu/tpu_execute.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625259831",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:50:45,"tensorflow/compiler/mlir/tfrt/transforms/mlrt/import_model.cc, tensorflow/compiler/mlir/tfrt/transforms/mlrt/tf_to_mlrt.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625257973",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:42:28,"tensorflow/core/tfrt/utils/error_util.cc, tensorflow/core/tfrt/utils/graph_partition.cc, tensorflow/core/tfrt/utils/tfrt_graph_execution_state.cc, tensorflow/core/tfrt/utils/utils.cc, tensorflow/core/tfrt/utils/utils_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625257877",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:41:58,tensorflow/compiler/tests/randomized_tests.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625257666",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:41:08,"tensorflow/core/tpu/kernels/image_resize_ops.cc, tensorflow/core/tpu/kernels/infeed_ops.cc, tensorflow/core/tpu/kernels/sharding_util_ops.cc, tensorflow/core/tpu/kernels/sharding_utils.h, tensorflow/core/tpu/kernels/sparse_core_xla_ops.cc, tensorflow/core/tpu/kernels/tpu_compilation_cache_external.cc, tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc, tensorflow/core/tpu/kernels/tpu_compilation_cache_local_lookup.cc, tensorflow/core/tpu/kernels/tpu_compilation_cache_rpc_lookup.cc, tensorflow/core/tpu/kernels/tpu_configuration_ops.cc, tensorflow/core/tpu/kernels/tpu_configuration_ops.h, tensorflow/core/tpu/kernels/tpu_embedding_enqueue_ops.cc, tensorflow/core/tpu/kernels/tpu_embedding_ops.cc, tensorflow/core/tpu/kernels/tpu_execute_op.cc, tensorflow/core/tpu/kernels/tpu_functional_ops.cc, tensorflow/core/tpu/kernels/tpu_pod_state.cc, tensorflow/core/tpu/kernels/tpu_program_group.h, tensorflow/core/tpu/kernels/tpu_reshard_variables_op.cc, tensorflow/core/tpu/kernels/tpu_reshard_variables_op_util.cc, tensorflow/core/tpu/kernels/tpu_util.cc, tensorflow/core/tpu/kernels/transfer_ops.cc, tensorflow/core/tpu/kernels/transfer_ops.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625253945",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:26:10,tensorflow/core/tfrt/tfrt_session/tfrt_session.cc,tensorflower-gardener,False
"[XLA:GPU][IndexAnalysis] Skip adding constraints with AffineConstantExpr.

If we add a constraint ""some_constant, interval"" and `some_constant` belongs to
the interval, then we can just skip adding it.

PiperOrigin-RevId: 625250012",Alexander Belyaev,pifon@google.com,2024-04-16 09:10:21,"third_party/xla/xla/service/gpu/fusions/reduction_base_test.cc, third_party/xla/xla/service/gpu/model/indexing_map.cc, third_party/xla/xla/service/gpu/model/indexing_map_test.cc",pifon2a,False
"[xla:cpu] Restore the verbose version of custom call tests

Reverts 71f2fdb. Applies necessary changes to the new tests.

Rollback reason: The more verbose version provides more context and is self-documenting; thus, it is easier to understand.

Reverts 8a2d31612fbafc7019bb15ad0a5752178cce745c

PiperOrigin-RevId: 625249016",Adam Banaś,adambanas@google.com,2024-04-16 09:06:08,third_party/xla/xla/tests/custom_call_test.cc,Adam-Banas,False
"compat: Update forward compatibility horizon to 2024-04-16

PiperOrigin-RevId: 625247997",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:02:37,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Update GraphDef version to 1834.

PiperOrigin-RevId: 625247975",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 09:02:31,tensorflow/core/public/version.h,tensorflower-gardener,False
"[xla:gpu] Remove `GatherSimplifier` and `ScatterSimplifier` from `runSPMDPasses`, to avoid breaking the parallel dimensions pattern for propagation and partitioning in GSPMD.

Those passes are applied in `RunOptimizationPasses` which is after partitioning.

PiperOrigin-RevId: 625246878",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 08:58:33,third_party/xla/xla/service/gpu/gpu_compiler.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625243774",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 08:45:15,"tensorflow/core/util/tensor_bundle/byte_swap_tensor.cc, tensorflow/core/util/tensor_bundle/tensor_bundle.cc, tensorflow/core/util/tensor_bundle/tensor_bundle.h, tensorflow/core/util/tensor_bundle/tensor_bundle_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625241457",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 08:35:11,third_party/xla/third_party/tsl/tsl/profiler/rpc/profiler_service_impl.cc,tensorflower-gardener,False
"[xla:ffi] Adapt CPU custom call tests to changes in typed FFI API

Handle Result<T> and Ret tags.
Change expected status codes and messages for tests expecting failure.
Fix FfiHandleBufferBaseDouble test.
Implements #10060.

PiperOrigin-RevId: 625234992",Adam Banaś,adambanas@google.com,2024-04-16 08:09:51,third_party/xla/xla/tests/custom_call_test.cc,Adam-Banas,False
"PR #11524: [ROCM] added flag limiting the number of gemm solutions to be checked & get real IDs for hipblas-lt

Imported from GitHub PR https://github.com/openxla/xla/pull/11524

In this PR I add a new XLA flag **xla_gpu_autotune_max_solutions** which limits the number of GEMM solutions to be using for GEMM autotuning. This is a temporary measure while rocBLAS returns way too many solutions which can significantly slow-down autotuning for real applications.

Besides, I also added a ""workaround"" to obtain the real solution IDs for hipblas-lt which might be later used for deterministic autotuning.

@xla-rotation: would you have a look please ?
Copybara import of the project:

--
b8d2a95773ca80d8cb4a2fdac1d2624e4ae2d5c8 by Pavel Emeliyanenko <pavel.emeliyanenko@amd.com>:

added flag limiting the number of gemm solutions to be checked & get real solution IDs for hipblas-lt

Merging this change closes #11524

PiperOrigin-RevId: 625230220",pemeliya,141146080+pemeliya@users.noreply.github.com,2024-04-16 07:49:35,"third_party/xla/xla/debug_options_flags.cc, third_party/xla/xla/service/gpu/gemm_algorithm_picker.cc, third_party/xla/xla/stream_executor/rocm/hip_blas_lt.cc, third_party/xla/xla/stream_executor/rocm/rocm_blas.cc, third_party/xla/xla/xla.proto",pemeliya,False
"Automated Code Change

PiperOrigin-RevId: 625228885",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 07:43:21,"tensorflow/tools/tfg_graph_transforms/tfg_graph_transforms_main.cc, tensorflow/tools/tfg_graph_transforms/utils.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625227023",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 07:34:50,"tensorflow/examples/label_image/BUILD, tensorflow/examples/label_image/main.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625225262",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 07:27:05,tensorflow/core/util/activation_mode.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625223694",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 07:19:41,"tensorflow/lite/delegates/flex/buffer_map_util.cc, tensorflow/lite/delegates/flex/delegate_data.cc, tensorflow/lite/delegates/flex/delegate_data_test.cc, tensorflow/lite/delegates/flex/kernel.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625223640",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 07:19:29,"tensorflow/core/profiler/convert/xplane_to_dcn_collective_stats.cc, tensorflow/core/profiler/convert/xplane_to_dcn_collective_stats.h, tensorflow/core/profiler/convert/xplane_to_dcn_collective_stats_test.cc, tensorflow/core/profiler/convert/xplane_to_hlo.cc, tensorflow/core/profiler/convert/xplane_to_hlo.h, tensorflow/core/profiler/convert/xplane_to_tool_names.cc, tensorflow/core/profiler/convert/xplane_to_tool_names.h, tensorflow/core/profiler/convert/xplane_to_tool_names_test.cc, tensorflow/core/profiler/convert/xplane_to_tools_data.cc, tensorflow/core/profiler/convert/xplane_to_tools_data.h",tensorflower-gardener,False
"PR #11557: Fix unittest build error

Imported from GitHub PR https://github.com/openxla/xla/pull/11557

This PR fix the build error for tests:

./bazel-6.5.0rc1-linux-x86_64 \
    test \
    --flaky_test_attempts=1 \
    --config=cuda \
    --compilation_mode=dbg \
    --action_env TF_CUDA_COMPUTE_CAPABILITIES=compute_90 \
    --test_summary=detailed \
    --runs_per_test=1 \
    --nocache_test_results \
    --test_output=streamed  \
   //xla/service/gpu/tests:gemm_rewrite_test_gpu

Copybara import of the project:

--
3b4f5cf65eab164b4fa2d79721ee618da772d600 by Shawn Wang <shawnw@nvidia.com>:

fix unittest build error

Merging this change closes #11557

PiperOrigin-RevId: 625217879",Shawn Wang,shawnw@nvidia.com,2024-04-16 06:54:13,"third_party/xla/xla/backends/interpreter/BUILD, third_party/xla/xla/backends/interpreter/executor.h, third_party/xla/xla/stream_executor/BUILD",shawnwang18,False
"Automated Code Change

PiperOrigin-RevId: 625217706",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 06:53:26,tensorflow/core/profiler/lib/profiler_factory.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625206988",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 05:58:50,tensorflow/compiler/mlir/tfrt/translate/import_model.cc,tensorflower-gardener,False
"Support complex constants in mlir-based fusion emitters.

PiperOrigin-RevId: 625206932",Adrian Kuegel,akuegel@google.com,2024-04-16 05:58:31,"third_party/xla/xla/service/gpu/fusions/mlir/BUILD, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir_test.cc",akuegel,False
"Clean up XLA Runtime/XLA-CPU-Next related dead logic in PjRt CPU.

PiperOrigin-RevId: 625205091",Yue Sheng,yueshengys@google.com,2024-04-16 05:48:55,"third_party/xla/xla/pjrt/cpu/BUILD, third_party/xla/xla/pjrt/cpu/cpu_client.cc",yueshengys,False
"Automated Code Change

PiperOrigin-RevId: 625203649",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 05:40:57,"tensorflow/core/util/example_proto_fast_parsing.cc, tensorflow/core/util/example_proto_fast_parsing.h, tensorflow/core/util/example_proto_fast_parsing_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625202250",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 05:34:05,"tensorflow/dtensor/mlir/BUILD, tensorflow/dtensor/mlir/sparse_expansions/dynamic_enqueue_sparse_expander.cc, tensorflow/dtensor/mlir/sparse_expansions/dynamic_enqueue_sparse_expander.h, tensorflow/dtensor/mlir/sparse_expansions/matmul_sparse_expander.cc, tensorflow/dtensor/mlir/sparse_expansions/matmul_sparse_expander.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625201135",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 05:28:48,"tensorflow/core/util/batch_util.cc, tensorflow/core/util/tensor_slice_writer.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 625197099",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 05:07:11,"tensorflow/compiler/mlir/tools/kernel_gen/BUILD, tensorflow/compiler/mlir/tools/kernel_gen/hlo_to_kernel.cc",tensorflower-gardener,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/16ceace318b63a569138261331c66d7809d079de.

PiperOrigin-RevId: 625185286",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 04:04:39,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Add CalibrationStatisticsSaver op definition

This op is designed to replace the CalibrationSingleton by aggregating and saving the statistics to files. It is stateful and is designed to run on CPU. This op has no output so we can easily lift it to outer function when required.

PiperOrigin-RevId: 625183945",Thai Nguyen,thaink@google.com,2024-04-16 03:58:13,"tensorflow/compiler/mlir/quantization/tensorflow/calibrator/BUILD, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics.proto, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_histogram.h, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_test.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_saver_op.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_saver_op_test.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibrator_singleton.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/custom_aggregator_op.py, tensorflow/compiler/mlir/quantization/tensorflow/python/BUILD",thaink,False
"Remove a check for single user of an operand in convert-memory-placement-to-internal-annotations.

PiperOrigin-RevId: 625183655",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 03:56:29,third_party/xla/xla/service/convert_memory_placement_to_internal_annotations.cc,tensorflower-gardener,False
"host_offloader: support unnested input parameter tuples

PiperOrigin-RevId: 625180012",Emilio Cota,ecg@google.com,2024-04-16 03:35:37,"third_party/xla/xla/service/BUILD, third_party/xla/xla/service/host_offloader.cc, third_party/xla/xla/service/host_offloader_test.cc",cota,False
"Integrate LLVM at llvm/llvm-project@37b7207651b4

Updates LLVM usage to match
[37b7207651b4](https://github.com/llvm/llvm-project/commit/37b7207651b4)

PiperOrigin-RevId: 625178663",Jorge Gorbe Moya,jgorbe@google.com,2024-04-16 03:27:56,"third_party/llvm/generated.patch, third_party/llvm/workspace.bzl",slackito,False
"Fix a bug in quantization driver to skip the qtype propagation only for per-axis quantized type and let the quantization propagate for all other cases.

PiperOrigin-RevId: 625176917",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-16 03:18:45,"tensorflow/compiler/mlir/lite/tests/prepare-quantize.mlir, tensorflow/compiler/mlir/quantization/common/quantization_lib/quantization_driver.cc",tensorflower-gardener,False
"Include a simple quantization report after `QuantizeCompositeFunctionsPass`.

Implements a method `QuantizationReport::ToString` that returns a human-readable report that contains the textproto representation of `QuantizationResults`.
After `QuantizeCompositeFunctionsPass` it simply prints this string to stdout.

The printed report would look something like this:

```
===== Quantization Report =====

results {
  quantizable_unit {
    name: ""composite_dot_general_fn_2""
  }
}
===== Quantization Report End =====
```

PiperOrigin-RevId: 625175621",Dan Suh,dansuh@google.com,2024-04-16 03:11:35,"tensorflow/compiler/mlir/quantization/stablehlo/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/cc/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/cc/report.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/report.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/report_test.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize_composite_functions.cc",dansuh17,False
"Reverts af3028da043dbb9e9c3a1c830fddc6ae35795d58

PiperOrigin-RevId: 625164812",David Dunleavy,ddunleavy@google.com,2024-04-16 02:25:05,"tensorflow/core/tfrt/graph_executor/BUILD, tensorflow/core/tfrt/graph_executor/graph_executor.cc, tensorflow/core/tfrt/graph_executor/graph_executor.h, tensorflow/core/tfrt/ifrt/BUILD, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_registry.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_registry.h, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils_test.cc, tensorflow/core/tfrt/ifrt/ifrt_model_context.cc, tensorflow/core/tfrt/ifrt/ifrt_model_context.h, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.cc, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.h, tensorflow/core/tfrt/ifrt/ifrt_serving_executable_test.cc, tensorflow/core/tfrt/ifrt/sharding_utils.cc, tensorflow/core/tfrt/ifrt/sharding_utils.h, tensorflow/core/tfrt/ifrt/sharding_utils_test.cc, tensorflow/core/tfrt/mlrt/interpreter/BUILD, tensorflow/core/tfrt/mlrt/interpreter/async_handle.cc, tensorflow/core/tfrt/mlrt/interpreter/future_test.cc, tensorflow/core/tfrt/mlrt/kernel/BUILD, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel.cc, third_party/xla/third_party/tsl/tsl/concurrency/BUILD, third_party/xla/third_party/tsl/tsl/concurrency/async_value.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ptr_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/chain.h, third_party/xla/third_party/tsl/tsl/concurrency/concurrent_vector.h, third_party/xla/third_party/tsl/tsl/concurrency/concurrent_vector_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/ref_count.h, third_party/xla/xla/mlir/runtime/transforms/BUILD, third_party/xla/xla/mlir/runtime/transforms/custom_call_encoding.cc, third_party/xla/xla/mlir/runtime/utils/BUILD, third_party/xla/xla/mlir/runtime/utils/async_runtime_api.cc, third_party/xla/xla/mlir/runtime/utils/async_runtime_api.h, third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/cpu/BUILD, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.h, third_party/xla/xla/pjrt/cpu/cpu_client.cc, third_party/xla/xla/pjrt/cpu/cpu_client.h, third_party/xla/xla/pjrt/cpu/tracked_tfrt_cpu_device_buffer.cc, third_party/xla/xla/pjrt/cpu/tracked_tfrt_cpu_device_buffer.h, third_party/xla/xla/pjrt/cpu/tracked_tfrt_cpu_device_buffer_test.cc, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client_test.cc, third_party/xla/xla/python/BUILD, third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/array.h, third_party/xla/xla/python/ifrt/executable.h, third_party/xla/xla/python/ifrt/host_callback.h, third_party/xla/xla/python/ifrt/ir/tests/BUILD, third_party/xla/xla/python/ifrt/ir/tests/executable_impl_test_base.h, third_party/xla/xla/python/ifrt/ir/tests/executable_impl_test_lib.cc, third_party/xla/xla/python/ifrt/mock.cc, third_party/xla/xla/python/ifrt/mock.h, third_party/xla/xla/python/ifrt/test_util.h, third_party/xla/xla/python/ifrt/tuple.h, third_party/xla/xla/python/ifrt/tuple_impl_test_lib.cc, third_party/xla/xla/python/ifrt/value.h, third_party/xla/xla/python/ifrt_proxy/client/BUILD, third_party/xla/xla/python/ifrt_proxy/client/array.cc, third_party/xla/xla/python/ifrt_proxy/client/array.h, third_party/xla/xla/python/ifrt_proxy/client/array_test.cc, third_party/xla/xla/python/ifrt_proxy/client/client.cc, third_party/xla/xla/python/ifrt_proxy/client/client.h, third_party/xla/xla/python/ifrt_proxy/client/compiler.cc, third_party/xla/xla/python/ifrt_proxy/client/executable.cc, third_party/xla/xla/python/ifrt_proxy/client/executable.h, third_party/xla/xla/python/ifrt_proxy/client/executable_test.cc, third_party/xla/xla/python/ifrt_proxy/integration_tests/BUILD, third_party/xla/xla/python/ifrt_proxy/integration_tests/mock_array_test.cc, third_party/xla/xla/python/ifrt_proxy/server/BUILD, third_party/xla/xla/python/ifrt_proxy/server/host_callback.cc, third_party/xla/xla/python/ifrt_proxy/server/host_callback.h, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.h, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend_test.cc, third_party/xla/xla/python/pjit.cc, third_party/xla/xla/python/pjrt_ifrt/BUILD, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_tuple.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_tuple.h, third_party/xla/xla/python/pmap_lib.cc, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/python/py_array.h, third_party/xla/xla/python/py_client.cc, third_party/xla/xla/python/py_compile_only_client.cc, third_party/xla/xla/python/py_executable.cc, third_party/xla/xla/python/py_executable.h, third_party/xla/xla/python/py_host_callback.cc, third_party/xla/xla/python/py_host_callback.h, third_party/xla/xla/python/py_program.cc, third_party/xla/xla/python/py_values.cc, third_party/xla/xla/python/py_values.h, third_party/xla/xla/runtime/BUILD, third_party/xla/xla/runtime/async_runtime.cc, third_party/xla/xla/runtime/async_runtime.h, third_party/xla/xla/runtime/async_runtime_test.cc, third_party/xla/xla/runtime/custom_call.h, third_party/xla/xla/runtime/default/BUILD, third_party/xla/xla/runtime/default/async_values_cache.h, third_party/xla/xla/runtime/jit_executable.h, third_party/xla/xla/service/gpu/runtime/BUILD, third_party/xla/xla/service/gpu/runtime/command_buffer_cmd.cc, third_party/xla/xla/service/gpu/runtime/nccl_api.cc, third_party/xla/xla/service/gpu/runtime/nccl_api.h, third_party/xla/xla/service/gpu/runtime/nccl_api_stub.cc, third_party/xla/xla/service/gpu/runtime/nccl_collective_permute_thunk.h, third_party/xla/xla/service/gpu/runtime/send_recv_thunk.cc, third_party/xla/xla/service/gpu/runtime/send_recv_thunk.h",ddunl,False
"Merge pull request #65568 from Intel-tensorflow:mraunak/win_config

PiperOrigin-RevId: 625099520",TensorFlower Gardener,gardener@tensorflow.org,2024-04-15 22:37:52,configure.py,tensorflower-gardener,False
"Move `tsl/concurrency` to `xla/tsl/concurrency` and update users

PiperOrigin-RevId: 625096733",David Dunleavy,ddunleavy@google.com,2024-04-15 22:08:02,"tensorflow/core/tfrt/graph_executor/BUILD, tensorflow/core/tfrt/graph_executor/graph_executor.cc, tensorflow/core/tfrt/graph_executor/graph_executor.h, tensorflow/core/tfrt/ifrt/BUILD, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_registry.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_registry.h, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils_test.cc, tensorflow/core/tfrt/ifrt/ifrt_model_context.cc, tensorflow/core/tfrt/ifrt/ifrt_model_context.h, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.cc, tensorflow/core/tfrt/ifrt/ifrt_serving_executable.h, tensorflow/core/tfrt/ifrt/ifrt_serving_executable_test.cc, tensorflow/core/tfrt/ifrt/sharding_utils.cc, tensorflow/core/tfrt/ifrt/sharding_utils.h, tensorflow/core/tfrt/ifrt/sharding_utils_test.cc, tensorflow/core/tfrt/mlrt/interpreter/BUILD, tensorflow/core/tfrt/mlrt/interpreter/async_handle.cc, tensorflow/core/tfrt/mlrt/interpreter/future_test.cc, tensorflow/core/tfrt/mlrt/kernel/BUILD, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel.cc, third_party/xla/xla/mlir/runtime/transforms/BUILD, third_party/xla/xla/mlir/runtime/transforms/custom_call_encoding.cc, third_party/xla/xla/mlir/runtime/utils/BUILD, third_party/xla/xla/mlir/runtime/utils/async_runtime_api.cc, third_party/xla/xla/mlir/runtime/utils/async_runtime_api.h, third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/cpu/BUILD, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.h, third_party/xla/xla/pjrt/cpu/cpu_client.cc, third_party/xla/xla/pjrt/cpu/cpu_client.h, third_party/xla/xla/pjrt/cpu/tracked_tfrt_cpu_device_buffer.cc, third_party/xla/xla/pjrt/cpu/tracked_tfrt_cpu_device_buffer.h, third_party/xla/xla/pjrt/cpu/tracked_tfrt_cpu_device_buffer_test.cc, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client_test.cc, third_party/xla/xla/python/BUILD, third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/array.h, third_party/xla/xla/python/ifrt/executable.h, third_party/xla/xla/python/ifrt/host_callback.h, third_party/xla/xla/python/ifrt/ir/tests/BUILD, third_party/xla/xla/python/ifrt/ir/tests/executable_impl_test_base.h, third_party/xla/xla/python/ifrt/ir/tests/executable_impl_test_lib.cc, third_party/xla/xla/python/ifrt/mock.cc, third_party/xla/xla/python/ifrt/mock.h, third_party/xla/xla/python/ifrt/test_util.h, third_party/xla/xla/python/ifrt/tuple.h, third_party/xla/xla/python/ifrt/tuple_impl_test_lib.cc, third_party/xla/xla/python/ifrt/value.h, third_party/xla/xla/python/ifrt_proxy/client/BUILD, third_party/xla/xla/python/ifrt_proxy/client/array.cc, third_party/xla/xla/python/ifrt_proxy/client/array.h, third_party/xla/xla/python/ifrt_proxy/client/array_test.cc, third_party/xla/xla/python/ifrt_proxy/client/client.cc, third_party/xla/xla/python/ifrt_proxy/client/client.h, third_party/xla/xla/python/ifrt_proxy/client/compiler.cc, third_party/xla/xla/python/ifrt_proxy/client/executable.cc, third_party/xla/xla/python/ifrt_proxy/client/executable.h, third_party/xla/xla/python/ifrt_proxy/client/executable_test.cc, third_party/xla/xla/python/ifrt_proxy/integration_tests/BUILD, third_party/xla/xla/python/ifrt_proxy/integration_tests/mock_array_test.cc, third_party/xla/xla/python/ifrt_proxy/server/BUILD, third_party/xla/xla/python/ifrt_proxy/server/host_callback.cc, third_party/xla/xla/python/ifrt_proxy/server/host_callback.h, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.h, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend_test.cc, third_party/xla/xla/python/pjit.cc, third_party/xla/xla/python/pjrt_ifrt/BUILD, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_tuple.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_tuple.h, third_party/xla/xla/python/pmap_lib.cc, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/python/py_array.h, third_party/xla/xla/python/py_client.cc, third_party/xla/xla/python/py_compile_only_client.cc, third_party/xla/xla/python/py_executable.cc, third_party/xla/xla/python/py_executable.h, third_party/xla/xla/python/py_host_callback.cc, third_party/xla/xla/python/py_host_callback.h, third_party/xla/xla/python/py_program.cc, third_party/xla/xla/python/py_values.cc, third_party/xla/xla/python/py_values.h, third_party/xla/xla/runtime/BUILD, third_party/xla/xla/runtime/async_runtime.cc, third_party/xla/xla/runtime/async_runtime.h, third_party/xla/xla/runtime/async_runtime_test.cc, third_party/xla/xla/runtime/custom_call.h, third_party/xla/xla/runtime/default/BUILD, third_party/xla/xla/runtime/default/async_values_cache.h, third_party/xla/xla/runtime/jit_executable.h, third_party/xla/xla/service/gpu/runtime/BUILD, third_party/xla/xla/service/gpu/runtime/command_buffer_cmd.cc, third_party/xla/xla/service/gpu/runtime/nccl_api.cc, third_party/xla/xla/service/gpu/runtime/nccl_api.h, third_party/xla/xla/service/gpu/runtime/nccl_api_stub.cc, third_party/xla/xla/service/gpu/runtime/nccl_collective_permute_thunk.h, third_party/xla/xla/service/gpu/runtime/send_recv_thunk.cc, third_party/xla/xla/service/gpu/runtime/send_recv_thunk.h, third_party/xla/xla/tsl/concurrency/BUILD, third_party/xla/xla/tsl/concurrency/async_value.cc, third_party/xla/xla/tsl/concurrency/async_value.h, third_party/xla/xla/tsl/concurrency/async_value_ptr_test.cc, third_party/xla/xla/tsl/concurrency/async_value_ref.cc, third_party/xla/xla/tsl/concurrency/async_value_ref.h, third_party/xla/xla/tsl/concurrency/async_value_ref_test.cc, third_party/xla/xla/tsl/concurrency/async_value_test.cc, third_party/xla/xla/tsl/concurrency/chain.h, third_party/xla/xla/tsl/concurrency/concurrent_vector.h, third_party/xla/xla/tsl/concurrency/concurrent_vector_test.cc, third_party/xla/xla/tsl/concurrency/ref_count.h",ddunl,False
"Move #include <stddef.h> out of namespace.

PiperOrigin-RevId: 625071617",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 20:50:46,tensorflow/lite/kernels/internal/optimized/depthwiseconv_uint8_3x3_filter.h,tensorflower-gardener,False
"Augments the Memory Term Reducer to merge both primitives *and* groups.

PiperOrigin-RevId: 625070156",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 20:46:25,"third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory_test.cc",tensorflower-gardener,False
"Async dispatch expensive computations on the JAX CPU backend.

Before the change, on CPU backend we always run computations inline unless there are multiple CPU devices with potential collectives. Now, we will use `HloCostAnalysis` to estimate the cost of the computation and do async dispatch if it is expensive.

Add a JAX flag for users to opt-out by adding `jax.config.update('jax_cpu_enable_async_dispatch', False)` in their programs.

PiperOrigin-RevId: 625064815",Yue Sheng,yueshengys@google.com,2024-04-15 20:28:56,"third_party/xla/xla/pjrt/cpu/BUILD, third_party/xla/xla/pjrt/cpu/cpu_client.cc, third_party/xla/xla/pjrt/cpu/cpu_client.h, third_party/xla/xla/python/xla_client.py, third_party/xla/xla/python/xla_client.pyi",yueshengys,False
"Register vhlo related pass and other dialects.

PiperOrigin-RevId: 625053769",Luke Boyer,lukeboyer@google.com,2024-04-15 19:56:02,"tensorflow/compiler/mlir/lite/stablehlo/odml_converter/BUILD, tensorflow/compiler/mlir/lite/stablehlo/odml_converter/odml_converter_main.cc",LukeBoyer,False
"Integrate StableHLO at openxla/stablehlo@714d9aca

PiperOrigin-RevId: 625047417",Kevin Gleason,gleasonk@google.com,2024-04-15 19:34:02,"tensorflow/compiler/mlir/tf2xla/tests/legalize-tf.mlir, third_party/stablehlo/temporary.patch, third_party/stablehlo/workspace.bzl, third_party/xla/third_party/stablehlo/temporary.patch, third_party/xla/third_party/stablehlo/workspace.bzl",GleasonK,False
"Refactor out an util function that load a registered named variable tensor into ifrt array.

PiperOrigin-RevId: 625046944",Siqiao Wu,siqiaowu@google.com,2024-04-15 19:32:22,"tensorflow/core/tfrt/ifrt/BUILD, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.cc, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils.h, tensorflow/core/tfrt/ifrt/ifrt_loaded_variable_utils_test.cc, tensorflow/core/tfrt/mlrt/kernel/BUILD, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel.cc",SiqiaoWu1993,False
"Optimize `BatchedDevicePut` by batching GIL release

The current `BatchedDevicePut` implementation interleaves Python work and C++ IFRT work, causing GIL to be repeatedly released/acquired for a single `jax.device_put()` call. This is particularly problematic for cases where there are a large number of devices.

This CL refactors `BatchedDevicePut` into two phases: `DevicePut` performs all Python work inline for formatting/casting the input object and returns a functor that performs C++ work. This allows us to change `BatchedDevicePut` to perform all Python work upfront, leaving all C++ work across all shards to be done in one GIL release.

PiperOrigin-RevId: 625036017",Junwhan Ahn,junwhan@google.com,2024-04-15 18:57:33,"third_party/xla/xla/python/BUILD, third_party/xla/xla/python/pjit.cc, third_party/xla/xla/python/pmap_lib.cc, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/python/py_client.cc, third_party/xla/xla/python/py_values.cc, third_party/xla/xla/python/py_values.h",junwhanahn,False
"Adds a bunch more unit tests for the Memory Term Reducer to cover various edge cases.

PiperOrigin-RevId: 625035538",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 18:55:58,third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory_test.cc,tensorflower-gardener,False
"Reverts 15c15ee35a11361b42aeb49dc53e9034dc54c400

PiperOrigin-RevId: 625034723",Clive Verghese,cliveverghese@google.com,2024-04-15 18:53:14,"tensorflow/core/profiler/BUILD, third_party/xla/third_party/tsl/tsl/platform/tracing.h, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/BUILD, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener.cc, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener.h, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener_state.cc, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener_state.h, third_party/xla/third_party/tsl/tsl/profiler/lib/BUILD, third_party/xla/third_party/tsl/tsl/profiler/lib/context_types.cc, third_party/xla/third_party/tsl/tsl/profiler/lib/context_types.h, third_party/xla/third_party/tsl/tsl/profiler/utils/BUILD, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane.h, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane_test.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.h, third_party/xla/xla/backends/profiler/cpu/BUILD, third_party/xla/xla/backends/profiler/cpu/host_tracer.cc",cliveverghese,False
"Add support for mutable zero-copy buffers

PiperOrigin-RevId: 625030837",Eugene Zhulenev,ezhulenev@google.com,2024-04-15 18:40:59,"third_party/xla/xla/pjrt/c/CHANGELOG.md, third_party/xla/xla/pjrt/c/pjrt_c_api.h, third_party/xla/xla/pjrt/c/pjrt_c_api_helpers.cc, third_party/xla/xla/pjrt/cpu/BUILD, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/pjrt/cpu/tracked_tfrt_cpu_device_buffer.h, third_party/xla/xla/pjrt/pjrt_client.h",ezhulenev,False
"Remove unused StreamExecutorInterface::SynchronousMemcpyDeviceToDevice method and associated unused callers.

PiperOrigin-RevId: 625028049",Kyle Lucke,klucke@google.com,2024-04-15 18:32:52,"tensorflow/c/experimental/stream_executor/stream_executor.cc, tensorflow/c/experimental/stream_executor/stream_executor_test.cc, third_party/xla/xla/backends/interpreter/executor.h, third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/device_memory_allocator.h, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/host/host_executor.cc, third_party/xla/xla/stream_executor/host/host_executor.h, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/stream_executor/stream_executor_interface.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h, third_party/xla/xla/stream_executor/tpu/tpu_executor.cc, third_party/xla/xla/stream_executor/tpu/tpu_executor.h",klucke,False
"Introduces a 'Memory Term Reducer' that merges terms appearing together in many memory constraints.

PiperOrigin-RevId: 625023642",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 18:20:45,"third_party/xla/xla/hlo/experimental/auto_sharding/BUILD, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory.h, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory_test.cc",tensorflower-gardener,False
"Make `xla::TypeToShape` could convert `stablehlo.token` to xla token shape rather than an empty shape.

Also fixed some headers.

PiperOrigin-RevId: 625022388",Yue Sheng,yueshengys@google.com,2024-04-15 18:16:52,"third_party/xla/xla/translate/mhlo_to_hlo/BUILD, third_party/xla/xla/translate/mhlo_to_hlo/type_to_shape.cc",yueshengys,False
switched to f-strings,Raunak,mayank.kumar.raunak@intel.com,2024-04-15 18:25:36,configure.py,mraunak,True
"Delete unused lowering code.

PiperOrigin-RevId: 625004641",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 17:26:12,"tensorflow/compiler/mlir/tfrt/BUILD, tensorflow/compiler/mlir/tfrt/function/function.cc, tensorflow/compiler/mlir/tfrt/function/function.h, tensorflow/compiler/mlir/tfrt/transforms/passes.h, tensorflow/compiler/mlir/tfrt/transforms/tf_to_tfrt.cc, tensorflow/compiler/mlir/tfrt/translate/import_model.cc, tensorflow/compiler/mlir/tfrt/translate/import_model.h",tensorflower-gardener,False
"Add unbounded dynamism test for ReduceScatterOp.

PiperOrigin-RevId: 625000701",Gunhyun Park,gunhyun@google.com,2024-04-15 17:14:48,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"[XLA:SPMD] Add DUS to aggressiveness 0.

PiperOrigin-RevId: 624991974",Tongfei Guo,tongfei@google.com,2024-04-15 16:50:45,third_party/xla/xla/service/sharding_propagation.cc,Tongfei-Guo,False
"Use payload in jit compiler Error

PiperOrigin-RevId: 624975465",Vladyslav Tsilytskyi,tsilytskyi@google.com,2024-04-15 15:52:39,"third_party/xla/xla/mlir/runtime/transforms/BUILD, third_party/xla/xla/mlir/runtime/transforms/jit_compiler.h",tvladyslav,False
"Use `xla::ifrt::Array::FullyReplicatedShard()` for materializing fully-replicated arrays

This allows us to avoid potentially expensive device array explosion when we know the array is fully replicated. To make repeated calls to `PyArray::FullyReplicatedShard()` as efficient as retrieving `py_arrays`, this CL also adds caching for `PyArray::FullyReplicatedShard()`.

Note: Most `FullyRepliciatedShard()` implementations today do not return an error if the array is actually not fully replicated and instead choose one shard, unlike `FetchSingleShard` which does have an (incomplete) shape-based check. This is acceptable because `_single_device_array_to_np_array` and `_copy_single_device_array_to_host_async` are internal APIs that are called only if JAX knows that the array is fully sharded, and its Python implementation does not have such a check either.
PiperOrigin-RevId: 624969027",Junwhan Ahn,junwhan@google.com,2024-04-15 15:28:23,"third_party/xla/xla/python/py_array.cc, third_party/xla/xla/python/py_array.h",junwhanahn,False
"Fix checkfail in crop_and_resize_op

The Op CropAndResize checkfails with an input where boxes and box_ind both are 1D and empty tensors. This is due to missing validation for this particular case which skips the check of boxes for Rank-2.",Surya,116063290+SuryanarayanaY@users.noreply.github.com,2024-04-15 14:45:56,tensorflow/core/kernels/image/crop_and_resize_op.cc,SuryanarayanaY,True
"Fix IncludeCleaner errors.

PiperOrigin-RevId: 624948644",Peter Hawkins,phawkins@google.com,2024-04-15 14:10:25,"third_party/xla/xla/python/BUILD, third_party/xla/xla/python/py_array.cc, third_party/xla/xla/python/py_array.h, third_party/xla/xla/python/py_executable.cc, third_party/xla/xla/python/py_executable.h, third_party/xla/xla/python/py_host_callback.cc, third_party/xla/xla/python/py_values.h, third_party/xla/xla/python/pytree.cc, third_party/xla/xla/python/refine_polymorphic_shapes.cc, third_party/xla/xla/python/refine_polymorphic_shapes.h, third_party/xla/xla/python/sharding.cc",hawkinsp,False
"[XLA] Fix issue in MHLO->HLO where a constant with less than 32 elements wouldn't have kept the sharding when being converted to HLO scalar constant + broadcast.

PiperOrigin-RevId: 624942532",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 13:43:20,"third_party/xla/xla/client/xla_builder.cc, third_party/xla/xla/translate/mhlo_to_hlo/mlir_hlo_to_hlo.cc, third_party/xla/xla/translate/mhlo_to_hlo/tests/sharding.mlir",tensorflower-gardener,False
"Relax expectation for log(complex) where abs(complex) = max_float.

Both 88.7228394 and inf should be valid results for the real part.
Note that inf is already returned for log(complex * (1+epsilon)).

PiperOrigin-RevId: 624934837",Johannes Reifferscheid,jreiffers@google.com,2024-04-15 13:08:07,third_party/xla/xla/tests/exhaustive/exhaustive_unary_test_complex.cc,jreiffers,False
"(1/N) Remove StableHLO Quantizer quantize pass dependency to preset.

Preset flags should be replaced by respective `QuantizationSpecs` and should not be referred in later passes after `ExpandPresets`. This CL does the following:
* Removes `*Preset` after `ExpandPresets`, making sure later passes do not reference to `Preset` but via `QuantizationSpecs`.
* Removes StableHLO Quantizer's dependency on explicit `enable_full_int_quantization` preset flag in quantization passes.

Follow-up cl's will completely remove `StaticRangePtqPreset` dependency in quantize passes.

PiperOrigin-RevId: 624929003",Jiyoun (Jen) Ha,jiyounha@google.com,2024-04-15 12:42:49,"tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/component.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/config.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/pass_pipeline.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/pass_pipeline.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/post_calibration.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/post_calibration.h, tensorflow/compiler/mlir/quantization/stablehlo/passes/passes.td, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantization_patterns.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize_composite_functions.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/testing/test_post_calibration_component.cc, tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/quantize_model_test.py, tensorflow/compiler/mlir/quantization/stablehlo/python/quantization.py, tensorflow/compiler/mlir/quantization/stablehlo/tests/components/post_calibration_component.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize_op_with_region.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize_same_scale.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize/quantize_weight_only.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions_all_ops.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions_weight_only.mlir",chococigar,False
"Update GraphDef version to 1833.

PiperOrigin-RevId: 624878792",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 09:02:33,tensorflow/core/public/version.h,tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-15

PiperOrigin-RevId: 624878654",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 09:02:10,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624874768",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 08:45:45,"tensorflow/core/util/strided_slice_op_test.cc, tensorflow/core/util/tensor_format.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624871370",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 08:30:25,"tensorflow/compiler/mlir/tools/kernel_gen/hlo_to_kernel.cc, tensorflow/compiler/mlir/tools/kernel_gen/kernel_creator.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624871160",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 08:29:44,"tensorflow/core/util/quantization/uniform_quant_ops_params.cc, tensorflow/core/util/quantization/uniform_quant_ops_params.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624869111",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 08:21:00,tensorflow/compiler/aot/compile.cc,tensorflower-gardener,False
"Pass a flag whether we are in code emission phase.

When trying to bisect failing fusions with the new mlir emitters, we have the flags
xla_gpu_max_mlir_kernels and xla_gpu_skip_mlir_kernels. However the function
GetFusionEmitter() is also called during fusion passes. It seems we have some
non-determinism regarding how often it is called during fusion passes, so it is not
easy to determine what value should be used for xla_gpu_skip_mlir_kernels to skip
all the calls during fusion passes. Instead, better only start counting in the
code emission phase.

PiperOrigin-RevId: 624838240",Adrian Kuegel,akuegel@google.com,2024-04-15 05:50:18,"third_party/xla/xla/service/gpu/fusions/fusions.cc, third_party/xla/xla/service/gpu/fusions/fusions.h, third_party/xla/xla/service/gpu/ir_emitter_unnested.cc",akuegel,False
"Merge pull request #65507 from tensorflow:dependabot/pip/idna-3.7

PiperOrigin-RevId: 624829507",TensorFlower Gardener,gardener@tensorflow.org,2024-04-15 05:16:58,"requirements_lock_3_10.txt, requirements_lock_3_11.txt, requirements_lock_3_12.txt, requirements_lock_3_9.txt",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624829221",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 04:51:32,"tensorflow/examples/speech_commands/BUILD, tensorflow/examples/speech_commands/accuracy_utils.cc, tensorflow/examples/speech_commands/accuracy_utils.h, tensorflow/examples/speech_commands/accuracy_utils_test.cc, tensorflow/examples/speech_commands/label_wav.cc, tensorflow/examples/speech_commands/recognize_commands.cc, tensorflow/examples/speech_commands/recognize_commands.h, tensorflow/examples/speech_commands/recognize_commands_test.cc, tensorflow/examples/speech_commands/test_streaming_accuracy.cc",tensorflower-gardener,False
"diag_rank validation in MatrixDiagV3

Simplified diag_rank validation in MatrixDiagV3.",Surya,116063290+SuryanarayanaY@users.noreply.github.com,2024-04-15 04:28:31,tensorflow/core/kernels/linalg/matrix_diag_op.cc,SuryanarayanaY,True
"Automated Code Change

PiperOrigin-RevId: 624817449",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 03:33:14,tensorflow/core/platform/protobuf_internal.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624816574",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 03:28:02,"tensorflow/c/c_api.cc, tensorflow/c/c_api_experimental.cc, tensorflow/c/c_api_function.cc, tensorflow/c/c_api_test.cc",tensorflower-gardener,False
"[XLA:MSA] Rename `AlternateMemoryBestFitHeap` to `MsaAlgorithm`.

PiperOrigin-RevId: 624790395",Subhankar Shah,subhankarshah@google.com,2024-04-15 00:53:51,"third_party/xla/xla/hlo/ir/hlo_instructions.h, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.cc, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.h, third_party/xla/xla/service/memory_space_assignment/options.h",subhankarshah,False
"Automated Code Change

PiperOrigin-RevId: 624782782",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-15 00:02:01,tensorflow/distribute/experimental/rpc/kernels/rpc_ops.cc,tensorflower-gardener,False
"[XLA:MSA] Move `BufferIntervalComparator` and its implementations `MemoryBoundednessBufferIntervalComparator` and `DefaultCrossProgramPrefetchBufferIntervalComparator` to  `buffer_interval_comparator.h/cc` files under `memory_space_assignment` directory.

PiperOrigin-RevId: 624780508",Subhankar Shah,subhankarshah@google.com,2024-04-14 23:44:35,"third_party/xla/xla/service/memory_space_assignment/BUILD, third_party/xla/xla/service/memory_space_assignment/buffer_interval_comparator.cc, third_party/xla/xla/service/memory_space_assignment/buffer_interval_comparator.h, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.cc, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.h, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment_test.cc, third_party/xla/xla/service/memory_space_assignment/options.h",subhankarshah,False
"Automated Code Change

PiperOrigin-RevId: 624764034",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 21:38:55,"tensorflow/core/tfrt/runtime/runtime.h, tensorflow/core/tfrt/runtime/tf_threadpool_concurrent_work_queue.cc, tensorflow/core/tfrt/runtime/tf_threadpool_concurrent_work_queue.h, tensorflow/core/tfrt/runtime/work_queue_interface.cc, tensorflow/core/tfrt/runtime/work_queue_interface.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624764030",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 21:38:52,tensorflow/core/tfrt/utils/debug/node_io_dump_rewriter.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624763714",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 21:36:12,"tensorflow/core/runtime_fallback/kernel/attr_util.cc, tensorflow/core/runtime_fallback/kernel/kernel_fallback_compat_request_state.cc, tensorflow/core/runtime_fallback/kernel/kernel_fallback_execute_compat.cc, tensorflow/core/runtime_fallback/kernel/kernel_fallback_execute_compat_eager.cc, tensorflow/core/runtime_fallback/kernel/kernel_fallback_op_handler.cc, tensorflow/core/runtime_fallback/kernel/tfrt_op_kernel.cc, tensorflow/core/runtime_fallback/kernel/tfrt_op_kernel.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624763692",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 21:36:01,"tensorflow/c/experimental/stream_executor/stream_executor.cc, tensorflow/c/experimental/stream_executor/stream_executor_internal.h, tensorflow/c/experimental/stream_executor/stream_executor_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624763555",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 21:34:45,"tensorflow/c/kernels_experimental.cc, tensorflow/c/tf_buffer.cc, tensorflow/c/tf_status_helper.cc, tensorflow/c/tf_status_helper.h, tensorflow/c/tf_status_helper_test.cc, tensorflow/c/tf_tensor.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624763548",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 21:34:42,"tensorflow/core/runtime_fallback/runtime/fallback_batch_kernel.cc, tensorflow/core/runtime_fallback/runtime/runtime_fallback_batch_tf_opkernels.cc, tensorflow/core/runtime_fallback/runtime/runtime_fallback_kernels.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624754123",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 20:22:00,"tensorflow/compiler/mlir/tf2xla/internal/legalize_tf_mlir.cc, tensorflow/compiler/mlir/tf2xla/internal/legalize_tf_mlir.h, tensorflow/compiler/mlir/tf2xla/internal/legalize_tf_mlir_test.cc, tensorflow/compiler/mlir/tf2xla/internal/legalize_tf_to_hlo.cc, tensorflow/compiler/mlir/tf2xla/internal/legalize_tf_to_hlo.h, tensorflow/compiler/mlir/tf2xla/internal/legalize_tf_to_hlo_test.cc, tensorflow/compiler/mlir/tf2xla/internal/logging_hooks_test.cc, tensorflow/compiler/mlir/tf2xla/internal/test_matchers_test.cc",tensorflower-gardener,False
"Add prettier printing for constant operations to make it easier to debug differences is non-constant operations, even if constants are different

PiperOrigin-RevId: 624739181",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 18:26:48,"tensorflow/compiler/mlir/lite/stablehlo/tests/legalize-tfl-stablehlo-constant.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/odml-to-stablehlo-allow-tf.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/odml-to-stablehlo-smuggle-resize.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/tf-tfl-translate-serialize-stablehlo.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/tf-tfl-translate-tf-quantize.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/components/post_calibration_component.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions.mlir",tensorflower-gardener,False
"[XLA] Clear derived instruction's sharding only if shapes are incompatible.

When AlgebraicSimplifier calls `dot->SetupDerivedInstruction(new_lhs);` in HandleDot, lhs sharding was cleared when dot didn't have a sharding. With this CL, lhs preserves its sharding because the condition for clearing the sharding is narrowed down to only when shapes are incompatible.

Fixes https://github.com/google/jax/issues/20710

PiperOrigin-RevId: 624731930",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 17:30:10,"third_party/xla/xla/hlo/ir/hlo_instruction.cc, third_party/xla/xla/service/algebraic_simplifier_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624679822",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 11:01:20,tensorflow/compiler/mlir/quantization/tensorflow/python/unfreeze_constants.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624673670",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 10:24:26,tensorflow/compiler/mlir/lite/quantization/stablehlo/quantization.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624673639",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 10:24:14,"tensorflow/compiler/mlir/quantization/stablehlo/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/passes/testing/test_post_calibration_component.cc",tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-14

PiperOrigin-RevId: 624660975",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 09:03:41,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Update GraphDef version to 1832.

PiperOrigin-RevId: 624660647",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 09:02:26,tensorflow/core/public/version.h,tensorflower-gardener,False
"Fix microkernel algorithm typo.

PiperOrigin-RevId: 624632922",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 06:11:25,third_party/xla/xla/pjrt/transpose_kernels.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624630380",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 05:55:53,"tensorflow/core/tfrt/common/create_pjrt_client_util.cc, tensorflow/core/tfrt/common/pjrt_state.cc, tensorflow/core/tfrt/common/pjrt_util.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624623528",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 05:07:00,"third_party/xla/third_party/tsl/tsl/profiler/rpc/client/capture_profile.cc, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/capture_profile.h, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/profiler_client.cc, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/profiler_client.h, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/profiler_client_test.cc, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/remote_profiler_session_manager.cc, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/remote_profiler_session_manager.h, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/remote_profiler_session_manager_test.cc, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/save_profile.cc, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/save_profile.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624623382",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-14 05:06:04,"third_party/xla/third_party/tsl/tsl/profiler/utils/session_manager.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/session_manager.h",tensorflower-gardener,False
"Clean up TF deps.

PiperOrigin-RevId: 624524298",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 18:40:56,"tensorflow/compiler/mlir/quantization/tensorflow/BUILD, tensorflow/lite/BUILD",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624523359",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 18:34:23,"tensorflow/security/fuzzing/cc/BUILD, tensorflow/security/fuzzing/cc/end_to_end_fuzz.cc",tensorflower-gardener,False
"[pjrt] Use single PjRtFuture<>::Promise::Set() API to set completion success or error

PiperOrigin-RevId: 624518165",Eugene Zhulenev,ezhulenev@google.com,2024-04-13 18:02:09,"third_party/xla/xla/pjrt/c/pjrt_c_api_helpers.cc, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/pjrt/cpu/cpu_client.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.cc, third_party/xla/xla/pjrt/pjrt_client.cc, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_future.cc, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_future_test.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc",ezhulenev,False
"IfrtLoadVariable current returns a key to look for loaded variable.
This CL adds a second result: restored tensor future.

PiperOrigin-RevId: 624516831",Deqiang Chen,deqiangc@google.com,2024-04-13 17:53:49,"tensorflow/compiler/mlir/tensorflow/ir/host_runtime/tfrt_ops.td, tensorflow/compiler/mlir/tfrt/ir/mlrt/tf_mlrt_ops.td, tensorflow/compiler/mlir/tfrt/ir/mlrt/tf_ops.td, tensorflow/compiler/mlir/tfrt/tests/ifrt/sink_variable_as_named_array.mlir, tensorflow/compiler/mlir/tfrt/tests/mlrt/rewrite_ifrt_load_variable.mlir, tensorflow/compiler/mlir/tfrt/tests/mlrt/tf_to_mlrt.mlir, tensorflow/compiler/mlir/tfrt/transforms/ifrt/sink_variable_as_named_array.cc, tensorflow/compiler/mlir/tfrt/transforms/ifrt/tf_ifrt_passes.cc, tensorflow/compiler/mlir/tfrt/transforms/mlrt/BUILD, tensorflow/compiler/mlir/tfrt/transforms/mlrt/passes.cc, tensorflow/compiler/mlir/tfrt/transforms/mlrt/rewrite_ifrt_load_variable.cc, tensorflow/compiler/mlir/tfrt/transforms/mlrt/rewrite_ifrt_load_variable.h, tensorflow/compiler/mlir/tfrt/transforms/mlrt/tf_to_mlrt.cc, tensorflow/compiler/mlir/tfrt/transforms/mlrt/util.cc, tensorflow/core/tfrt/mlrt/kernel/BUILD, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel.cc, tensorflow/core/tfrt/mlrt/kernel/ifrt_ops_kernel_test.cc, tensorflow/core/tfrt/ops/ifrt_program_ops.cc, tensorflow/core/tfrt/saved_model/tests/BUILD, tensorflow/core/tfrt/saved_model/tests/saved_model_ifrt_test.cc",deqiangc,False
"Split stream_executor_internal.h into separate files defining the three Interface classes, and move them out of the internal namespace in preparation for removing the PIMPL pattern.

PiperOrigin-RevId: 624507622",Kyle Lucke,klucke@google.com,2024-04-13 16:51:29,"tensorflow/c/experimental/stream_executor/BUILD, tensorflow/c/experimental/stream_executor/stream_executor.cc, tensorflow/c/experimental/stream_executor/stream_executor_internal.h, third_party/xla/xla/backends/interpreter/BUILD, third_party/xla/xla/backends/interpreter/executor.h, third_party/xla/xla/stream_executor/BUILD, third_party/xla/xla/stream_executor/command_buffer.cc, third_party/xla/xla/stream_executor/cuda/BUILD, third_party/xla/xla/stream_executor/cuda/cuda_blas.cc, third_party/xla/xla/stream_executor/cuda/cuda_dnn.cc, third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/cuda/cuda_fft.cc, third_party/xla/xla/stream_executor/event.cc, third_party/xla/xla/stream_executor/event.h, third_party/xla/xla/stream_executor/event_interface.h, third_party/xla/xla/stream_executor/gpu/BUILD, third_party/xla/xla/stream_executor/gpu/gpu_command_buffer.h, third_party/xla/xla/stream_executor/gpu/gpu_event.h, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/gpu/gpu_stream.h, third_party/xla/xla/stream_executor/host/BUILD, third_party/xla/xla/stream_executor/host/host_executor.cc, third_party/xla/xla/stream_executor/host/host_executor.h, third_party/xla/xla/stream_executor/host/host_stream.h, third_party/xla/xla/stream_executor/host_memory_allocation.cc, third_party/xla/xla/stream_executor/host_memory_allocation.h, third_party/xla/xla/stream_executor/kernel.cc, third_party/xla/xla/stream_executor/plugin_registry.h, third_party/xla/xla/stream_executor/rocm/BUILD, third_party/xla/xla/stream_executor/rocm/rocm_blas.cc, third_party/xla/xla/stream_executor/rocm/rocm_dnn.cc, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/stream_executor/rocm/rocm_fft.cc, third_party/xla/xla/stream_executor/rocm/rocm_platform.h, third_party/xla/xla/stream_executor/stream.cc, third_party/xla/xla/stream_executor/stream.h, third_party/xla/xla/stream_executor/stream_executor_interface.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h, third_party/xla/xla/stream_executor/stream_interface.h, third_party/xla/xla/stream_executor/tpu/BUILD, third_party/xla/xla/stream_executor/tpu/tpu_event.h, third_party/xla/xla/stream_executor/tpu/tpu_executor.cc, third_party/xla/xla/stream_executor/tpu/tpu_executor.h, third_party/xla/xla/stream_executor/tpu/tpu_executor_interface.h, third_party/xla/xla/stream_executor/tpu/tpu_platform.cc, third_party/xla/xla/stream_executor/tpu/tpu_platform.h, third_party/xla/xla/stream_executor/tpu/tpu_stream_interface.h",klucke,False
"Automated Code Change

PiperOrigin-RevId: 624498826",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 15:49:54,tensorflow/core/profiler/convert/op_stats_to_op_profile.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624486921",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 14:27:29,"tensorflow/core/framework/attr_value_util.h, tensorflow/core/framework/function.h, tensorflow/core/framework/function_testlib.cc, tensorflow/core/framework/function_testlib.h, tensorflow/core/framework/kernel_def_builder.cc, tensorflow/core/framework/kernel_def_builder.h, tensorflow/core/framework/kernel_def_builder_test.cc, tensorflow/core/framework/node_def_builder.h, tensorflow/core/framework/node_def_util.h, tensorflow/core/framework/op_kernel.h, tensorflow/core/framework/stats_aggregator.h, tensorflow/core/framework/tensor.h, tensorflow/core/framework/tensor_test.cc, tensorflow/core/framework/tensor_util.h, tensorflow/core/framework/types.h, tensorflow/core/framework/variant_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624485864",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 14:18:21,third_party/xla/xla/translate/hlo_to_mhlo/hlo_utils.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624485228",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 14:13:46,third_party/xla/xla/translate/mhlo_to_hlo/mlir_hlo_to_hlo.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624467211",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 12:10:11,tensorflow/core/data/service/cross_trainer_cache_test.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624461155",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 11:33:10,third_party/xla/xla/literal_util.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624458728",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 11:17:57,tensorflow/core/grappler/costs/graph_properties_test.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624451758",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 10:36:48,third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.cc,tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-13

PiperOrigin-RevId: 624449180",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 10:24:07,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624447840",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 10:15:24,third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624447432",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 10:12:32,"tensorflow/core/debug/debug_io_utils.cc, tensorflow/core/debug/debug_io_utils.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624441993",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 09:40:44,tensorflow/core/tfrt/utils/utils.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624436696",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 09:09:17,"tensorflow/cc/experimental/base/tests/tensor_test.cc, tensorflow/cc/experimental/base/tests/tensorhandle_test.cc",tensorflower-gardener,False
"Update GraphDef version to 1831.

PiperOrigin-RevId: 624435308",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 09:02:16,tensorflow/core/public/version.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624430856",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 08:37:08,tensorflow/cc/framework/scope.h,tensorflower-gardener,False
"[pjrt] Switch all remaining PjRtClient APIs to stateless PjRtFuture<>

PiperOrigin-RevId: 624427270",Eugene Zhulenev,ezhulenev@google.com,2024-04-13 08:18:32,"tensorflow/compiler/jit/xla_launch_util.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_test.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.h, third_party/xla/xla/pjrt/cpu/cpu_client.cc, third_party/xla/xla/pjrt/cpu/cpu_client.h, third_party/xla/xla/pjrt/pjrt_c_api_client.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.h, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.h, third_party/xla/xla/pjrt/tf_pjrt_client.cc, third_party/xla/xla/pjrt/tf_pjrt_client.h, third_party/xla/xla/python/ifrt/future.cc, third_party/xla/xla/python/ifrt/future.h, third_party/xla/xla/python/ifrt/future_test.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.cc, third_party/xla/xla/python/py_executable.cc, third_party/xla/xla/python/py_executable.h, third_party/xla/xla/service/hlo_runner_pjrt.cc, third_party/xla/xla/tools/multihost_hlo_runner/functional_hlo_runner.cc",ezhulenev,False
"Automated Code Change

PiperOrigin-RevId: 624423565",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 07:58:02,"tensorflow/core/graph/algorithm.cc, tensorflow/core/graph/algorithm.h, tensorflow/core/graph/costmodel_test.cc, tensorflow/core/graph/graph_def_builder.cc, tensorflow/core/graph/graph_def_builder.h, tensorflow/core/graph/graph_partition_test.cc, tensorflow/core/graph/node_builder.h, tensorflow/core/graph/subgraph.cc, tensorflow/core/graph/subgraph.h, tensorflow/core/graph/testlib.cc, tensorflow/core/graph/testlib.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624422733",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 07:52:55,"tensorflow/compiler/jit/pjrt_device_context.cc, tensorflow/compiler/jit/xla_device.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624422631",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 07:52:08,"tensorflow/cc/training/coordinator.cc, tensorflow/cc/training/queue_runner.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624421580",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 07:45:44,"tensorflow/core/tpu/ops/sparse_core_ops.cc, tensorflow/core/tpu/ops/sparse_core_preprocess_ops.cc, tensorflow/core/tpu/ops/topk_ops.cc, tensorflow/core/tpu/ops/tpu_compile_op.cc, tensorflow/core/tpu/ops/tpu_copy_with_dynamic_shape_op.cc, tensorflow/core/tpu/ops/tpu_execute_op.cc, tensorflow/core/tpu/ops/tpu_handle_to_key_op.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624421261",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 07:43:46,tensorflow/dtensor/cc/dtensor_device.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624416580",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 07:15:24,"tensorflow/compiler/mlir/tf2xla/api/v1/cluster_tf_test.cc, tensorflow/compiler/mlir/tf2xla/api/v1/compile_mlir_util.cc, tensorflow/compiler/mlir/tf2xla/api/v1/compile_mlir_util.h, tensorflow/compiler/mlir/tf2xla/api/v1/compile_tf_graph.cc, tensorflow/compiler/mlir/tf2xla/api/v1/compile_tf_graph.h, tensorflow/compiler/mlir/tf2xla/api/v1/compile_tf_graph_test.cc, tensorflow/compiler/mlir/tf2xla/api/v1/tf_dialect_to_executor_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624412731",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 06:56:37,"tensorflow/core/tfrt/mlrt/kernel/batch_kernel.cc, tensorflow/core/tfrt/mlrt/kernel/kernel.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624412501",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 06:55:27,tensorflow/core/tfrt/ifrt/sharding_utils.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624410733",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 06:45:07,"tensorflow/compiler/mlir/tf2xla/api/v2/cluster_tf_test.cc, tensorflow/compiler/mlir/tf2xla/api/v2/legalize_tf.cc, tensorflow/compiler/mlir/tf2xla/api/v2/legalize_tf.h, tensorflow/compiler/mlir/tf2xla/api/v2/legalize_tf_test.cc, tensorflow/compiler/mlir/tf2xla/api/v2/tf_dialect_to_executor_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624410019",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 06:40:57,"tensorflow/core/tfrt/run_handler_thread_pool/run_handler.cc, tensorflow/core/tfrt/run_handler_thread_pool/run_handler_concurrent_work_queue.cc, tensorflow/core/tfrt/run_handler_thread_pool/run_handler_concurrent_work_queue.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624409097",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 06:35:20,"third_party/xla/third_party/tsl/tsl/lib/io/table.cc, third_party/xla/third_party/tsl/tsl/lib/io/table.h, third_party/xla/third_party/tsl/tsl/lib/io/table_builder.cc, third_party/xla/third_party/tsl/tsl/lib/io/table_builder.h, third_party/xla/third_party/tsl/tsl/lib/io/table_test.cc, third_party/xla/third_party/tsl/tsl/lib/io/two_level_iterator.cc, third_party/xla/third_party/tsl/tsl/lib/io/zlib_buffers_test.cc, third_party/xla/third_party/tsl/tsl/lib/io/zlib_inputstream.cc, third_party/xla/third_party/tsl/tsl/lib/io/zlib_inputstream.h, third_party/xla/third_party/tsl/tsl/lib/io/zlib_outputbuffer.cc, third_party/xla/third_party/tsl/tsl/lib/io/zlib_outputbuffer.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624405887",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 06:16:29,third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624403331",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 06:02:04,"tensorflow/core/profiler/convert/hlo_proto_to_graph_view.cc, tensorflow/core/profiler/convert/hlo_proto_to_graph_view.h, tensorflow/core/profiler/convert/hlo_to_tools_data.cc, tensorflow/core/profiler/convert/hlo_to_tools_data.h, tensorflow/core/profiler/convert/op_stats_to_overview_page.cc, tensorflow/core/profiler/convert/op_stats_to_pod_stats.cc, tensorflow/core/profiler/convert/op_stats_to_pod_stats_test.cc, tensorflow/core/profiler/convert/op_stats_to_pod_viewer_test.cc, tensorflow/core/profiler/convert/op_stats_to_tf_stats.cc, tensorflow/core/profiler/convert/repository.cc, tensorflow/core/profiler/convert/repository.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624402317",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:55:48,"third_party/xla/third_party/tsl/tsl/lib/io/snappy/snappy_inputbuffer.cc, third_party/xla/third_party/tsl/tsl/lib/io/snappy/snappy_inputbuffer.h, third_party/xla/third_party/tsl/tsl/lib/io/snappy/snappy_inputstream.cc, third_party/xla/third_party/tsl/tsl/lib/io/snappy/snappy_inputstream.h, third_party/xla/third_party/tsl/tsl/lib/io/snappy/snappy_outputbuffer.cc, third_party/xla/third_party/tsl/tsl/lib/io/snappy/snappy_outputbuffer.h, third_party/xla/third_party/tsl/tsl/lib/io/snappy/snappy_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624402132",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:54:38,tensorflow/tools/proto_splitter/cc/util_test.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624402078",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:54:17,tensorflow/python/client/tf_session_wrapper.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624401627",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:51:33,third_party/xla/xla/tests/multiple_devices_on_host_test.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624401549",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:51:03,"third_party/xla/xla/service/constant_value.cc, third_party/xla/xla/service/hlo_runner.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624399443",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:37:53,"tensorflow/cc/framework/grad_op_registry.cc, tensorflow/cc/framework/gradient_checker.cc, tensorflow/cc/framework/gradients.cc, tensorflow/cc/framework/ops.h, tensorflow/cc/framework/scope.cc, tensorflow/cc/framework/while_gradients.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624396127",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:17:25,third_party/xla/xla/tools/multihost_hlo_runner/functional_hlo_runner.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624395838",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 05:15:28,tensorflow/cc/experimental/libtf/value.h,tensorflower-gardener,False
"Add DISABLED_ON_TPU for ConstantsHloTest.BitcastOfConstant

PiperOrigin-RevId: 624368299",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 02:47:07,"third_party/xla/xla/tests/constants_test.cc, third_party/xla/xla/tests/test_macros.h",tensorflower-gardener,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/02562bf7258184ba71fcec4078b0ce00f3328f3d.

PiperOrigin-RevId: 624351854",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 01:29:39,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Integrate LLVM at llvm/llvm-project@20ed5b1f4587

Updates LLVM usage to match
[20ed5b1f4587](https://github.com/llvm/llvm-project/commit/20ed5b1f4587)

PiperOrigin-RevId: 624343831",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 00:54:58,"third_party/llvm/generated.patch, third_party/llvm/workspace.bzl",tensorflower-gardener,False
"[XLA:MSA] Move SlicedPrefetchStartTimePicker to slice.h/cc files.

PiperOrigin-RevId: 624341804",Subhankar Shah,subhankarshah@google.com,2024-04-13 00:46:10,"third_party/xla/xla/service/memory_space_assignment/BUILD, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.cc, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.h, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment_test.cc, third_party/xla/xla/service/memory_space_assignment/slice.cc, third_party/xla/xla/service/memory_space_assignment/slice.h, third_party/xla/xla/service/memory_space_assignment/slice_test.cc",subhankarshah,False
"    Set metadata and frontend attributes for instructions added in constant-folding HLO pass.

PiperOrigin-RevId: 624336061",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-13 00:19:57,"third_party/xla/xla/service/BUILD, third_party/xla/xla/service/hlo_constant_folding.cc, third_party/xla/xla/service/hlo_constant_folding_test.cc",tensorflower-gardener,False
Merge branch 'master' into multistream-streammerge,Robin Zhang,robinz@nvidia.com,2024-04-12 23:37:44,".bazelrc, .github/workflows/update-rbe.yml, RELEASE.md, WORKSPACE, ci/official/requirements_updater/WORKSPACE, ci/official/wheel_test/WORKSPACE, tensorflow/BUILD, tensorflow/c/eager/BUILD, tensorflow/c/eager/c_api_experimental.cc, tensorflow/c/experimental/gradients/nn_grad.cc, tensorflow/c/experimental/next_pluggable_device/BUILD, tensorflow/c/experimental/next_pluggable_device/c_api.cc, tensorflow/c/experimental/ops/gen/cpp/renderers/BUILD, tensorflow/c/experimental/stream_executor/BUILD, tensorflow/c/experimental/stream_executor/stream_executor.cc, tensorflow/c/experimental/stream_executor/stream_executor_test.cc, tensorflow/c/kernels_experimental.cc, tensorflow/c/while_loop_test.cc, tensorflow/compiler/aot/BUILD, tensorflow/compiler/aot/compile.cc, tensorflow/compiler/aot/embedded_protocol_buffers.h, tensorflow/compiler/jit/kernels/xla_ops.cc, tensorflow/compiler/jit/ops/BUILD, tensorflow/compiler/jit/ops/xla_ops.cc, tensorflow/compiler/jit/pjrt_device_context.cc, tensorflow/compiler/jit/xla_device_context.cc, tensorflow/compiler/mlir/lite/flatbuffer_export.cc, tensorflow/compiler/mlir/lite/flatbuffer_import.cc, tensorflow/compiler/mlir/lite/flatbuffer_operator.cc, tensorflow/compiler/mlir/lite/quantization/BUILD, tensorflow/compiler/mlir/lite/quantization/numerical_utils_test.cc, tensorflow/compiler/mlir/lite/quantization/quantization_context.cc, tensorflow/compiler/mlir/lite/quantization/quantization_context.h, tensorflow/compiler/mlir/lite/quantization/stablehlo/BUILD, tensorflow/compiler/mlir/lite/quantization/stablehlo/quantization.cc, tensorflow/compiler/mlir/lite/stablehlo/BUILD, tensorflow/compiler/mlir/lite/stablehlo/odml_converter/BUILD, tensorflow/compiler/mlir/lite/stablehlo/odml_converter/odml_converter_main.cc, tensorflow/compiler/mlir/lite/stablehlo/odml_converter/passes.h, tensorflow/compiler/mlir/lite/stablehlo/odml_converter/passes.td, tensorflow/compiler/mlir/lite/stablehlo/odml_converter/tests/BUILD, tensorflow/compiler/mlir/lite/stablehlo/tests/composite-lowering.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/fold_broadcast.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/fuse_mhlo_convolution.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/legalize-skip-partitioned-calls.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/legalize-skip-stateful-partition-calls.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/legalize-stablehlo-tfl-composite.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/legalize_hlo.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/optimize.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/tfl_legalize_hlo.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/unfold_splat_constant_pass.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/unfuse_mhlo_batch_norm.mlir, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool.h, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool_patterns.td, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_lowering_pass.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_lowering_patterns.td, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.h, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.td, tensorflow/compiler/mlir/lite/stablehlo/transforms/legalize_stablehlo_composite_to_tfl_custom.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/tf_stablehlo_pass.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/tf_stablehlo_pass.h, tensorflow/compiler/mlir/lite/stablehlo/transforms/uniform_quantized_stablehlo_to_tfl_pass.cc, tensorflow/compiler/mlir/lite/transforms/legalize_tf.cc, tensorflow/compiler/mlir/lite/utils/convert_type.cc, tensorflow/compiler/mlir/quantization/common/BUILD, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.cc, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.h, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints_test.cc, tensorflow/compiler/mlir/quantization/common/lift_as_function_call.h, tensorflow/compiler/mlir/quantization/common/lift_as_function_call_test.cc, tensorflow/compiler/mlir/quantization/common/test_base.h, tensorflow/compiler/mlir/quantization/stablehlo/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/cc/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/calibration_parameters.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/calibration_parameters_test.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/component.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/statistics.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/config.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/config.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/config_test.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/pass_pipeline.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/report.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/report.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/report_test.cc, tensorflow/compiler/mlir/quantization/stablehlo/ops/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/ops/stablehlo_op_quant_spec_test.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/lift_quantizable_spots_as_functions_fusion.td, tensorflow/compiler/mlir/quantization/stablehlo/passes/merge_fusion_with_dequantize.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/passes.td, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantization_patterns.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/quantize_composite_functions.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/replace_stablehlo_ops_in_main_function_with_xla_call_module_ops.cc, tensorflow/compiler/mlir/quantization/stablehlo/passes/xla_call_module_to_call.cc, tensorflow/compiler/mlir/quantization/stablehlo/python/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/quantize_model_test.py, tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/quantize_model_test_base.py, tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/stablehlo_quantizer_odml_oss.ipynb, tensorflow/compiler/mlir/quantization/stablehlo/python/quantization.py, tensorflow/compiler/mlir/quantization/stablehlo/quantization_config.proto, tensorflow/compiler/mlir/quantization/stablehlo/tests/bridge/convert_tf_quant_ops_to_mhlo.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/components/post_calibration_component.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/components/pre_calibration_component.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/components/tf_to_stablehlo.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/merge-fusion-with-dequantize.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/quantize_composite_functions.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/replace_stablehlo_ops_in_main_function_with_xla_call_module_ops.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/unfuse_mhlo_batch_norm.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/xla_call_module_to_call.mlir, tensorflow/compiler/mlir/quantization/tensorflow/BUILD, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/BUILD, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics.proto, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_average_min_max.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_average_min_max.h, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_base.h, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_histogram.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_histogram.h, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_min_max.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_min_max.h, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_collector_test.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibrator_singleton.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibrator_singleton.h, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibrator_singleton_test.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/custom_aggregator_op.cc, tensorflow/compiler/mlir/quantization/tensorflow/calibrator/integration_test/custom_aggregator_op_test.py, tensorflow/compiler/mlir/quantization/tensorflow/cc/BUILD, tensorflow/compiler/mlir/quantization/tensorflow/cc/constant_fold_test.cc, tensorflow/compiler/mlir/quantization/tensorflow/passes/convert_custom_aggregation_op_to_quant_stats.cc, tensorflow/compiler/mlir/quantization/tensorflow/passes/insert_custom_aggregation_ops.cc, tensorflow/compiler/mlir/quantization/tensorflow/passes/tf_quant_ops.td, tensorflow/compiler/mlir/quantization/tensorflow/python/BUILD, tensorflow/compiler/mlir/quantization/tensorflow/python/integration_test/quantize_model_test.py, tensorflow/compiler/mlir/quantization/tensorflow/python/py_function_lib.h, tensorflow/compiler/mlir/quantization/tensorflow/python/py_function_lib.py, tensorflow/compiler/mlir/quantization/tensorflow/python/pywrap_function_lib.cc, tensorflow/compiler/mlir/quantization/tensorflow/python/pywrap_function_lib.pyi, tensorflow/compiler/mlir/quantization/tensorflow/python/pywrap_quantize_model.cc, tensorflow/compiler/mlir/quantization/tensorflow/python/quantize_model.cc, tensorflow/compiler/mlir/quantization/tensorflow/tests/convert_custom_aggregation_op_to_quant_stats.mlir, tensorflow/compiler/mlir/quantization/tensorflow/tests/insert_custom_aggregation_ops.mlir, tensorflow/compiler/mlir/quantization/tensorflow/tests/issue_ids_of_custom_aggregation_ops.mlir, tensorflow/compiler/mlir/stablehlo/BUILD, tensorflow/compiler/mlir/tensorflow/ir/tf_generated_ops.td, tensorflow/compiler/mlir/tensorflow/tests/order_by_dialect.mlir, tensorflow/compiler/mlir/tensorflow/tests/xla_outline_entry_functions.mlir, tensorflow/compiler/mlir/tensorflow/transforms/sparsecore/embedding_pipelining.cc, tensorflow/compiler/mlir/tensorflow/transforms/sparsecore/embedding_sequencing.cc, tensorflow/compiler/mlir/tensorflow/translate/import_model.cc, tensorflow/compiler/mlir/tensorflow/translate/import_model.h, tensorflow/compiler/mlir/tf2xla/api/v2/legalize_tf.cc, tensorflow/compiler/mlir/tf2xla/internal/clustering_bridge_passes.cc, tensorflow/compiler/mlir/tf2xla/internal/clustering_bridge_passes_test.cc, tensorflow/compiler/mlir/tf2xla/internal/mlir_bridge_pass_util.cc, tensorflow/compiler/mlir/tf2xla/internal/mlir_bridge_pass_util_test.cc, tensorflow/compiler/mlir/tf2xla/internal/passes/BUILD, tensorflow/compiler/mlir/tf2xla/internal/passes/clustering_passes.h, tensorflow/compiler/mlir/tf2xla/internal/passes/clustering_passes.td, tensorflow/compiler/mlir/tf2xla/internal/passes/xla_outline_entry_functions.cc, tensorflow/compiler/mlir/tf2xla/tests/adjust-layout.mlir, tensorflow/compiler/mlir/tf2xla/tests/legalize-tf-BatchMatMulV2.mlir, tensorflow/compiler/mlir/tf2xla/tests/legalize-tf-binary-elementwise.mlir, tensorflow/compiler/mlir/tf2xla/tests/legalize-tf-collective.mlir, tensorflow/compiler/mlir/tf2xla/tests/legalize-tf-prefer-tf2xla.mlir, tensorflow/compiler/mlir/tf2xla/tests/legalize-tf-quant.mlir, tensorflow/compiler/mlir/tf2xla/tests/legalize-tf-with-tf2xla-hlo-importer.mlir, tensorflow/compiler/mlir/tf2xla/tests/legalize-tf.mlir, tensorflow/compiler/mlir/tf2xla/tests/verify-tfxla-legalization.mlir, tensorflow/compiler/mlir/tfrt/BUILD, tensorflow/compiler/mlir/tfrt/backend_compiler.h, tensorflow/compiler/mlir/tfrt/transforms/ifrt/BUILD, tensorflow/compiler/mlir/tfrt/transforms/ifrt/extract_callback.cc, tensorflow/compiler/mlir/tfrt/transforms/ifrt/extract_callback.h, tensorflow/compiler/mlir/tfrt/transforms/ifrt/ifrt_backend_compiler.cc, tensorflow/compiler/mlir/tfrt/transforms/ifrt/ifrt_backend_compiler.h, tensorflow/compiler/mlir/tfrt/utils/export.cc, tensorflow/compiler/mlir/tfrt/utils/export.h, tensorflow/compiler/mlir/tools/kernel_gen/transforms/BUILD, tensorflow/compiler/mlir/tools/kernel_gen/transforms/gpu_kernel_to_blob_pass.cc, tensorflow/compiler/tf2xla/light_outside_compilation_kernels_for_test.cc, tensorflow/compiler/tf2xla/literal_util.cc, tensorflow/compiler/tf2xla/mlir_bridge_pass.cc, tensorflow/core/BUILD, tensorflow/core/api_def/base_api/api_def_IndexFlatMapDataset.pbtxt, tensorflow/core/api_def/base_api/api_def_WeightedFlatMapDataset.pbtxt, tensorflow/core/common_runtime/BUILD, tensorflow/core/common_runtime/colocate_predecessor_trees_pass.cc, tensorflow/core/common_runtime/colocate_predecessor_trees_pass_test.cc, tensorflow/core/common_runtime/eager/BUILD, tensorflow/core/common_runtime/eager/context_distributed_manager.cc, tensorflow/core/common_runtime/eager/context_distributed_manager.h, tensorflow/core/common_runtime/eager/copy_to_device_node.h, tensorflow/core/common_runtime/eager/custom_device_op_handler.cc, tensorflow/core/common_runtime/eager/custom_device_test.cc, tensorflow/core/common_runtime/eager/execute.cc, tensorflow/core/common_runtime/eager/kernel_and_device.cc, tensorflow/core/common_runtime/eager/tensor_handle.cc, tensorflow/core/common_runtime/eager/tensor_handle_data.cc, tensorflow/core/common_runtime/function_test.cc, tensorflow/core/common_runtime/function_testlib.cc, tensorflow/core/common_runtime/function_testlib.h, tensorflow/core/common_runtime/gpu/gpu_util.cc, tensorflow/core/common_runtime/gradients.cc, tensorflow/core/common_runtime/gradients.h, tensorflow/core/common_runtime/graph_constructor.cc, tensorflow/core/common_runtime/graph_constructor.h, tensorflow/core/common_runtime/graph_view.h, tensorflow/core/common_runtime/hierarchical_tree_broadcaster.cc, tensorflow/core/common_runtime/mkl_layout_pass.cc, tensorflow/core/common_runtime/next_pluggable_device/BUILD, tensorflow/core/common_runtime/next_pluggable_device/c_plugin_coordination_service_agent_test.cc, tensorflow/core/common_runtime/next_pluggable_device/direct_plugin_coordination_service_agent.h, tensorflow/core/common_runtime/next_pluggable_device/next_pluggable_device_context.cc, tensorflow/core/common_runtime/propagator_state.cc, tensorflow/core/common_runtime/rendezvous_mgr.cc, tensorflow/core/common_runtime/request_cost.cc, tensorflow/core/common_runtime/request_cost.h, tensorflow/core/common_runtime/request_cost_test.cc, tensorflow/core/common_runtime/ring_gatherer.cc, tensorflow/core/common_runtime/ring_reducer.cc, tensorflow/core/common_runtime/simple_propagator_state.cc, tensorflow/core/config/flag_defs.h, tensorflow/core/config/flags_api_wrapper.cc, tensorflow/core/data/BUILD, tensorflow/core/data/captured_function.cc, tensorflow/core/data/dataset_utils.cc, tensorflow/core/data/global_shuffle_utils.cc, tensorflow/core/data/service/client/data_service_client.cc, tensorflow/core/data/service/snapshot/BUILD, tensorflow/core/data/service/snapshot/snapshot_manager.cc, tensorflow/core/distributed_runtime/BUILD, tensorflow/core/distributed_runtime/base_rendezvous_mgr.cc, tensorflow/core/distributed_runtime/call_options.h, tensorflow/core/distributed_runtime/collective_rma_distributed.cc, tensorflow/core/distributed_runtime/coordination/BUILD, tensorflow/core/distributed_runtime/coordination/coordination_client.h, tensorflow/core/distributed_runtime/coordination/coordination_service_barrier_proxy.cc, tensorflow/core/distributed_runtime/coordination/coordination_service_barrier_proxy.h, tensorflow/core/distributed_runtime/coordination/coordination_service_barrier_proxy_test.cc, tensorflow/core/distributed_runtime/coordination/coordination_service_error_util.h, tensorflow/core/distributed_runtime/coordination/coordination_service_rpc_handler.h, tensorflow/core/distributed_runtime/eager/BUILD, tensorflow/core/distributed_runtime/eager/eager_service_impl.cc, tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc, tensorflow/core/distributed_runtime/graph_mgr.cc, tensorflow/core/distributed_runtime/graph_mgr.h, tensorflow/core/distributed_runtime/integration_test/BUILD, tensorflow/core/distributed_runtime/integration_test/coordination_test_opkernel_registration.cc, tensorflow/core/distributed_runtime/preemption/BUILD, tensorflow/core/distributed_runtime/preemption/check_preemption_op_kernel.cc, tensorflow/core/distributed_runtime/preemption/preemption_sync_manager.h, tensorflow/core/distributed_runtime/rpc/BUILD, tensorflow/core/distributed_runtime/rpc/coordination/BUILD, tensorflow/core/distributed_runtime/rpc/coordination/grpc_coordination_client.h, tensorflow/core/distributed_runtime/rpc/coordination/grpc_coordination_service_impl.h, tensorflow/core/distributed_runtime/rpc/eager/BUILD, tensorflow/core/distributed_runtime/rpc/eager/grpc_eager_client.cc, tensorflow/core/distributed_runtime/rpc/eager/grpc_eager_service_impl.cc, tensorflow/core/distributed_runtime/rpc/eager/grpc_eager_service_impl.h, tensorflow/core/distributed_runtime/rpc/grpc_channel.h, tensorflow/core/distributed_runtime/rpc/grpc_client_cq_tag.h, tensorflow/core/distributed_runtime/rpc/grpc_master_service.cc, tensorflow/core/distributed_runtime/rpc/grpc_remote_master.cc, tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc, tensorflow/core/distributed_runtime/rpc/grpc_server_lib.h, tensorflow/core/distributed_runtime/rpc/grpc_state.h, tensorflow/core/distributed_runtime/rpc/grpc_util.h, tensorflow/core/distributed_runtime/rpc/grpc_worker_service.cc, tensorflow/core/distributed_runtime/rpc/grpc_worker_service.h, tensorflow/core/distributed_runtime/session_mgr.cc, tensorflow/core/distributed_runtime/session_mgr.h, tensorflow/core/framework/dataset.h, tensorflow/core/framework/local_rendezvous.cc, tensorflow/core/framework/model.cc, tensorflow/core/framework/model_test.cc, tensorflow/core/framework/registration/BUILD, tensorflow/core/framework/registration/registration_test.cc, tensorflow/core/function/runtime_client/BUILD, tensorflow/core/kernels/BUILD, tensorflow/core/kernels/batch_kernels.cc, tensorflow/core/kernels/batch_kernels_test.cc, tensorflow/core/kernels/batching_util/BUILD, tensorflow/core/kernels/batching_util/batch_resource_base.cc, tensorflow/core/kernels/batching_util/batch_resource_base.h, tensorflow/core/kernels/batching_util/batch_scheduler.cc, tensorflow/core/kernels/batching_util/batch_scheduler.h, tensorflow/core/kernels/batching_util/batch_scheduler_test.cc, tensorflow/core/kernels/batching_util/batch_scheduler_utils.cc, tensorflow/core/kernels/batching_util/batch_scheduler_utils.h, tensorflow/core/kernels/batching_util/batch_scheduler_utils_test.cc, tensorflow/core/kernels/batching_util/shared_batch_scheduler.h, tensorflow/core/kernels/batching_util/shared_batch_scheduler_test.cc, tensorflow/core/kernels/collective_ops.cc, tensorflow/core/kernels/constant_op.cc, tensorflow/core/kernels/data/BUILD, tensorflow/core/kernels/data/batch_dataset_op.cc, tensorflow/core/kernels/data/experimental/BUILD, tensorflow/core/kernels/data/experimental/global_shuffle_dataset_op.cc, tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc",buptzyb,True
add some comments,Robin Zhang,robinz@nvidia.com,2024-04-12 23:37:32,tensorflow/core/common_runtime/gpu/gpu_util.cc,buptzyb,True
"Add support for stablehlo.composite with pytorch F.interpolate-`bilinear` lowered directly to TFL_ResizeBilinearOp

PiperOrigin-RevId: 624309305",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 22:29:00,"tensorflow/compiler/mlir/lite/stablehlo/BUILD, tensorflow/compiler/mlir/lite/stablehlo/tests/composite-lowering.mlir, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool.h, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool_patterns.td, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_lowering_pass.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_lowering_patterns.td, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.h, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.td",tensorflower-gardener,False
"#tf-data Support save/load for index flat map dataset.

PiperOrigin-RevId: 624305449",Yang Chen,yangchen@google.com,2024-04-12 22:14:00,"tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc, tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py",yangustc07,False
fix escape scape error,Raunak,mayank.kumar.raunak@intel.com,2024-04-12 22:28:27,configure.py,mraunak,False
"Stop accepting single-core TPU graphs in MlirBridgePass

This removes the test for JIT compilation of single-core TPU graphs and stop accepting such graphs in MlirBridgePass

PiperOrigin-RevId: 624294447",Jian Cai,jiancai@google.com,2024-04-12 21:32:31,"tensorflow/compiler/mlir/tf2xla/internal/mlir_bridge_pass_util.cc, tensorflow/compiler/mlir/tf2xla/internal/mlir_bridge_pass_util_test.cc, tensorflow/python/distribute/tpu_strategy_test.py",jcai19,False
"Update TFRT dependency to use revision
http://github.com/tensorflow/runtime/commit/72b95c9bdabb68dfb64a57da50d87854f0104b96.

PiperOrigin-RevId: 624294390",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 21:32:19,"third_party/tf_runtime/workspace.bzl, third_party/xla/third_party/tsl/third_party/tf_runtime/workspace.bzl",tensorflower-gardener,False
"Add reduce scatter to the list of collectives ops

PiperOrigin-RevId: 624293743",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 21:29:50,third_party/xla/xla/service/collective_ops_utils.cc,tensorflower-gardener,False
"Fixes for libtensorflow nightly build breakage

PiperOrigin-RevId: 624289835",David Dunleavy,ddunleavy@google.com,2024-04-12 21:15:43,"tensorflow/tools/lib_package/BUILD, tensorflow/tools/lib_package/libtensorflow_test.sh",ddunl,False
"Replace `__attribute__((unused))` with `[[maybe_unused]]` to fix [msvc error](https://github.com/google/jax/actions/runs/8630859524/job/23658055502).

PiperOrigin-RevId: 624288300",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 21:10:30,third_party/xla/xla/python/ifrt/plugin_program_serdes.cc,tensorflower-gardener,False
"Change defines to local_defines so that the MACRO will not be applied to the dependencies.

PiperOrigin-RevId: 624284897",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 20:59:12,tensorflow/lite/delegates/gpu/cl/BUILD,tensorflower-gardener,False
"[IFRT] Change {From,To}ShardingProto to Sharding::{From,To}Proto.

`FromShardingProto` and `ToShardingProto` were top-level functions for
`Sharding` (de)serialization. To make the API user-facing (de)serialization
consistent across IFRT types, this change move them into `Sharding`'s
`FromProto` and `ToProto` methods.

This also makes `sharding_serdes.cc` to be linked only for `SerDes`
implementations of basic `Sharding`, similar to other `*_serdes.cc` are used.

The users of `Sharding` (de)serialization only need to include `sharding.h`,
not `sharding_serdes.h`.

PiperOrigin-RevId: 624281720",Hyeontaek Lim,hyeontaek@google.com,2024-04-12 20:47:56,"third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/sharding.cc, third_party/xla/xla/python/ifrt/sharding.h, third_party/xla/xla/python/ifrt/sharding_serdes.cc, third_party/xla/xla/python/ifrt/sharding_serdes.h, third_party/xla/xla/python/ifrt/sharding_serdes_test.cc, third_party/xla/xla/python/ifrt_proxy/client/array.cc, third_party/xla/xla/python/ifrt_proxy/client/executable.cc, third_party/xla/xla/python/ifrt_proxy/client/executable_test.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend_test.cc, third_party/xla/xla/python/pjrt_ifrt/xla_sharding_serdes.cc, third_party/xla/xla/python/pjrt_ifrt/xla_sharding_serdes_test.cc",hyeontaek,False
"Update TF dependencies.

PiperOrigin-RevId: 624269593",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 20:04:54,"tensorflow/compiler/mlir/quantization/stablehlo/BUILD, tensorflow/lite/BUILD, tensorflow/lite/kernels/BUILD",tensorflower-gardener,False
"Added Compress and Decompress Megascale graph actions.

PiperOrigin-RevId: 624262425",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 19:38:49,"third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.h",tensorflower-gardener,False
"Rollback of Use PTX version corresponding to CUDA version

Reverts 4ab3351d29d051a28f0b0ea0756c99492360008e

PiperOrigin-RevId: 624261479",Henning Becker,hebecker@google.com,2024-04-12 19:35:14,"third_party/xla/xla/service/gpu/llvm_gpu_backend/BUILD, third_party/xla/xla/service/gpu/llvm_gpu_backend/gpu_backend_lib.cc",beckerhe,False
"    Set metadata and frontend attributes for instructions added in tpu copy normalizer HLO pass.

PiperOrigin-RevId: 624241243",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 18:27:43,"third_party/xla/xla/service/hlo_creation_utils.cc, third_party/xla/xla/service/hlo_creation_utils.h",tensorflower-gardener,False
"[pjrt] Switch GetReadyFuture to PjRtFuture<> to signal completion event

PiperOrigin-RevId: 624224670",Eugene Zhulenev,ezhulenev@google.com,2024-04-12 17:37:43,"third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.h, third_party/xla/xla/pjrt/pjrt_c_api_client.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.h, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.h, third_party/xla/xla/pjrt/tf_pjrt_client.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.cc",ezhulenev,False
"Previous fix only works when there is a transpose copy. The mechanism should
work regardless of the existence of such copies. Also add some filtering for a special case where at loop entry a tensor is on the host, for which case the root instruction of the loop body should not use the moved-to-device version.

PiperOrigin-RevId: 624224345",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 17:36:50,"third_party/xla/xla/service/host_offload_legalize.cc, third_party/xla/xla/service/host_offloader.cc, third_party/xla/xla/service/host_offloader_test.cc",tensorflower-gardener,False
"Fix a typo

PiperOrigin-RevId: 624209239",Jian Cai,jiancai@google.com,2024-04-12 16:49:08,tensorflow/compiler/tf2xla/mlir_bridge_pass.cc,jcai19,False
"[XLA:AlgebraicSimplifier] Bugfix on gather simplification.

PiperOrigin-RevId: 624207589",Tongfei Guo,tongfei@google.com,2024-04-12 16:43:05,"third_party/xla/xla/service/algebraic_simplifier.cc, third_party/xla/xla/service/algebraic_simplifier_test.cc",Tongfei-Guo,False
"Reverts 942c887143df82fefbacfb73ff338f4957f9886c

PiperOrigin-RevId: 624205074",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 16:34:33,"tensorflow/compiler/mlir/tf2xla/api/v2/legalize_tf.cc, tensorflow/compiler/mlir/tf2xla/api/v2/legalize_tf_test.cc",tensorflower-gardener,False
"[IFRT] Add type checking for `Deserialize`

`Deserialize` now takes an expected type for a deserialized object. It also
checks if a supplied `DeserializeOptions` is expected for the type of the
deserialized object; `Serializable` class can define a `DeserializeOptions`
type within the class to express the expected `DeserializeOptions` type.

PiperOrigin-RevId: 624204016",Hyeontaek Lim,hyeontaek@google.com,2024-04-12 16:30:46,"third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/executable.h, third_party/xla/xla/python/ifrt/plugin_program_serdes_test.cc, third_party/xla/xla/python/ifrt/program_serdes.cc, third_party/xla/xla/python/ifrt/program_serdes.h, third_party/xla/xla/python/ifrt/serdes.cc, third_party/xla/xla/python/ifrt/serdes.h, third_party/xla/xla/python/ifrt/serdes_test.cc, third_party/xla/xla/python/ifrt/sharding.h, third_party/xla/xla/python/ifrt/sharding_serdes.cc, third_party/xla/xla/python/ifrt/sharding_serdes.h, third_party/xla/xla/python/ifrt/sharding_serdes_test.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc, third_party/xla/xla/python/pjrt_ifrt/BUILD, third_party/xla/xla/python/pjrt_ifrt/xla_program_serdes_test.cc, third_party/xla/xla/python/pjrt_ifrt/xla_sharding_serdes.cc, third_party/xla/xla/python/pjrt_ifrt/xla_sharding_serdes_test.cc",hyeontaek,False
[oneDNN] Remove MKL blocked format test code,guozhong.zhuang,guozhong.zhuang@intel.com,2024-04-12 16:11:42,"tensorflow/core/grappler/costs/graph_properties_test.cc, tensorflow/core/util/mkl_util_test.cc",gzmkl,True
"[XLA:GPU] Remove the unused `stream` argument of `AutotunerUtil::CreateRedzoneAllocator`.

PiperOrigin-RevId: 624175221",Dimitar (Mitko) Asenov,dasenov@google.com,2024-04-12 14:42:27,"third_party/xla/xla/service/gpu/autotuner_util.cc, third_party/xla/xla/service/gpu/autotuner_util.h",dimitar-asenov,False
"Add virtual method `IsInlineableCallOp` to `CallInliner` to allow subclasses to change which call instructions to inline. And clean up `#include`s in `call_inliner.cc`.

PiperOrigin-RevId: 624170852",Bart Chrzaszcz,bartchr@google.com,2024-04-12 14:24:10,"third_party/xla/xla/service/BUILD, third_party/xla/xla/service/call_inliner.cc, third_party/xla/xla/service/call_inliner.h",bartchr808,False
"[XLA:GPU] Stop passing `stream` to methods of `GpuConvAlgorithmPicker`.

The `stream` always comes from the `config_` field. Passing it around, as opposed to directly reading it from the field is confusing as it gives the wrong impression that it may be different than what is stored in the `config_`.

PiperOrigin-RevId: 624167738",Dimitar (Mitko) Asenov,dasenov@google.com,2024-04-12 14:11:13,"third_party/xla/xla/service/gpu/conv_algorithm_picker.cc, third_party/xla/xla/service/gpu/conv_algorithm_picker.h",dimitar-asenov,False
"Fix sparse matmul implementation on Hopper

PiperOrigin-RevId: 624162036",Sergey Kozub,sergeykozub@google.com,2024-04-12 13:47:00,"third_party/triton/xla_extensions/sparse_dot_base.patch, third_party/xla/third_party/triton/xla_extensions/sparse_dot_base.patch",sergeykozub,False
"[XLA:GPU] Remove unused function.

PiperOrigin-RevId: 624149601",Dimitar (Mitko) Asenov,dasenov@google.com,2024-04-12 12:51:59,"third_party/xla/xla/service/gpu/conv_algorithm_picker.cc, third_party/xla/xla/service/gpu/conv_algorithm_picker.h",dimitar-asenov,False
"Automated Code Change

PiperOrigin-RevId: 624143562",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 12:23:23,"third_party/xla/xla/service/gpu/fusions/BUILD, third_party/xla/xla/service/gpu/fusions/address_computation_fusion_test.cc, third_party/xla/xla/service/gpu/fusions/concatenate.h, third_party/xla/xla/service/gpu/fusions/concatenate_mlir.cc, third_party/xla/xla/service/gpu/fusions/concatenate_mlir.h, third_party/xla/xla/service/gpu/fusions/concatenate_mlir_test.cc, third_party/xla/xla/service/gpu/fusions/copy.cc, third_party/xla/xla/service/gpu/fusions/copy.h, third_party/xla/xla/service/gpu/fusions/cudnn.cc, third_party/xla/xla/service/gpu/fusions/cudnn.h, third_party/xla/xla/service/gpu/fusions/cudnn_test.cc, third_party/xla/xla/service/gpu/fusions/custom.cc, third_party/xla/xla/service/gpu/fusions/custom.h, third_party/xla/xla/service/gpu/fusions/fusion_emitter.cc, third_party/xla/xla/service/gpu/fusions/fusion_emitter.h, third_party/xla/xla/service/gpu/fusions/fusions.cc, third_party/xla/xla/service/gpu/fusions/fusions.h, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice.cc, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice.h, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir.h, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir_test.cc, third_party/xla/xla/service/gpu/fusions/input_slices.cc, third_party/xla/xla/service/gpu/fusions/input_slices.h, third_party/xla/xla/service/gpu/fusions/input_slices_mlir.h, third_party/xla/xla/service/gpu/fusions/loop.cc, third_party/xla/xla/service/gpu/fusions/loop_mlir.cc, third_party/xla/xla/service/gpu/fusions/loop_mlir.h, third_party/xla/xla/service/gpu/fusions/loop_mlir_test.cc, third_party/xla/xla/service/gpu/fusions/loop_test.cc",tensorflower-gardener,False
"Support unsigned scalar constants in new mlir-based emitters.

PiperOrigin-RevId: 624142678",Adrian Kuegel,akuegel@google.com,2024-04-12 12:19:43,"third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir_test.cc",akuegel,False
"PR #11458: [ROCm] Build fixes

Imported from GitHub PR https://github.com/openxla/xla/pull/11458

Contains fix for compile failure after e21311e52a0be80042d4c807847ec17919f2f954
Contains fix for link failure after 596745eca6b9fb1553ee71b63c71e92527f1d7f4
Copybara import of the project:

--
b253cbac2da4515ff4437b820f37a2b097a287c1 by Dragan Mladjenovic <Dragan.Mladjenovic@amd.com>:

[ROCm] Build fixes

Contains fix for compile failure after e21311e52a0be80042d4c807847ec17919f2f954
Contains fix for link failure after 596745eca6b9fb1553ee71b63c71e92527f1d7f4

Merging this change closes #11458

PiperOrigin-RevId: 624120147",Dragan Mladjenovic,Dragan.Mladjenovic@amd.com,2024-04-12 10:46:09,third_party/xla/xla/service/gpu/BUILD,draganmladjenovic,False
"Automated Code Change

PiperOrigin-RevId: 624115176",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 10:24:24,"tensorflow/core/tfrt/mlrt/attribute/BUILD, tensorflow/core/tfrt/mlrt/attribute/attribute.cc, tensorflow/core/tfrt/mlrt/attribute/attribute_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624115009",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 10:23:42,"tensorflow/core/distributed_runtime/eager/eager_service_impl.cc, tensorflow/core/distributed_runtime/eager/remote_tensor_handle_data.cc",tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-12

PiperOrigin-RevId: 624104211",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 09:38:25,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Enable properties for dtensor dialect.

PiperOrigin-RevId: 624097714",Adrian Kuegel,akuegel@google.com,2024-04-12 09:10:37,tensorflow/dtensor/mlir/dtensor_dialect/ir/dtensor_dialect.td,akuegel,False
"Update GraphDef version to 1830.

PiperOrigin-RevId: 624095561",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 09:02:30,tensorflow/core/public/version.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624095085",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 09:00:58,"tensorflow/lite/delegates/BUILD, tensorflow/lite/delegates/interpreter_utils.cc, tensorflow/lite/delegates/interpreter_utils_test.cc",tensorflower-gardener,False
"PR #11053: [XLA:CPU][oneDNN] Variant patterns of GELU tanh approximation

Imported from GitHub PR https://github.com/openxla/xla/pull/11053

This PR supports more patterns from TF->XLA GELU Approximate. It was found that the variations were resulting from associativity of multiply instructions like in the expression a * b * c. An utility function is added in this PR that captures patterns from two consecutive multiplies.
Copybara import of the project:

--
74a287c7784138da3905d618d65a8301c821d7f6 by mdfaijul <md.faijul.amin@intel.com>:

Patterns from tf.nn.gelu(approximate=True)

--
51b4962709de6cee8ec92c9fc225b5fc3371c276 by mdfaijul <md.faijul.amin@intel.com>:

Fix typos

Merging this change closes #11053

PiperOrigin-RevId: 624093341",Faijul Amin,md.faijul.amin@intel.com,2024-04-12 08:53:25,"third_party/xla/xla/service/cpu/onednn_matmul_rewriter.cc, third_party/xla/xla/tests/onednn_matmul_test.cc",mdfaijul,False
"Reland Use PTX version corresponding to CUDA version

Reverts 5b632707d126791a78d151340c98ef09e10dc189

PiperOrigin-RevId: 624092399",Henning Becker,hebecker@google.com,2024-04-12 08:50:07,"third_party/xla/xla/service/gpu/llvm_gpu_backend/BUILD, third_party/xla/xla/service/gpu/llvm_gpu_backend/gpu_backend_lib.cc",beckerhe,False
"Automated Code Change

PiperOrigin-RevId: 624091492",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 08:46:26,tensorflow/compiler/jit/kernels/xla_ops.cc,tensorflower-gardener,False
"Add missing conversion for ArmNNSettings

PiperOrigin-RevId: 624088926",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 08:35:25,"tensorflow/lite/acceleration/configuration/proto_to_flatbuffer.cc, tensorflow/lite/acceleration/configuration/proto_to_flatbuffer_test.cc",tensorflower-gardener,False
"Switch on the `BatchMatMul` delegate.

PiperOrigin-RevId: 624088621",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 08:34:14,tensorflow/lite/delegates/xnnpack/xnnpack_delegate.cc,tensorflower-gardener,False
"Adjust ptxas search path priorities

When looking for ptxas and other NVIDIA binary tools we go through a list of potential locations until we find a suitable version of ptxas.

Changing this list or its order has been deemed difficult in the past because there are many users out there that rely on the fact that this list happens to choose the right binary for them.

So this is making a careful change that is only affecting Google environments and makes no change to any OSS build of TF, JAX or XLA.

PiperOrigin-RevId: 624078399",Henning Becker,hebecker@google.com,2024-04-12 07:52:24,third_party/xla/xla/stream_executor/cuda/cuda_asm_compiler.cc,beckerhe,False
"[pjrt] Switch CopyRawToHost to PjRtFuture<> to signal completion event

PiperOrigin-RevId: 624073633",Eugene Zhulenev,ezhulenev@google.com,2024-04-12 07:30:20,"third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.h, third_party/xla/xla/pjrt/gpu/se_gpu_pjrt_client.cc, third_party/xla/xla/pjrt/gpu/se_gpu_pjrt_client.h, third_party/xla/xla/pjrt/pjrt_c_api_client.h, third_party/xla/xla/pjrt/pjrt_client.cc, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.h, third_party/xla/xla/pjrt/tf_pjrt_client.h",ezhulenev,False
"PR #11444: [XLA:GPU] disable mask in cuDNN attention

Imported from GitHub PR https://github.com/openxla/xla/pull/11444

1. cuDNN attention mask is not doing masking with -inf but multiply which is not correct. Hence disable patterns with mask.
2. Follow up PR to clean up the remaining mask related logic.
Copybara import of the project:

--
acf95b6cc7e1084026eaf87c0119ba3801ba8f8c by cjkkkk <ske@nvidia.com>:

disable mask

Merging this change closes #11444

PiperOrigin-RevId: 624068883",Shanbin Ke,ske@nvidia.com,2024-04-12 07:07:22,"third_party/xla/xla/service/gpu/cudnn_fused_mha_rewriter.cc, third_party/xla/xla/service/gpu/cudnn_fused_mha_rewriter_test.cc, third_party/xla/xla/service/gpu/tests/gpu_fused_mha_test.cc",Cjkkkk,False
"Add missing conversion for CompilationCachingSettings

PiperOrigin-RevId: 624065316",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 06:53:06,"tensorflow/lite/acceleration/configuration/proto_to_flatbuffer.cc, tensorflow/lite/acceleration/configuration/proto_to_flatbuffer_test.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 624045436",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 05:04:08,tensorflow/core/tfrt/saved_model/saved_model_util.cc,tensorflower-gardener,False
"Bump idna from 3.6 to 3.7

Bumps [idna](https://github.com/kjd/idna) from 3.6 to 3.7.
- [Release notes](https://github.com/kjd/idna/releases)
- [Changelog](https://github.com/kjd/idna/blob/master/HISTORY.rst)
- [Commits](https://github.com/kjd/idna/compare/v3.6...v3.7)

---
updated-dependencies:
- dependency-name: idna
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>",dependabot[bot],49699333+dependabot[bot]@users.noreply.github.com,2024-04-12 04:38:53,"requirements_lock_3_10.txt, requirements_lock_3_11.txt, requirements_lock_3_12.txt, requirements_lock_3_9.txt",dependabot[bot],False
"Create an OSS version of StableHLO Quantizer demonstration for ODML.

More changes will follow to demonstrate selective quantization.

PiperOrigin-RevId: 624026901",Jiyoun (Jen) Ha,jiyounha@google.com,2024-04-12 03:17:11,tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/stablehlo_quantizer_odml_oss.ipynb,chococigar,False
"#tf-data `index_mapper` returns a `StatusOr`.

This is required for `index_flat_map` where running the captured
function may return a `Status`.

PiperOrigin-RevId: 624026405",Yang Chen,yangchen@google.com,2024-04-12 03:14:25,"tensorflow/core/data/BUILD, tensorflow/core/data/global_shuffle_utils.cc, tensorflow/core/framework/dataset.h, tensorflow/core/kernels/data/BUILD, tensorflow/core/kernels/data/batch_dataset_op.cc, tensorflow/core/kernels/data/experimental/BUILD, tensorflow/core/kernels/data/experimental/global_shuffle_dataset_op.cc, tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc, tensorflow/core/kernels/data/experimental/weighted_flat_map_dataset_op.cc, tensorflow/core/kernels/data/repeat_dataset_op.cc, tensorflow/core/kernels/data/shard_dataset_op.cc, tensorflow/core/kernels/data/skip_dataset_op.cc, tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py",yangustc07,False
"Adds support for using custom op SDPA via XNNPACK.

PiperOrigin-RevId: 624001836",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-12 01:27:56,"tensorflow/lite/delegates/xnnpack/BUILD, tensorflow/lite/delegates/xnnpack/odml_sdpa_test.cc, tensorflow/lite/delegates/xnnpack/odml_sdpa_tester.cc, tensorflow/lite/delegates/xnnpack/odml_sdpa_tester.h, tensorflow/lite/delegates/xnnpack/xnnpack_delegate.cc",tensorflower-gardener,False
"#tf-data Ramp down `map_fusion` experiment.

PiperOrigin-RevId: 623975807",Wilsin Gosti,wilsin@google.com,2024-04-11 23:37:23,tensorflow/core/data/dataset_utils.cc,wilsingosti,False
"Move tsl/distributed_runtime to xla/tsl/distributed_runtime

PiperOrigin-RevId: 623975602",David Dunleavy,ddunleavy@google.com,2024-04-11 23:36:40,"tensorflow/c/eager/BUILD, tensorflow/c/eager/c_api_experimental.cc, tensorflow/c/experimental/next_pluggable_device/BUILD, tensorflow/c/experimental/next_pluggable_device/c_api.cc, tensorflow/core/common_runtime/eager/BUILD, tensorflow/core/common_runtime/eager/context_distributed_manager.h, tensorflow/core/common_runtime/next_pluggable_device/BUILD, tensorflow/core/common_runtime/next_pluggable_device/c_plugin_coordination_service_agent_test.cc, tensorflow/core/common_runtime/next_pluggable_device/direct_plugin_coordination_service_agent.h, tensorflow/core/distributed_runtime/BUILD, tensorflow/core/distributed_runtime/call_options.h, tensorflow/core/distributed_runtime/coordination/BUILD, tensorflow/core/distributed_runtime/coordination/coordination_client.h, tensorflow/core/distributed_runtime/coordination/coordination_service_barrier_proxy.cc, tensorflow/core/distributed_runtime/coordination/coordination_service_barrier_proxy.h, tensorflow/core/distributed_runtime/coordination/coordination_service_barrier_proxy_test.cc, tensorflow/core/distributed_runtime/coordination/coordination_service_error_util.h, tensorflow/core/distributed_runtime/coordination/coordination_service_rpc_handler.h, tensorflow/core/distributed_runtime/eager/BUILD, tensorflow/core/distributed_runtime/eager/eager_service_impl.cc, tensorflow/core/distributed_runtime/integration_test/BUILD, tensorflow/core/distributed_runtime/integration_test/coordination_test_opkernel_registration.cc, tensorflow/core/distributed_runtime/preemption/BUILD, tensorflow/core/distributed_runtime/preemption/check_preemption_op_kernel.cc, tensorflow/core/distributed_runtime/preemption/preemption_sync_manager.h, tensorflow/core/distributed_runtime/rpc/BUILD, tensorflow/core/distributed_runtime/rpc/coordination/BUILD, tensorflow/core/distributed_runtime/rpc/coordination/grpc_coordination_client.h, tensorflow/core/distributed_runtime/rpc/coordination/grpc_coordination_service_impl.h, tensorflow/core/distributed_runtime/rpc/eager/BUILD, tensorflow/core/distributed_runtime/rpc/eager/grpc_eager_client.cc, tensorflow/core/distributed_runtime/rpc/eager/grpc_eager_service_impl.cc, tensorflow/core/distributed_runtime/rpc/eager/grpc_eager_service_impl.h, tensorflow/core/distributed_runtime/rpc/grpc_channel.h, tensorflow/core/distributed_runtime/rpc/grpc_client_cq_tag.h, tensorflow/core/distributed_runtime/rpc/grpc_master_service.cc, tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc, tensorflow/core/distributed_runtime/rpc/grpc_server_lib.h, tensorflow/core/distributed_runtime/rpc/grpc_state.h, tensorflow/core/distributed_runtime/rpc/grpc_util.h, tensorflow/core/distributed_runtime/rpc/grpc_worker_service.cc, tensorflow/core/distributed_runtime/rpc/grpc_worker_service.h, tensorflow/core/distributed_runtime/session_mgr.cc, tensorflow/core/distributed_runtime/session_mgr.h, tensorflow/core/function/runtime_client/BUILD, tensorflow/core/tpu/kernels/BUILD, tensorflow/core/tpu/kernels/tpu_compilation_cache_service.h, tensorflow/python/BUILD, tensorflow/python/client/BUILD, tensorflow/python/framework/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/coordination/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/preemption/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/rpc/coordination/BUILD, third_party/xla/third_party/tsl/tsl/lib/gtl/BUILD, third_party/xla/third_party/tsl/tsl/lib/monitoring/BUILD, third_party/xla/xla/pjrt/distributed/BUILD, third_party/xla/xla/pjrt/distributed/client.cc, third_party/xla/xla/pjrt/distributed/service.cc, third_party/xla/xla/pjrt/distributed/service.h, third_party/xla/xla/python/BUILD, third_party/xla/xla/python/xla.cc, third_party/xla/xla/tsl/distributed_runtime/BUILD, third_party/xla/xla/tsl/distributed_runtime/call_options.cc, third_party/xla/xla/tsl/distributed_runtime/call_options.h, third_party/xla/xla/tsl/distributed_runtime/coordination/BUILD, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_client.h, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service.cc, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service.h, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_agent.cc, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_agent.h, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_agent_test.cc, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_error_util.h, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_error_util_test.cc, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_recoverable_job_test.cc, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_rpc_handler.cc, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_rpc_handler.h, third_party/xla/xla/tsl/distributed_runtime/coordination/coordination_service_test.cc, third_party/xla/xla/tsl/distributed_runtime/coordination/test_device.proto, third_party/xla/xla/tsl/distributed_runtime/preemption/BUILD, third_party/xla/xla/tsl/distributed_runtime/preemption/preemption_notifier.cc, third_party/xla/xla/tsl/distributed_runtime/preemption/preemption_notifier.h, third_party/xla/xla/tsl/distributed_runtime/preemption/preemption_notifier_test.cc, third_party/xla/xla/tsl/distributed_runtime/preemption/preemption_sync_manager.cc, third_party/xla/xla/tsl/distributed_runtime/preemption/preemption_sync_manager.h, third_party/xla/xla/tsl/distributed_runtime/preemption/preemption_sync_manager_test.cc, third_party/xla/xla/tsl/distributed_runtime/rpc/BUILD, third_party/xla/xla/tsl/distributed_runtime/rpc/async_service_interface.h, third_party/xla/xla/tsl/distributed_runtime/rpc/coordination/BUILD, third_party/xla/xla/tsl/distributed_runtime/rpc/coordination/grpc_coordination_client.cc, third_party/xla/xla/tsl/distributed_runtime/rpc/coordination/grpc_coordination_client.h, third_party/xla/xla/tsl/distributed_runtime/rpc/coordination/grpc_coordination_service_impl.cc, third_party/xla/xla/tsl/distributed_runtime/rpc/coordination/grpc_coordination_service_impl.h, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_call.h, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_channel.cc, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_channel.h, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_channel_common.h, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_channel_test.cc, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_client_cq_tag.h, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_state.h, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_util.cc, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_util.h, third_party/xla/xla/tsl/distributed_runtime/rpc/grpc_util_test.cc, third_party/xla/xla/tsl/distributed_runtime/rpc/test_request.proto",ddunl,False
"Integrate LLVM at llvm/llvm-project@ffb5bea2be9f

Updates LLVM usage to match
[ffb5bea2be9f](https://github.com/llvm/llvm-project/commit/ffb5bea2be9f)

PiperOrigin-RevId: 623964285",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 22:52:20,"third_party/llvm/generated.patch, third_party/llvm/workspace.bzl",tensorflower-gardener,False
"[xla:gpu] Disable set_xla_gpu_use_memcpy_local_p2p by default

Breaks jax tests

PiperOrigin-RevId: 623961307",Eugene Zhulenev,ezhulenev@google.com,2024-04-11 22:40:45,third_party/xla/xla/debug_options_flags.cc,ezhulenev,False
"#tf-data-service Explicitly checks if snapshot metadata exists.

The `GFile` documentation does not mention what exceptions it raises:
https://github.com/tensorflow/tensorflow/blob/38b17d708344a91234dad879794735e79f9af42a/tensorflow/python/platform/gfile.py#L37.

It would be safer to explicitly check for file existence and return the
appropriate result.

PiperOrigin-RevId: 623961044",Yang Chen,yangchen@google.com,2024-04-11 22:39:55,tensorflow/python/data/ops/load_op.py,yangustc07,False
"Update ops-related pbtxt files.

PiperOrigin-RevId: 623955329",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 22:18:48,"tensorflow/core/ops/compat/ops_history_v2/WeightedFlatMapDataset.pbtxt, tensorflow/core/ops/ops.pbtxt",tensorflower-gardener,False
"Ignore tiling in layout comparison between parameter shape and computation layout shape.

PiperOrigin-RevId: 623947612",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 21:51:54,third_party/xla/xla/service/layout_assignment.cc,tensorflower-gardener,False
"Create IfrtServingCoreSelector wrapper that wraps a tsl::ServiceDeviceSelector.

PiperOrigin-RevId: 623946563",Siqiao Wu,siqiaowu@google.com,2024-04-11 21:47:55,"tensorflow/core/tfrt/ifrt/BUILD, tensorflow/core/tfrt/ifrt/ifrt_serving_core_selector.cc, tensorflow/core/tfrt/ifrt/ifrt_serving_core_selector.h, tensorflow/core/tfrt/ifrt/ifrt_serving_core_selector_test.cc, third_party/xla/third_party/tsl/tsl/framework/test_util/BUILD, third_party/xla/third_party/tsl/tsl/framework/test_util/mock_serving_device_selector.h",SiqiaoWu1993,False
"Adds KVCache op to GenAI custom op resolver.

PiperOrigin-RevId: 623939572",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 21:24:18,"tensorflow/lite/experimental/genai/BUILD, tensorflow/lite/experimental/genai/genai_ops.cc, tensorflow/lite/experimental/genai/genai_ops.h, tensorflow/lite/experimental/genai/kvcache.cc, tensorflow/lite/experimental/genai/kvcache.h, tensorflow/lite/experimental/genai/kvcache_test.cc",tensorflower-gardener,False
"#tf-data-service Write snapshot metadata atomically.

PiperOrigin-RevId: 623935805",Yang Chen,yangchen@google.com,2024-04-11 21:11:43,tensorflow/core/data/service/snapshot/snapshot_manager.cc,yangustc07,False
"Inject TpuCompiler pass to IfrtBackendCompiler

PiperOrigin-RevId: 623935433",Deqiang Chen,deqiangc@google.com,2024-04-11 21:10:13,"tensorflow/compiler/mlir/tfrt/transforms/ifrt/ifrt_backend_compiler.cc, tensorflow/compiler/mlir/tfrt/transforms/ifrt/ifrt_backend_compiler.h",deqiangc,False
"[tsl:concurrency] Test that async payloads with different alignment works

PiperOrigin-RevId: 623935359",Eugene Zhulenev,ezhulenev@google.com,2024-04-11 21:10:01,third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc,ezhulenev,False
"Make AutoShardingSolverRequest visibility public.

PiperOrigin-RevId: 623932847",Matthew Fahrbach,fahrbach@google.com,2024-04-11 21:02:13,third_party/xla/xla/hlo/experimental/auto_sharding/BUILD,,False
"#tf-data Implement `weighted_flat_map` API that can be used to implement random access compatible dataset mixing.

PiperOrigin-RevId: 623929012",Wilsin Gosti,wilsin@google.com,2024-04-11 20:50:23,"tensorflow/core/api_def/base_api/api_def_WeightedFlatMapDataset.pbtxt, tensorflow/core/kernels/data/experimental/BUILD, tensorflow/core/kernels/data/experimental/global_shuffle_dataset_op.cc, tensorflow/core/kernels/data/experimental/weighted_flat_map_dataset_op.cc, tensorflow/core/ops/experimental_dataset_ops.cc, tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/weighted_flat_map_test.py, tensorflow/python/data/experimental/ops/BUILD, tensorflow/python/data/experimental/ops/weighted_flat_map_op.py, tensorflow/tools/api/golden/v1/tensorflow.raw_ops.pbtxt, tensorflow/tools/api/golden/v2/tensorflow.raw_ops.pbtxt",wilsingosti,False
"#tf-data returns bool instead of int64_t for PrefetchAutotuner::HasElementSize

PiperOrigin-RevId: 623918512",Jim Lin,jimlintw@google.com,2024-04-11 20:14:01,tensorflow/core/kernels/data/prefetch_autotuner.h,jimlinntu,False
"Merge pull request #65476 from Intel-tensorflow:remove_deprecated_ops

PiperOrigin-RevId: 623916433",TensorFlower Gardener,gardener@tensorflow.org,2024-04-11 20:41:44,"tensorflow/core/BUILD, tensorflow/core/common_runtime/mkl_layout_pass.cc, tensorflow/core/kernels/mkl/BUILD, tensorflow/core/kernels/mkl/mkl_deprecated_ops.cc, tensorflow/core/ops/array_ops.cc, tensorflow/core/ops/math_ops.cc, tensorflow/core/ops/nn_ops.cc",tensorflower-gardener,False
"KV Cache: optimize data motion.

PiperOrigin-RevId: 623916004",T.J. Alumbaugh,talumbau@google.com,2024-04-11 20:05:52,"tensorflow/lite/experimental/genai/kvcache.cc, tensorflow/lite/experimental/genai/kvcache_test.cc",talumbau,False
"[XLA:LatencyHidingScheduler] Don't allocate buffer if it is first defined by an entry computation parameter.

PiperOrigin-RevId: 623913976",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 19:58:45,"third_party/xla/xla/service/latency_hiding_scheduler.cc, third_party/xla/xla/service/latency_hiding_scheduler.h, third_party/xla/xla/service/latency_hiding_scheduler_test.cc",tensorflower-gardener,False
"[tsl] Rewrite `TF_ASSERT_OK` and `TF_EXPECT_OK` in terms of `IsOk()` matcher

* This will allow using these macros on `absl::StatusOr` objects
  * Since `absl::StatusOr` lacks an `operator==` with `absl::Status`, it couldn't be used here before
  * Now it uses `tsl::testing::IsOk()` which works for both `absl::Status` and `absl::StatusOr`
* This should also likely result in nicer error messages in case of failure

PiperOrigin-RevId: 623911099",Lawrence Wolf-Sonkin,lawrencews@google.com,2024-04-11 19:48:28,"third_party/xla/third_party/tsl/tsl/lib/core/BUILD, third_party/xla/third_party/tsl/tsl/lib/core/status_test_util.h",lwolfsonkin,False
"[pjrt] Switch ToLiteral to PjRtFuture<> to signal completion event

PiperOrigin-RevId: 623908927",Eugene Zhulenev,ezhulenev@google.com,2024-04-11 19:40:20,"tensorflow/compiler/jit/pjrt_device_context.cc, tensorflow/core/common_runtime/gpu/gpu_util.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.cc, third_party/xla/xla/pjrt/cpu/abstract_tfrt_cpu_buffer.h, third_party/xla/xla/pjrt/cpu/cpu_client.cc, third_party/xla/xla/pjrt/cpu/cpu_client.h, third_party/xla/xla/pjrt/pjrt_c_api_client.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.h, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.h, third_party/xla/xla/pjrt/tf_pjrt_client.h",ezhulenev,False
"Automatic rollback of Use PTX version corresponding to CUDA version

Reverts 99f256965598b505ea0f47d2ae290243b4ac4b81

PiperOrigin-RevId: 623905632",Henning Becker,hebecker@google.com,2024-04-11 19:29:17,"third_party/xla/xla/service/gpu/llvm_gpu_backend/BUILD, third_party/xla/xla/service/gpu/llvm_gpu_backend/gpu_backend_lib.cc",beckerhe,False
"[xla] Add minimal alignment requirement for Literals stored inline

Make sure that literals stored on heap and on stack have the same memory alignment.

PiperOrigin-RevId: 623890685",Eugene Zhulenev,ezhulenev@google.com,2024-04-11 18:38:22,"third_party/xla/third_party/tsl/tsl/concurrency/async_value.h, third_party/xla/xla/literal.cc, third_party/xla/xla/literal.h",ezhulenev,False
"#tf-data Index flat map dataset does not require random access.

PiperOrigin-RevId: 623887892",Yang Chen,yangchen@google.com,2024-04-11 18:30:06,"tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc, tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py",yangustc07,False
Removed deprecated oneDNN ops,guozhong.zhuang,guozhong.zhuang@intel.com,2024-04-11 18:43:23,"tensorflow/core/BUILD, tensorflow/core/common_runtime/mkl_layout_pass.cc, tensorflow/core/kernels/mkl/BUILD, tensorflow/core/kernels/mkl/mkl_deprecated_ops.cc, tensorflow/core/ops/array_ops.cc, tensorflow/core/ops/math_ops.cc, tensorflow/core/ops/nn_ops.cc",gzmkl,True
"Add tracing to linearization.

PiperOrigin-RevId: 623878422",Kuangyuan Chen,chky@google.com,2024-04-11 18:02:12,third_party/xla/xla/pjrt/transpose.cc,cky9301,False
"remove non-standard strnlen.

PiperOrigin-RevId: 623870201",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 17:37:32,third_party/xla/xla/service/custom_call_status.cc,tensorflower-gardener,False
"[XLA] Allow for partially constrained and automatic layouts within tuple parameters and results.

PiperOrigin-RevId: 623856865",Blake Hechtman,blakehechtman@google.com,2024-04-11 16:55:57,"third_party/xla/xla/layout_util.cc, third_party/xla/xla/layout_util.h, third_party/xla/xla/service/BUILD, third_party/xla/xla/service/computation_layout.cc, third_party/xla/xla/service/layout_assignment.cc, third_party/xla/xla/service/layout_assignment_test.cc, third_party/xla/xla/shape_layout.cc, third_party/xla/xla/shape_layout.h",blakehechtman,False
"Use different mutexes for different data structures to fix a deadlock issue.

PiperOrigin-RevId: 623853833",Changhui Lin,changhuilin@google.com,2024-04-11 16:44:24,"third_party/xla/xla/pjrt/event_pool.cc, third_party/xla/xla/pjrt/event_pool.h",changhuilin,False
"[pjrt] Switch AddChunk to PjRtFuture<> from PjRtFuture<Status> to signal completion

PiperOrigin-RevId: 623847145",Eugene Zhulenev,ezhulenev@google.com,2024-04-11 16:16:48,"third_party/xla/xla/pjrt/c/pjrt_c_api_gpu_test.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_helpers.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_helpers.h, third_party/xla/xla/pjrt/c/pjrt_c_api_test.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_test_base.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_test_base.h, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc, third_party/xla/xla/pjrt/host_callback_test.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.h, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc",ezhulenev,False
"Support LLVM code generation for hexagon target in Tensorflow compiler.

PiperOrigin-RevId: 623844111",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 16:05:16,"tensorflow/compiler/aot/BUILD, tensorflow/compiler/aot/compile.cc, tensorflow/core/platform/build_config_root.bzl, third_party/xla/third_party/tsl/tsl/platform/default/build_config_root.bzl",tensorflower-gardener,False
"Update visibility of TFL Runtime.

PiperOrigin-RevId: 623826977",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 14:58:08,tensorflow/lite/BUILD,tensorflower-gardener,False
"Remove unnecessary DeviceMemoryBase::Reset call in StreamExecutor::Deallocate.

Only one test was counting on it, and this makes it easier to collapse StreamExecutor with StreamExecutorInterface.

PiperOrigin-RevId: 623818566",Kyle Lucke,klucke@google.com,2024-04-11 14:21:10,"tensorflow/c/experimental/stream_executor/stream_executor_test.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc",klucke,False
"PR #10525: Fix tan inaccuracies on complex inputs with large and small absolute values

Imported from GitHub PR https://github.com/openxla/xla/pull/10525

As in the title.

Tan evaluation is verified against mpmath tan function. The corresponding unit tests are included in xla/tests/complex_unary_op_test.cc

When https://github.com/google/jax/pull/20688 lands, the follow-up PR will enable Tan tests at complex infinities.
Copybara import of the project:

--
005ff68200fe6a343c10b8e7129448dfc0d9aa57 by Pearu Peterson <pearu.peterson@gmail.com>:

Fix tan inaccuracies on complex inputs with large and small absolute values.

--
ad3d31f69fb62a9d024cf5f9011ce30fdfd4dfa4 by Pearu Peterson <pearu.peterson@gmail.com>:

Make generate_complex_unary_op_samples.py output clang-format stable

--
d88445489f525186800fb1c2a095bfca6b1de7bf by Pearu Peterson <pearu.peterson@gmail.com>:

Add unittests for Tan with complex inputs

Merging this change closes #10525

PiperOrigin-RevId: 623807467",Pearu Peterson,pearu.peterson@gmail.com,2024-04-11 13:30:51,"third_party/xla/xla/python/xla_client.py, third_party/xla/xla/service/elemental_ir_emitter.cc, third_party/xla/xla/tests/complex_unary_op_samples.h, third_party/xla/xla/tests/complex_unary_op_test.cc, third_party/xla/xla/tests/generate_complex_unary_op_samples.py",pearu,False
"Integrate LLVM at llvm/llvm-project@1fda1776e32b

Updates LLVM usage to match
[1fda1776e32b](https://github.com/llvm/llvm-project/commit/1fda1776e32b)

PiperOrigin-RevId: 623800732",Krasimir Georgiev,krasimir@google.com,2024-04-11 12:59:02,"third_party/llvm/generated.patch, third_party/llvm/workspace.bzl, third_party/triton/llvm_integration/cl623185214.patch, third_party/triton/llvm_integration/series.bzl, third_party/xla/third_party/triton/llvm_integration/cl623185214.patch, third_party/xla/third_party/triton/llvm_integration/series.bzl",krasimirgg,False
"Add C++ level in-process unit test for gloo collectives.

PiperOrigin-RevId: 623784417",Tom Cobley,cobley@google.com,2024-04-11 11:33:20,"third_party/xla/xla/pjrt/cpu/BUILD, third_party/xla/xla/pjrt/cpu/gloo_collectives_test.cc",tomcobley,False
"PR #11249: [XLA:GPU] Update cuDNN flash attention backward to use new cuDNN frontend (>1.0)

Imported from GitHub PR https://github.com/openxla/xla/pull/11249

* Replace complicated node by node flash attention cuDNN graph construction with simple cudnn sdpa call provided in new cuDNN frontend (>1.0).
* Remove softmax_sum/dq_accum tensors from the custom call outputs since it is not required anymore in new cuDNN frontend.
* Add a pass to query workspace from cuDNN graph instead of manual calculation as workspace size is subject to change.
Copybara import of the project:

--
2a1ee169fb2c12fbbd4e791ff406b3272490cf09 by cjkkkk <ske@nvidia.com>:

init

--
e84388a1859ef26acad7ba68cebedf546098d99b by cjkkkk <ske@nvidia.com>:

fix stat datatype to be fp32

--
3a0b75ccfa88791d5cc437a9cc86333849d5fee3 by cjkkkk <ske@nvidia.com>:

use temp value for workspace & remove softmax buffer/dq_accum

--
77e6db53f4f4d0b5344e3492da21e871ceb0bb0b by cjkkkk <ske@nvidia.com>:

add workspace upperbound

--
11dd85db2ebea5cbd12b7108bdc995d8f8f5f1ba by cjkkkk <ske@nvidia.com>:

use tighter upperbound

--
2f245303893f0aef5dc48557f8254d16ae373d9d by cjkkkk <ske@nvidia.com>:

remove unused param

--
5e648ae07c743e95955f23fbd1c4fa50a13be5de by cjkkkk <ske@nvidia.com>:

add pass to fix workspace size

--
368e51879c10266a3ecc200c105afc37dcba544c by cjkkkk <ske@nvidia.com>:

remove comments

--
2fb7b3854f57c80e0c2e7805349ff5b637ba2007 by cjkkkk <ske@nvidia.com>:

rm header order change

--
d0cb184a32a5489f17ca5a20cd11901544e88ba1 by cjkkkk <ske@nvidia.com>:

move def close to use and remove comments

--
f09eb59328d2416374c31c5336744231b67954cd by cjkkkk <ske@nvidia.com>:

move use to def

--
1c56f1fe670cfc43cc1bfcbc16ed75cf9ce5357f by cjkkkk <ske@nvidia.com>:

add missing dependency in BUILD

--
efd8ff45b5cf13e0ae820c03150068a6412204d0 by cjkkkk <ske@nvidia.com>:

pass in correct descriptor to activation

Merging this change closes #11249

PiperOrigin-RevId: 623771291",Shanbin Ke,ske@nvidia.com,2024-04-11 10:30:07,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/cudnn_fused_mha_rewriter.cc, third_party/xla/xla/service/gpu/cudnn_workspace_rewriter.cc, third_party/xla/xla/service/gpu/cudnn_workspace_rewriter.h, third_party/xla/xla/service/gpu/gpu_fused_mha_runner.cc, third_party/xla/xla/service/gpu/gpu_fused_mha_runner.h, third_party/xla/xla/service/gpu/ir_emitter_unnested.cc, third_party/xla/xla/service/gpu/nvptx_compiler.cc, third_party/xla/xla/service/gpu/runtime/fused_mha_thunk.cc, third_party/xla/xla/service/gpu/runtime/fused_mha_thunk.h, third_party/xla/xla/stream_executor/cuda/cuda_dnn.cc, third_party/xla/xla/stream_executor/cuda/cuda_dnn.h, third_party/xla/xla/stream_executor/dnn.h",Cjkkkk,False
"PR #11394: [XLA GPU] Add command buffer BarrierCmd

Imported from GitHub PR https://github.com/openxla/xla/pull/11394

This PR adds barrier command into command buffer. The description for the command:

//===----------------------------------------------------------------------===//
// BarrierCmd
// BarrierCmd insert a barrier from the execution scope created from the
// 'from_stream_id' to the execution scope created from the
// 'execution_stream_id', e.g. Async operator lowered to command buffer requires
// a barrier from the launching stream to the async operator's execution stream.
//===----------------------------------------------------------------------===//

This PR is a split of PR: https://github.com/openxla/xla/pull/11348
Copybara import of the project:

--
56758cb97f5cee224258d722eb42f2f1faf4cd05 by Shawn Wang <shawnw@nvidia.com>:

Add command buffer BarrierCmd

--
c740aea329e9ab5f92442b93d64c88c7f8e8bed7 by Shawn Wang <shawnw@nvidia.com>:

Change NCCL stream id type

--
61cb7c622a0193b404e458e072f282ad0d7a1859 by Shawn Wang <shawnw@nvidia.com>:

fix test failures

Merging this change closes #11394

PiperOrigin-RevId: 623763844",Shawn Wang,shawnw@nvidia.com,2024-04-11 09:55:18,"third_party/xla/xla/service/gpu/gpu_executable.cc, third_party/xla/xla/service/gpu/nccl_clique_key.cc, third_party/xla/xla/service/gpu/nccl_clique_key.h, third_party/xla/xla/service/gpu/nccl_clique_key_test.cc, third_party/xla/xla/service/gpu/runtime/command_buffer_cmd.cc, third_party/xla/xla/service/gpu/runtime/command_buffer_cmd.h, third_party/xla/xla/service/gpu/runtime/command_buffer_cmd_test.cc, third_party/xla/xla/service/gpu/runtime/nccl_collective_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_collective_thunk.h, third_party/xla/xla/service/gpu/runtime/thunk.cc, third_party/xla/xla/service/gpu/runtime/thunk.h, third_party/xla/xla/stream_executor/command_buffer.h",shawnwang18,False
"compat: Update forward compatibility horizon to 2024-04-11

PiperOrigin-RevId: 623752488",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 09:03:30,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Update GraphDef version to 1829.

PiperOrigin-RevId: 623752114",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 09:02:16,tensorflow/core/public/version.h,tensorflower-gardener,False
"Use PTX version corresponding to CUDA version.
For CUDA 11/12, the PT major version is offset by 4 (i.e. ptx 7 for cuda 11, ptx 8 for cuda 12), and the minor version is the same.
Use the maximum currently known PTX version for unrecognized CUDA versions (13 and up).
https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#release-notes

PiperOrigin-RevId: 623751381",Sergey Kozub,sergeykozub@google.com,2024-04-11 08:59:09,"third_party/xla/xla/service/gpu/llvm_gpu_backend/BUILD, third_party/xla/xla/service/gpu/llvm_gpu_backend/gpu_backend_lib.cc",sergeykozub,False
"[XLA:GPU] Increase the autotuning measurement error threshold to 4 us.

We have done soome more measurements that suggest the higher threshold.

PiperOrigin-RevId: 623746993",Dimitar (Mitko) Asenov,dasenov@google.com,2024-04-11 08:38:42,"third_party/xla/xla/service/gpu/stream_executor_util.cc, third_party/xla/xla/service/gpu/stream_executor_util_test.cc",dimitar-asenov,False
"Expand RequestCost with ability to record metrics.

Similar to the request Duration costs adds ability to record request metrics.

PiperOrigin-RevId: 623743335",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 08:19:36,"tensorflow/core/common_runtime/request_cost.cc, tensorflow/core/common_runtime/request_cost.h, tensorflow/core/common_runtime/request_cost_test.cc",tensorflower-gardener,False
"[HloValueSemanticsAnalysis] Fix handling for async start and done.

PiperOrigin-RevId: 623728057",Jinliang Wei,jlwei@google.com,2024-04-11 07:04:32,"third_party/xla/xla/service/hlo_value_semantics_analysis.cc, third_party/xla/xla/service/hlo_value_semantics_analysis.h, third_party/xla/xla/service/hlo_value_semantics_analysis_test.cc",jinliangwei,False
"Add ClearComputations() overload for HloAsyncStart instruction.

This replaces a previous fix in a better way. Otherwise, we will still have
back pointers to instructions which have already been marked for deletion.

PiperOrigin-RevId: 623723252",Adrian Kuegel,akuegel@google.com,2024-04-11 06:40:00,"third_party/xla/xla/hlo/ir/hlo_computation.cc, third_party/xla/xla/hlo/ir/hlo_instructions.cc, third_party/xla/xla/hlo/ir/hlo_instructions.h",akuegel,False
"[pjrt] Add JoinFutures function to join multiple stateless futures

PiperOrigin-RevId: 623719403",Eugene Zhulenev,ezhulenev@google.com,2024-04-11 06:15:44,"third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/pjrt_future.cc, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_future_test.cc",ezhulenev,False
"Reverts de029c02b59c50be15eee59415d1d8f2eb378acd

PiperOrigin-RevId: 623712933",Clive Verghese,cliveverghese@google.com,2024-04-11 05:39:11,"tensorflow/core/profiler/BUILD, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/BUILD, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener.cc, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener.h, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener_state.cc, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener_state.h, third_party/xla/third_party/tsl/tsl/profiler/lib/BUILD, third_party/xla/third_party/tsl/tsl/profiler/lib/context_types.cc, third_party/xla/third_party/tsl/tsl/profiler/lib/context_types.h, third_party/xla/third_party/tsl/tsl/profiler/utils/BUILD, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane.h, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane_test.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.h, third_party/xla/xla/backends/profiler/cpu/BUILD, third_party/xla/xla/backends/profiler/cpu/host_tracer.cc",cliveverghese,False
"Automated Code Change

PiperOrigin-RevId: 623711634",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 05:32:28,"tensorflow/c/kernels_experimental.cc, tensorflow/c/while_loop_test.cc",tensorflower-gardener,False
"Add unbounded dynamism test for CallOp.

PiperOrigin-RevId: 623707556",Gunhyun Park,gunhyun@google.com,2024-04-11 05:08:55,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Automated Code Change

PiperOrigin-RevId: 623707524",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 05:08:41,"tensorflow/lite/experimental/microfrontend/BUILD, tensorflow/lite/experimental/microfrontend/audio_microfrontend.cc, tensorflow/lite/experimental/microfrontend/audio_microfrontend_test.cc",tensorflower-gardener,False
"[XLA:AlgebraicSimplifier] Simplify the following gather patterns:
1. gather(pad(...)) -> pad(gather(...))
2. gather(reshape(pad(...))) -> pad(gather(reshape(...)))

PiperOrigin-RevId: 623703927",Tongfei Guo,tongfei@google.com,2024-04-11 04:48:00,"third_party/xla/xla/hlo/utils/hlo_sharding_util.cc, third_party/xla/xla/hlo/utils/hlo_sharding_util.h, third_party/xla/xla/service/BUILD, third_party/xla/xla/service/algebraic_simplifier.cc, third_party/xla/xla/service/algebraic_simplifier_test.cc, third_party/xla/xla/service/spmd/gather_scatter_handler.cc",Tongfei-Guo,False
"Automated Code Change

PiperOrigin-RevId: 623703740",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 04:46:42,"tensorflow/core/profiler/utils/gpu_event_stats.h, tensorflow/core/profiler/utils/op_metrics_db_utils.cc",tensorflower-gardener,False
"Simple scaled dot product attention kernel. GenAI ops custom registerer.

PiperOrigin-RevId: 623702104",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 04:36:06,"tensorflow/lite/experimental/genai/BUILD, tensorflow/lite/experimental/genai/genai_ops.cc, tensorflow/lite/experimental/genai/genai_ops.h, tensorflow/lite/experimental/genai/genai_ops_wrapper.cc, tensorflow/lite/experimental/genai/pywrap_genai_ops.pyi, tensorflow/lite/experimental/genai/sdpa.cc",tensorflower-gardener,False
"[xla] hlo_computation: compact instructions' vector on Cleanup()

tl;dr: this gives a 1.26x compilation time speedup for a large, dense
model in XLA:GPU.

The largest perf leaf seen in profiles of a large, dense model
is related to computing the post order. Surprisingly, it is not
the DFS itself what's most expensive; rather, most of the time is
spent on scanning through HloComputation::Instructions() to identify
DFS roots.

The reason this scan becomes expensive as instructions are removed
is that the vector holding HloInstructionInfo (introduced in
cl/600130708 || https://github.com/openxla/xla/commit/247280ab727)
is not shrunk as it flows through the pipeline, making us having
to walk through many deleted ""tombstone"" entries. Here is the
histogram of # of tombstones encountered during post order
computations for this model:

```
[        1 - 1,536,345) ****************************** (1,300,248)
[1,536,345 - 3,072,690)  (2)
[3,072,690 - 4,609,034)  (364)
[4,609,034 - 6,145,378)  (10,443)
```

To ameliorate this, this CL shrinks the vector periodically,
so far only between passes. This is done by running compaction
on the vector during HloComputation::Cleanup(), which is called
after every pass. Note that the removal operation must be stable
because some users depend on it -- I have added comments to
the code about this because it took me some time to realize the
extent of our users' reliance on this property. Fortunately,
I have seen no measurable performance difference between the stable
and unstable (""swap-remove"") implementations.

This periodic shrinking of the vector brings the number of seen
tombstones down significantly:

```
[        1 -   327,699) ****************************** (937,541)
[  327,699 -   655,396)  (308)
[  655,396 -   983,094)  (0)
[  983,094 - 1,310,792)  (1)
```

Note: we could further improve compaction by calling Cleanup()
from some passes, instead of just between passes. However, that
would not yield a significant gain; at least for this model,
scanning the instructions' vector now takes ~1% of total time
(vs. ~17% before).
PiperOrigin-RevId: 623700844",Emilio Cota,ecg@google.com,2024-04-11 04:27:49,"third_party/xla/xla/hlo/ir/hlo_computation.cc, third_party/xla/xla/hlo/ir/hlo_computation.h",cota,False
"Add `GetOpSharding` and `SetInstructionSharding` in `XlaBuilder`.

They are similar to `GetShape` and `SetInstructionFrontendAttribute`.

PiperOrigin-RevId: 623698897",Zixuan Jiang,zixuanjiang@google.com,2024-04-11 04:15:29,"third_party/xla/xla/client/BUILD, third_party/xla/xla/client/xla_builder.cc, third_party/xla/xla/client/xla_builder.h, third_party/xla/xla/client/xla_builder_test.cc",ZixuanJiang,False
"    Set metadata and frontend attributes for instructions added/modified in algebraic simplifier HLO pass.

PiperOrigin-RevId: 623662050",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-11 01:08:53,third_party/xla/xla/service/algebraic_simplifier.cc,tensorflower-gardener,False
"Reintroduces the ""tiny term trick.""

PiperOrigin-RevId: 623646009",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 23:57:38,third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_solver.cc,tensorflower-gardener,False
"Remove device_ordinal from StreamExecutorInterface::Init method.

Set it in the constructor of each StreamExecutor implementation that needs it instead.

PiperOrigin-RevId: 623642245",Kyle Lucke,klucke@google.com,2024-04-10 23:41:44,"tensorflow/c/experimental/stream_executor/stream_executor.cc, third_party/xla/xla/backends/interpreter/executor.h, third_party/xla/xla/backends/interpreter/platform.cc, third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/cuda/cuda_platform.cc, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/host/host_executor.cc, third_party/xla/xla/stream_executor/host/host_executor.h, third_party/xla/xla/stream_executor/host/host_platform.cc, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/stream_executor/rocm/rocm_platform.cc, third_party/xla/xla/stream_executor/stream_executor_internal.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h, third_party/xla/xla/stream_executor/tpu/tpu_executor.cc, third_party/xla/xla/stream_executor/tpu/tpu_executor.h, third_party/xla/xla/stream_executor/tpu/tpu_executor_c_api.h, third_party/xla/xla/stream_executor/tpu/tpu_platform.cc",klucke,False
"Remove mock_nccl collateral, as it no longer compiles, and is unused.

PiperOrigin-RevId: 623632567",Kyle Lucke,klucke@google.com,2024-04-10 23:03:12,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/mock_nccl_topo_config.h, third_party/xla/xla/service/gpu/mock_nccl_utils.cc, third_party/xla/xla/service/gpu/mock_nccl_utils.h, third_party/xla/xla/service/gpu/mock_nccl_utils_default.cc, third_party/xla/xla/service/gpu/mock_nccl_xml.cc, third_party/xla/xla/service/gpu/mock_nccl_xml.h, third_party/xla/xla/service/gpu/mock_nccl_xml_test.cc",klucke,False
"Add unbounded dynamism test for CollectiveBroadcastOp.

PiperOrigin-RevId: 623630299",Gunhyun Park,gunhyun@google.com,2024-04-10 22:54:09,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Increase default logging for MLIR embedding rewrite passes

PiperOrigin-RevId: 623625663",Pat Notz,patn@google.com,2024-04-10 22:36:04,"tensorflow/compiler/mlir/tensorflow/transforms/sparsecore/embedding_pipelining.cc, tensorflow/compiler/mlir/tensorflow/transforms/sparsecore/embedding_sequencing.cc",patnotz,False
"Redefines the identifier API of the kind of a `PjRtMemorySpace`:
1) `PjRtMemorySpace::kind()` returns a verbose string identifying the kind of a `PjRtMemorySpace` instance. For instance, ""device"", ""pinned_host"".
2) `PjRtMemorySpace::kind_id()` returns a unique ID identifying the kind ID of a `PjRtMemorySpace` instance. This is useful for quickly comparing the kinds of memory spaces.

PiperOrigin-RevId: 623622684",Yunlong Liu,yunlongl@google.com,2024-04-10 22:25:42,"third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/c/CHANGELOG.md, third_party/xla/xla/pjrt/c/pjrt_c_api.h, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.h, third_party/xla/xla/pjrt/host_memory_spaces.cc, third_party/xla/xla/pjrt/host_memory_spaces.h, third_party/xla/xla/pjrt/pjrt_c_api_client.cc, third_party/xla/xla/pjrt/pjrt_c_api_client.h, third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/python/ifrt/memory.cc, third_party/xla/xla/python/ifrt/mock.h, third_party/xla/xla/python/ifrt_proxy/client/client.cc, third_party/xla/xla/python/ifrt_proxy/client/client_test.cc, third_party/xla/xla/python/ifrt_proxy/client/memory.h, third_party/xla/xla/python/ifrt_proxy/common/ifrt_service.proto, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend_test.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_array.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.cc, third_party/xla/xla/python/py_device.cc, third_party/xla/xla/python/py_device_list.cc, third_party/xla/xla/python/py_memory_space.cc",yliu120,False
"Add unbounded dynamism test for CollectivePermuteOp.

PiperOrigin-RevId: 623608860",Gunhyun Park,gunhyun@google.com,2024-04-10 21:36:46,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add unbounded dynamism test for RecvOp.

PiperOrigin-RevId: 623605912",Gunhyun Park,gunhyun@google.com,2024-04-10 21:26:33,third_party/xla/xla/client/xla_builder_test.cc,ghpvnist,False
"Add sycl build target #10244

PiperOrigin-RevId: 623599115",Yang Sheng,yang.sheng@intel.com,2024-04-10 21:03:14,".bazelrc, tensorflow/opensource_only.files, third_party/gpus/crosstool/BUILD.sycl.tpl, third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_sycl.tpl, third_party/gpus/crosstool/sycl_cc_toolchain_config.bzl.tpl, third_party/gpus/find_sycl_config.py, third_party/gpus/rocm/build_defs.bzl.tpl, third_party/gpus/rocm_configure.bzl, third_party/gpus/sycl/BUILD, third_party/gpus/sycl/BUILD.tpl, third_party/gpus/sycl/build_defs.bzl.tpl, third_party/gpus/sycl_configure.bzl, third_party/xla/.bazelrc, third_party/xla/third_party/tsl/.bazelrc, third_party/xla/third_party/tsl/opensource_only.files, third_party/xla/third_party/tsl/third_party/gpus/crosstool/BUILD.sycl.tpl, third_party/xla/third_party/tsl/third_party/gpus/crosstool/clang/bin/crosstool_wrapper_driver_sycl.tpl, third_party/xla/third_party/tsl/third_party/gpus/crosstool/sycl_cc_toolchain_config.bzl.tpl, third_party/xla/third_party/tsl/third_party/gpus/find_sycl_config.py, third_party/xla/third_party/tsl/third_party/gpus/rocm/build_defs.bzl.tpl, third_party/xla/third_party/tsl/third_party/gpus/rocm_configure.bzl, third_party/xla/third_party/tsl/third_party/gpus/sycl/BUILD, third_party/xla/third_party/tsl/third_party/gpus/sycl/BUILD.tpl, third_party/xla/third_party/tsl/third_party/gpus/sycl/build_defs.bzl.tpl, third_party/xla/third_party/tsl/third_party/gpus/sycl_configure.bzl, third_party/xla/third_party/tsl/workspace2.bzl, third_party/xla/xla/stream_executor/build_defs.bzl",ShengYang1,False
"[XLA:MSA] Add option to filter buffers by size in bytes to override their priority of alternate memory assignment.

PiperOrigin-RevId: 623584547",Subhankar Shah,subhankarshah@google.com,2024-04-10 20:14:16,"third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.cc, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment.proto, third_party/xla/xla/service/memory_space_assignment/memory_space_assignment_test.cc",subhankarshah,False
"Add unbounded dynamism test for SendOp.

PiperOrigin-RevId: 623578297",Gunhyun Park,gunhyun@google.com,2024-04-10 19:51:44,third_party/xla/xla/client/xla_builder_test.cc,ghpvnist,False
"Add unbounded dynamism test for OutfeedOp.

PiperOrigin-RevId: 623574600",Gunhyun Park,gunhyun@google.com,2024-04-10 19:36:28,third_party/xla/xla/client/xla_builder_test.cc,ghpvnist,False
"Fix RocmExecutor copy/paste errors in refactoring FFT and BLAS refactoring CLs.

PiperOrigin-RevId: 623571714",Kyle Lucke,klucke@google.com,2024-04-10 19:24:55,third_party/xla/xla/stream_executor/rocm/rocm_executor.cc,klucke,False
"Add unbounded dynamism test for InfeedOp.

PiperOrigin-RevId: 623569098",Gunhyun Park,gunhyun@google.com,2024-04-10 19:15:10,third_party/xla/xla/client/xla_builder_test.cc,ghpvnist,False
"Add unbounded dynamism test for AllReduceOp.

PiperOrigin-RevId: 623565583",Gunhyun Park,gunhyun@google.com,2024-04-10 19:03:15,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"[ifrt] Make xla::ifrt::DeviceList default constructible.

PiperOrigin-RevId: 623559836",Ce Zheng,zce@google.com,2024-04-10 18:42:33,"third_party/xla/xla/python/ifrt/device.h, third_party/xla/xla/python/py_device_list.cc",cezheng,False
"Add unbounded dynamism test for AllGatherOp.

PiperOrigin-RevId: 623558779",Gunhyun Park,gunhyun@google.com,2024-04-10 18:38:53,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Make StreamExecutorInterface::HostMemoryAllocate return an absl::StatusOr<std::unique_ptr<MemoryAllocation>> in preparation for StreamExecutor inheriting from it.

PiperOrigin-RevId: 623552769",Kyle Lucke,klucke@google.com,2024-04-10 18:20:26,"tensorflow/c/experimental/stream_executor/BUILD, tensorflow/c/experimental/stream_executor/stream_executor.cc, third_party/xla/xla/backends/interpreter/BUILD, third_party/xla/xla/backends/interpreter/executor.h, third_party/xla/xla/stream_executor/gpu/BUILD, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/host/host_executor.h, third_party/xla/xla/stream_executor/stream_executor_internal.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h, third_party/xla/xla/stream_executor/tpu/tpu_executor.h",klucke,False
"Add unbounded dynamism test for DynamicUpdateSliceOp.

PiperOrigin-RevId: 623549454",Gunhyun Park,gunhyun@google.com,2024-04-10 18:09:16,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"    Set metadata and frontend attributes for instructions added/modified in space_to_batch_converter HLO pass.

PiperOrigin-RevId: 623548534",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 18:06:25,"third_party/xla/xla/hlo/ir/hlo_computation.cc, third_party/xla/xla/hlo/ir/hlo_computation.h, third_party/xla/xla/service/BUILD, third_party/xla/xla/service/hlo_creation_utils.cc, third_party/xla/xla/service/hlo_creation_utils.h, third_party/xla/xla/service/space_to_batch_converter.cc",tensorflower-gardener,False
"add some internal changes

PiperOrigin-RevId: 623547261",Feng Wang,wffw@google.com,2024-04-10 18:02:26,"tensorflow/core/profiler/protobuf/overview_page.proto, tensorflow/core/profiler/protobuf/power_metrics.proto",lionelfeng,False
"Change StreamExecutor::HostMemoryAllocate to return a std::unique_ptr<MemoryAllocation> rather than a std::unique_ptr<HostMemoryAllocation>.

PiperOrigin-RevId: 623546174",Kyle Lucke,klucke@google.com,2024-04-10 17:59:16,"third_party/xla/xla/stream_executor/gpu/gpu_timer.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"Add Eigen Listener for thread pool schedule and execute events

PiperOrigin-RevId: 623545426",Clive Verghese,cliveverghese@google.com,2024-04-10 17:56:53,"tensorflow/core/profiler/BUILD, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/BUILD, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener.cc, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener.h, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener_state.cc, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/threadpool_listener_state.h, third_party/xla/third_party/tsl/tsl/profiler/lib/BUILD, third_party/xla/third_party/tsl/tsl/profiler/lib/context_types.cc, third_party/xla/third_party/tsl/tsl/profiler/lib/context_types.h, third_party/xla/third_party/tsl/tsl/profiler/utils/BUILD, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane.h, third_party/xla/third_party/tsl/tsl/profiler/utils/preprocess_xplane_test.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.cc, third_party/xla/third_party/tsl/tsl/profiler/utils/xplane_schema.h, third_party/xla/xla/backends/profiler/cpu/BUILD, third_party/xla/xla/backends/profiler/cpu/host_tracer.cc",cliveverghese,False
"Updates the lazy memory implementation to automatically include low-cardinality memory constraints.

PiperOrigin-RevId: 623544771",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 17:54:45,"third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_solver.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_solver_test.cc",tensorflower-gardener,False
"Move Dnn-specific functions into GpuExecutors instead of StreamExecutor.

PiperOrigin-RevId: 623542918",Kyle Lucke,klucke@google.com,2024-04-10 17:48:59,"third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc",klucke,False
"Directly use absl::Status instead of xla::Status now that they're the same thing.

PiperOrigin-RevId: 623535753",Kyle Lucke,klucke@google.com,2024-04-10 17:24:52,"tensorflow/compiler/aot/embedded_protocol_buffers.h, tensorflow/compiler/jit/xla_device_context.cc, tensorflow/compiler/mlir/lite/flatbuffer_export.cc, tensorflow/compiler/mlir/lite/flatbuffer_import.cc, tensorflow/compiler/mlir/lite/flatbuffer_operator.cc, tensorflow/compiler/mlir/lite/utils/convert_type.cc, tensorflow/core/tpu/graph_rewrite/tpu_embedding_software_deduplication_rewrite_pass.cc, tensorflow/core/tpu/tpu_execute.cc, tensorflow/core/tpu/tpu_execute.h, third_party/xla/xla/client/xla_builder.h, third_party/xla/xla/ffi/ffi_api.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_helpers.h, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc, third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.h, third_party/xla/xla/python/inspect_sharding.cc, third_party/xla/xla/python/py_client_gpu.cc, third_party/xla/xla/service/spmd/spmd_partitioner_test.cc, third_party/xla/xla/status_macros.h, third_party/xla/xla/tools/hlo_opt/opt_main.cc, third_party/xla/xla/tools/run_hlo_module_main.cc, third_party/xla/xla/translate/hlo_to_mhlo/hlo_utils.cc",klucke,False
"[xla:gpu] Check fusion root opcode before declaring it multi-output fusion

PiperOrigin-RevId: 623535133",Eugene Zhulenev,ezhulenev@google.com,2024-04-10 17:22:56,third_party/xla/xla/service/gpu/hlo_traversal.cc,ezhulenev,False
"Remove final specifier from MockLoadedExecutable.

PiperOrigin-RevId: 623531760",Ionel Gog,icgog@google.com,2024-04-10 17:11:57,third_party/xla/xla/python/ifrt/mock.h,ICGog,False
"Split patch files from Triton integration in different folders

PiperOrigin-RevId: 623516339",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 16:22:34,"third_party/triton/llvm_integration/BUILD, third_party/triton/llvm_integration/series.bzl, third_party/triton/temporary/BUILD, third_party/triton/temporary/cl609333259.patch, third_party/triton/temporary/series.bzl, third_party/triton/workspace.bzl, third_party/triton/xla_extensions/BUILD, third_party/triton/xla_extensions/env_vars.patch, third_party/triton/xla_extensions/series.bzl, third_party/triton/xla_extensions/sparse_dot_base.patch, third_party/triton/xla_extensions/sparse_dot_nvgpu.patch, third_party/triton/xla_extensions/sparse_dot_passes.patch, third_party/xla/third_party/triton/llvm_integration/BUILD, third_party/xla/third_party/triton/llvm_integration/series.bzl, third_party/xla/third_party/triton/temporary/BUILD, third_party/xla/third_party/triton/temporary/cl609333259.patch, third_party/xla/third_party/triton/temporary/series.bzl, third_party/xla/third_party/triton/workspace.bzl, third_party/xla/third_party/triton/xla_extensions/BUILD, third_party/xla/third_party/triton/xla_extensions/env_vars.patch, third_party/xla/third_party/triton/xla_extensions/series.bzl, third_party/xla/third_party/triton/xla_extensions/sparse_dot_base.patch, third_party/xla/third_party/triton/xla_extensions/sparse_dot_nvgpu.patch, third_party/xla/third_party/triton/xla_extensions/sparse_dot_passes.patch",tensorflower-gardener,False
"Move Blas caching into the GpuExecutor, the only StreamExecutor that does them.

PiperOrigin-RevId: 623504775",Kyle Lucke,klucke@google.com,2024-04-10 15:39:48,"third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/stream_executor/stream_executor_internal.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"Move Fft caching into the GpuExecutor, the only StreamExecutor that does them.

PiperOrigin-RevId: 623500061",Kyle Lucke,klucke@google.com,2024-04-10 15:20:16,"third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/stream_executor/stream_executor_internal.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"Create and use 2.17 toolchains in Docker build containers.

PiperOrigin-RevId: 623491147",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 14:44:33,".bazelrc, .github/workflows/update-rbe.yml, tensorflow/tools/tf_sig_build_dockerfiles/Dockerfile, tensorflow/tools/tf_sig_build_dockerfiles/devel.packages.txt, tensorflow/tools/tf_sig_build_dockerfiles/devel.usertools/cpu_gcc.bazelrc, tensorflow/tools/tf_sig_build_dockerfiles/setup.sources.sh, tensorflow/tools/toolchains/remote_config/configs.bzl, third_party/xla/.bazelrc, third_party/xla/third_party/tsl/.bazelrc, third_party/xla/third_party/tsl/tools/toolchains/remote_config/configs.bzl, third_party/xla/tools/toolchains/remote_config/configs.bzl",tensorflower-gardener,False
"Remove jaxlib compatibiliy hack

jaxlib updates it's upstream XLA version, so this ~hack~ compatiblity layer is not needed anymore.

PiperOrigin-RevId: 623491067",Henning Becker,hebecker@google.com,2024-04-10 14:44:11,"third_party/xla/xla/stream_executor/gpu/BUILD, third_party/xla/xla/stream_executor/gpu/asm_compiler.h",beckerhe,False
"[XLA:Python] Delete unused method make_cross_host_receive_buffers.

This was added as part of a prototype but no users appear to exist any more, and it was never a publicized API.

PiperOrigin-RevId: 623488172",Peter Hawkins,phawkins@google.com,2024-04-10 14:32:46,"third_party/xla/xla/python/py_client.cc, third_party/xla/xla/python/py_client.h, third_party/xla/xla/python/xla_extension/__init__.pyi",hawkinsp,False
"Enforces cumulative solver timeouts during lazy memory instantiation.

PiperOrigin-RevId: 623486944",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 14:27:14,third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_solver.cc,tensorflower-gardener,False
"PR #11182: [NVIDIA GPU] Optimize collective permute using memcpy

Imported from GitHub PR https://github.com/openxla/xla/pull/11182

When the source and target pair of a collective permute instruction are located within the same node, we will try to use cudaMemCpyPeerToPeer to send data instead of invoking nccl send and recv kernels. Because memcpy will use the copy engine on the GPU instead of launching a kernel, copy engine can fully saturate the bandwidth without occupying any SM.
Since memcpyP2p needs the destination pointer of the other device, we first communicate the pointer values with peer using nccl calls and use the pointer to invoke memcpy.
Some perf comparison:
sending a tensor of this size bf16[512,24576]{1,0}:
Using collective-permute: 445 us
using memcpy: 100us
Copybara import of the project:

--
73a2568520d411eb6f62b6383a3841cb0f8edf22 by TJ <tjx@nvidia.com>:

optimize collective permute using memcpy

--
1dd896f544852fa898e937af8c0b94e075db3ec2 by TJ <tjx@nvidia.com>:

Remove nccl calls and use Async value

--
a2fbc7d29d3d8106753f36e2a477e0889da6cb58 by TJ <tjx@nvidia.com>:

wrap async map and mutex with a class

Merging this change closes #11182

PiperOrigin-RevId: 623481864",TJ Xu,tjx@nvidia.com,2024-04-10 14:04:52,"third_party/xla/xla/debug_options_flags.cc, third_party/xla/xla/service/gpu/ir_emitter_unnested.cc, third_party/xla/xla/service/gpu/runtime/BUILD, third_party/xla/xla/service/gpu/runtime/command_buffer_cmd.cc, third_party/xla/xla/service/gpu/runtime/nccl_all_gather_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_all_gather_thunk.h, third_party/xla/xla/service/gpu/runtime/nccl_all_reduce_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_all_reduce_thunk.h, third_party/xla/xla/service/gpu/runtime/nccl_all_to_all_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_all_to_all_thunk.h, third_party/xla/xla/service/gpu/runtime/nccl_collective_broadcast_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_collective_broadcast_thunk.h, third_party/xla/xla/service/gpu/runtime/nccl_collective_permute_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_collective_permute_thunk.h, third_party/xla/xla/service/gpu/runtime/nccl_collective_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_collective_thunk.h, third_party/xla/xla/service/gpu/runtime/nccl_recv_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_recv_thunk.h, third_party/xla/xla/service/gpu/runtime/nccl_send_thunk.cc, third_party/xla/xla/service/gpu/runtime/nccl_send_thunk.h, third_party/xla/xla/service/gpu/runtime/thunk.cc, third_party/xla/xla/service/gpu/runtime/thunk.h, third_party/xla/xla/xla.proto",Tixxx,False
"Automated Code Change

PiperOrigin-RevId: 623480882",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 14:00:37,"tensorflow/lite/kernels/shim/BUILD, tensorflow/lite/kernels/shim/op_kernel.h, tensorflow/lite/kernels/shim/tensor_view.h, tensorflow/lite/kernels/shim/tflite_op_wrapper.h",tensorflower-gardener,False
"PR #11331: [ROCm] Fix compilation issues related to aa08925e2dd1351c68e7838e074fe35908e3

Imported from GitHub PR https://github.com/openxla/xla/pull/11331

Copybara import of the project:

--
a4f80a3f32a10230bfdaa1dadc12f1f385883d8a by Zoran Jovanovic <zjovanov@amd.com>:

Fix compilatio issues related to aa08925e2dd1351c68e7838e074fe35908e3ea07
(Triton in XLA for ROCm - ir_emitter_triton related changes)

Merging this change closes #11331

PiperOrigin-RevId: 623476962",zoranjovanovic-ns,126815388+zoranjovanovic-ns@users.noreply.github.com,2024-04-10 13:39:45,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/ir_emitter_triton_rocm.cc, third_party/xla/xla/service/gpu/llvm_gpu_backend/BUILD",zoranjovanovic-ns,False
"PR #11398: [ROCm] Build fix

Imported from GitHub PR https://github.com/openxla/xla/pull/11398

This contains two fixes:
* A compilation fix for stream_executor/rocm/rocm_executor.cc after it got broken by  the commit https://github.com/openxla/xla/commit/3c5cf0ac2adbc0a651d3a2ec822e47927218b153
* A workaround that allows static_assert(false) to be compiled with compilers not implementing https://cplusplus.github.io/CWG/issues/2518.html
Copybara import of the project:

--
5cdd25c3190140fec619073d25a20952fed2fd8b by Eugene Kuznetsov <eugene.kuznetsov@amd.com>:

Build fix

--
b86d12ff02a2a6247a7f991f77dfdafb08a79703 by Eugene Kuznetsov <eugene.kuznetsov@amd.com>:

Workaround for static_assert needed for some compilers
(https://cplusplus.github.io/CWG/issues/2518.html)

Merging this change closes #11398

PiperOrigin-RevId: 623471087",ekuznetsov139,nameless@fastmail.fm,2024-04-10 13:08:25,"third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/tests/complex_unary_op_samples.h, third_party/xla/xla/tests/complex_unary_op_test.cc",ekuznetsov139,False
"Temporarily disable newer cuDNN fMHA features due to miscompile

I'm trying to make XLA compatible with cuDNN 9 and stumbled upon
a miscompile in the fMHA rewriter.

It seems to be related with the cause mask pattern matcher, at least
forcing the causal mask flag to true, makes the broken test path.

I extract a reproducer and added an (integration) test which
can be removed or converted into a proper unit test once this is fixed.

IN the meantime I disable all fMHA features that require a version
of cuDNN 8.9.6+.

PiperOrigin-RevId: 623470743",Henning Becker,hebecker@google.com,2024-04-10 13:06:49,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/cudnn_fused_mha_rewriter.cc, third_party/xla/xla/service/gpu/cudnn_fused_mha_rewriter_test.cc",beckerhe,False
"Automated Code Change

PiperOrigin-RevId: 623456155",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 11:56:10,tensorflow/core/data/captured_function.cc,tensorflower-gardener,False
"Use stable_sort to make horizontal loop fusion pass deterministic.

PiperOrigin-RevId: 623454637",Adrian Kuegel,akuegel@google.com,2024-04-10 11:48:07,third_party/xla/xla/service/gpu/horizontal_loop_fusion.cc,akuegel,False
"Automated Code Change

PiperOrigin-RevId: 623446648",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 11:07:24,tensorflow/core/data/service/client/data_service_client.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623442999",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 10:51:03,"tensorflow/core/common_runtime/eager/context_distributed_manager.cc, tensorflow/core/common_runtime/eager/copy_to_device_node.h, tensorflow/core/common_runtime/eager/custom_device_op_handler.cc, tensorflow/core/common_runtime/eager/custom_device_test.cc, tensorflow/core/common_runtime/eager/execute.cc, tensorflow/core/common_runtime/eager/kernel_and_device.cc, tensorflow/core/common_runtime/eager/tensor_handle.cc, tensorflow/core/common_runtime/eager/tensor_handle_data.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623442112",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 10:46:13,"tensorflow/compiler/tf2xla/light_outside_compilation_kernels_for_test.cc, tensorflow/compiler/tf2xla/literal_util.cc",tensorflower-gardener,False
"PR #11307: [ROCm] Upstreaming old changes

Imported from GitHub PR https://github.com/openxla/xla/pull/11307

This PR upstreams changes from [#2467](https://github.com/ROCm/tensorflow-upstream/pull/2467/commits/c3d966e559ffd13f6a473d1b57e606314a456ce8) and also upstreams changes to `gpu_layout_assignment.cc` introduced [here](https://github.com/ROCm/tensorflow-upstream/commit/b34b1eb35c095a16208356913a956256cc419e99) and [here](https://github.com/ROCm/tensorflow-upstream/commit/dfb7dd0b2f7e6c6bbcd3f1dbc9e299be9554b4a7).
Copybara import of the project:

--
ceaa8b0ab3dfda7ad93a7c57f5c26e6b31365a80 by mmakevic <Milica.Makevic@amd.com>:

adding env variable to control rocm_dnn workspace limit

--
b7661ef811dfff68e03b4fe4306c1f63ffd1e2ee by mmakevic <Milica.Makevic@amd.com>:

Changes to use NHWC for FP16 ops on XLA path for ROCm 5.0 and MI100/200

Fix double =

--
cfeb2dec629eac32d5afc8256f2c684bbe81fe75 by mmakevic <Milica.Makevic@amd.com>:

Check if rocm or cuda are used during runtime

Merging this change closes #11307

PiperOrigin-RevId: 623438181",mmakevic-amd,Milica.Makevic@amd.com,2024-04-10 10:27:32,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/conv_algorithm_picker.cc, third_party/xla/xla/service/gpu/gpu_layout_assignment.cc",mmakevic-amd,False
"Fix order of removing dead computations in HloDCE

We used to delete subcomputations that become dead due to removal of its
calling computation before deleting the calling computation. This is asking for
trouble, e.g. regarding cleanup routines.

PiperOrigin-RevId: 623434223",Adrian Kuegel,akuegel@google.com,2024-04-10 10:07:36,third_party/xla/xla/service/hlo_dce.cc,akuegel,False
"[XLA] Add argument and return shardings to while body and cond based on result shardings if present.

This is needed in case propagation runs before this conversion, in which case the best indicator for the argument and return shardings are the shardings of the while results.

PiperOrigin-RevId: 623433069",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 10:02:44,"third_party/xla/xla/mlir_hlo/mhlo/transforms/prepare_for_export/prepare_for_export.cc, third_party/xla/xla/mlir_hlo/tests/Dialect/mhlo/prepare-for-export.mlir, third_party/xla/xla/translate/mhlo_to_hlo/mlir_hlo_to_hlo.cc, third_party/xla/xla/translate/mhlo_to_hlo/tests/sharding.mlir",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623431068",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 09:53:04,tensorflow/core/common_runtime/gpu/gpu_util.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623429617",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 09:45:48,"tensorflow/compiler/mlir/tfrt/BUILD, tensorflow/compiler/mlir/tfrt/backend_compiler.h",tensorflower-gardener,False
"[XLA:GPU] Add fusion into Triton Softmax in PriorityFusion pass.

This feature is under development and will likely remain unstable until we finish work on SymbolicTileAnalysis.

PiperOrigin-RevId: 623428765",Oleg Shyshkov,shyshkov@google.com,2024-04-10 09:41:32,"third_party/xla/xla/debug_options_flags.cc, third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/priority_fusion.cc, third_party/xla/xla/service/gpu/priority_fusion_test.cc, third_party/xla/xla/xla.proto",olegshyshkov,False
"Implement map HLO -> MLIR.

PiperOrigin-RevId: 623424640",Johannes Reifferscheid,jreiffers@google.com,2024-04-10 09:20:16,"third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir_test.cc, third_party/xla/xla/service/gpu/model/indexing_analysis.cc, third_party/xla/xla/service/gpu/model/indexing_analysis_test.cc",jreiffers,False
"Automated Code Change

PiperOrigin-RevId: 623421779",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 09:07:23,"tensorflow/core/kernels/collective_ops.cc, tensorflow/core/kernels/constant_op.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623421390",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 09:05:56,tensorflow/core/distributed_runtime/graph_mgr.cc,tensorflower-gardener,False
"compat: Update forward compatibility horizon to 2024-04-10

PiperOrigin-RevId: 623420947",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 09:04:00,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623420750",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 09:03:19,tensorflow/core/common_runtime/next_pluggable_device/next_pluggable_device_context.cc,tensorflower-gardener,False
"Update GraphDef version to 1828.

PiperOrigin-RevId: 623420486",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 09:02:34,tensorflow/core/public/version.h,tensorflower-gardener,False
"Remove outdated iOS example app.

PiperOrigin-RevId: 623416443",Quentin Khan,qkhan@google.com,2024-04-10 08:44:08,"tensorflow/lite/examples/ios/camera/.gitignore, tensorflow/lite/examples/ios/camera/CameraExampleAppDelegate.h, tensorflow/lite/examples/ios/camera/CameraExampleAppDelegate.m, tensorflow/lite/examples/ios/camera/CameraExampleViewController.h, tensorflow/lite/examples/ios/camera/CameraExampleViewController.mm, tensorflow/lite/examples/ios/camera/Info.plist, tensorflow/lite/examples/ios/camera/MainStoryboard_iPhone.storyboard, tensorflow/lite/examples/ios/camera/Podfile, tensorflow/lite/examples/ios/camera/README.md, tensorflow/lite/examples/ios/camera/data/.gitignore, tensorflow/lite/examples/ios/camera/data/labels.txt, tensorflow/lite/examples/ios/camera/main.mm, tensorflow/lite/examples/ios/camera/tflite_camera_example.xcodeproj/project.pbxproj",qukhan,False
"Remove XlaOutlineEntryFunctions pass

PiperOrigin-RevId: 623407968",Jian Cai,jiancai@google.com,2024-04-10 08:06:05,"tensorflow/compiler/mlir/tensorflow/tests/xla_outline_entry_functions.mlir, tensorflow/compiler/mlir/tf2xla/internal/clustering_bridge_passes.cc, tensorflow/compiler/mlir/tf2xla/internal/clustering_bridge_passes_test.cc, tensorflow/compiler/mlir/tf2xla/internal/passes/BUILD, tensorflow/compiler/mlir/tf2xla/internal/passes/clustering_passes.h, tensorflow/compiler/mlir/tf2xla/internal/passes/clustering_passes.td, tensorflow/compiler/mlir/tf2xla/internal/passes/xla_outline_entry_functions.cc",jcai19,False
"Automated Code Change

PiperOrigin-RevId: 623405817",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 07:57:41,"tensorflow/core/distributed_runtime/base_rendezvous_mgr.cc, tensorflow/core/distributed_runtime/collective_rma_distributed.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623404968",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 07:53:09,"tensorflow/core/common_runtime/propagator_state.cc, tensorflow/core/common_runtime/rendezvous_mgr.cc, tensorflow/core/common_runtime/ring_gatherer.cc, tensorflow/core/common_runtime/ring_reducer.cc, tensorflow/core/common_runtime/simple_propagator_state.cc",tensorflower-gardener,False
"Fix NCCL 2.21.5 compatibility issues

PiperOrigin-RevId: 623398701",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 07:21:12,"third_party/xla/xla/service/gpu/mock_nccl_xml.cc, third_party/xla/xla/service/gpu/mock_nccl_xml_test.cc",tensorflower-gardener,False
"Move Dnn caching into the GpuExecutor, the only StreamExecutor that does them.

PiperOrigin-RevId: 623395712",Kyle Lucke,klucke@google.com,2024-04-10 07:05:39,"third_party/xla/xla/stream_executor/cuda/cuda_executor.cc, third_party/xla/xla/stream_executor/gpu/gpu_executor.h, third_party/xla/xla/stream_executor/rocm/rocm_executor.cc, third_party/xla/xla/stream_executor/stream_executor_internal.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"Automated Code Change

PiperOrigin-RevId: 623388448",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 06:28:37,tensorflow/core/profiler/backends/gpu/device_tracer_test.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623381150",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 05:44:11,tensorflow/core/profiler/lib/device_profiler_session.h,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623374192",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 05:03:04,tensorflow/core/profiler/lib/annotated_traceme.h,tensorflower-gardener,False
"Remove final specifier from IFRT mock classes.

PiperOrigin-RevId: 623369430",Ionel Gog,icgog@google.com,2024-04-10 04:34:35,third_party/xla/xla/python/ifrt/mock.h,ICGog,False
"Add debug logging when resharding may be needed.

PiperOrigin-RevId: 623366148",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 04:13:39,tensorflow/python/tpu/tpu_embedding_v3_checkpoint_adapter.py,tensorflower-gardener,False
"Clean up ownership of IfrtServingExecutable.
Instead of using std::shared_ptr, IfrtExecutableRegistry
hold the std::unique_ptr to it and guarantee its life
time for the model.

PiperOrigin-RevId: 623362516",Deqiang Chen,deqiangc@google.com,2024-04-10 03:52:36,"tensorflow/core/tfrt/ifrt/BUILD, tensorflow/core/tfrt/ifrt/ifrt_executable_registry.cc, tensorflow/core/tfrt/ifrt/ifrt_executable_registry.h, tensorflow/core/tfrt/ifrt/ifrt_executable_registry_test.cc, tensorflow/core/tfrt/kernels/ifrt_program_ops.h",deqiangc,False
"[IFRT] Add `DeserializeProgramOptions`

`DeserializeProgramOptions` is used when deserializing `Program`. It now takes
`lookup_device` that allows `Program` deserialization to reconstruct any
`Device`-related objects (e.g., `DeviceList`, `Sharding`).

Traditionally, a program encoded device ids without IFRT serialization support
-- e.g., `device_assignment` in `xla::ExecutableBuildOptions` included in
`xla::CompileOptions` or `devices` in IFRT IR. Similar for sharding
representations. They do not need to look up devices when deserializing
`Program`, but some stack needs to check the device ids and shardings
eventually. Having `lookup_device` in `DeserializeProgramOptions` would make
this validation done at the deserialization time and applied to `Program`
subclasses automaticallly as long as they use IFRT `Sharding` objects in the
subclasses.

Also move `Program` out of `ifrt/compiler.h` as a program stands by itself, and
is not dependent on `Compiler`.

PiperOrigin-RevId: 623359727",Hyeontaek Lim,hyeontaek@google.com,2024-04-10 03:34:20,"third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/compiler.cc, third_party/xla/xla/python/ifrt/compiler.h, third_party/xla/xla/python/ifrt/executable_serdes.cc, third_party/xla/xla/python/ifrt/executable_serdes.h, third_party/xla/xla/python/ifrt/plugin_program.h, third_party/xla/xla/python/ifrt/plugin_program_serdes.cc, third_party/xla/xla/python/ifrt/program.cc, third_party/xla/xla/python/ifrt/program.h, third_party/xla/xla/python/ifrt/program_serdes.cc, third_party/xla/xla/python/ifrt/program_serdes.h, third_party/xla/xla/python/ifrt_proxy/server/BUILD, third_party/xla/xla/python/ifrt_proxy/server/ifrt_backend.cc",hyeontaek,False
"[xla:ffi] Fix test broken by xla:ffi API changes

PiperOrigin-RevId: 623351106",Eugene Zhulenev,ezhulenev@google.com,2024-04-10 02:55:14,third_party/xla/xla/service/gpu/runtime/address_computation_thunk_test.cc,ezhulenev,False
"Passes hints between consecutive iterations of lazy memory instantiation.

PiperOrigin-RevId: 623339499",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-10 01:40:25,third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_solver.cc,tensorflower-gardener,False
"[ifrt] Change Client::GetTopologyForDevices to take a DeviceList instead of a Span of device pointers. This would enable client implementations to make use of the cached hash of the DeviceList.

PiperOrigin-RevId: 623324679",Ce Zheng,zce@google.com,2024-04-10 00:19:41,"third_party/xla/xla/python/ifrt/client.h, third_party/xla/xla/python/ifrt/mock.cc, third_party/xla/xla/python/ifrt/mock.h, third_party/xla/xla/python/ifrt_proxy/client/client.h, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.cc, third_party/xla/xla/python/pjrt_ifrt/pjrt_client.h, third_party/xla/xla/python/py_compile_only_client.cc, third_party/xla/xla/python/xla.cc",cezheng,False
"[pjrt] Switch DonateWithControlDependency to PjRtFuture<> to pass dependencies

PiperOrigin-RevId: 623324260",Eugene Zhulenev,ezhulenev@google.com,2024-04-10 00:17:32,"third_party/xla/xla/pjrt/pjrt_client.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc, third_party/xla/xla/pjrt/pjrt_stream_executor_client.h, third_party/xla/xla/pjrt/pjrt_stream_executor_client_test.cc",ezhulenev,False
"#tf-data Support global shuffling for IndexFlatMap dataset.

PiperOrigin-RevId: 623319045",Yang Chen,yangchen@google.com,2024-04-09 23:54:12,"tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc, tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py",yangustc07,False
"Remove StreamExecutorInterface::GetUnderlyingExecutor function.

PiperOrigin-RevId: 623315425",Kyle Lucke,klucke@google.com,2024-04-09 23:38:19,"third_party/xla/xla/stream_executor/stream_executor_internal.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc",klucke,False
"Adding null pointer checks.

PiperOrigin-RevId: 623312795",Gil Tabak,tabakg@google.com,2024-04-09 23:27:38,third_party/xla/xla/service/hlo_verifier.cc,,False
"Downgrade rendezvous abortion logging.

This produces a confusing warning when iterating over a `tf.data.Dataset`.

For example, see the current state of https://www.tensorflow.org/tutorials/keras/text_classification#load_the_dataset (sorry for the nonfutureproof link; I can't figure out how to link to a specific version of this tutorial that includes the output), where this warning shows up in the output of the iteration over `raw_train_ds.take(1)`.

PiperOrigin-RevId: 623300763",Matt Callanan,mpcallanan@google.com,2024-04-09 22:39:15,tensorflow/core/framework/local_rendezvous.cc,mpcallanan,False
"Avoid unnecessary HLO proto copy.

PiperOrigin-RevId: 623288553",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 21:53:55,third_party/xla/xla/hlo/ir/hlo_module.cc,tensorflower-gardener,False
"Move CUDA specific functions from asm_compiler to cuda_asm_compiler target

This avoids:
- a forward declaration of `GpuContext`
- the `:asm_compiler_header` header only target

The moved code is unchanged - I just move it from one
file to another and fix up includes and dependencies.

Note that this is adding just another `#ifdef` to the redzone allocator code. I will clean this up in a subsequent change.

PiperOrigin-RevId: 623285804",Henning Becker,hebecker@google.com,2024-04-09 21:42:46,"tensorflow/compiler/mlir/tools/kernel_gen/transforms/BUILD, tensorflow/compiler/mlir/tools/kernel_gen/transforms/gpu_kernel_to_blob_pass.cc, third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/nvptx_compiler.cc, third_party/xla/xla/service/gpu/reduction_utils.cc, third_party/xla/xla/service/gpu/tests/BUILD, third_party/xla/xla/service/gpu/tests/dynamic_shared_memory_test.cc, third_party/xla/xla/stream_executor/cuda/BUILD, third_party/xla/xla/stream_executor/cuda/cuda_asm_compiler.cc, third_party/xla/xla/stream_executor/cuda/cuda_asm_compiler.h, third_party/xla/xla/stream_executor/gpu/BUILD, third_party/xla/xla/stream_executor/gpu/asm_compiler.cc, third_party/xla/xla/stream_executor/gpu/asm_compiler.h, third_party/xla/xla/stream_executor/gpu/redzone_allocator.cc",beckerhe,False
"Reverts 6ed79e8429730c33dc894175da7a1849a8e3e57f

PiperOrigin-RevId: 623271619",Mohammed Anany,manany@google.com,2024-04-09 20:52:33,"third_party/triton/cl609333259.patch, third_party/triton/workspace.bzl, third_party/xla/third_party/triton/cl609333259.patch, third_party/xla/third_party/triton/workspace.bzl, third_party/xla/xla/service/gpu/gemm_fusion_autotuner_test.cc, third_party/xla/xla/service/gpu/ir_emitter_triton.cc, third_party/xla/xla/service/gpu/ir_emitter_triton_cuda.cc, third_party/xla/xla/service/gpu/ir_emitter_triton_parametrized_test.cc",Moerafaat,False
"Automated Code Change

PiperOrigin-RevId: 623243748",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 19:12:29,"tensorflow/core/kernels/data/get_options_op.cc, tensorflow/core/kernels/data/iterator_ops.cc, tensorflow/core/kernels/data/parallel_batch_dataset_op.cc, tensorflow/core/kernels/data/parallel_filter_dataset_op.cc, tensorflow/core/kernels/data/parallel_interleave_dataset_op.cc, tensorflow/core/kernels/data/parallel_map_dataset_op.cc, tensorflow/core/kernels/data/prefetch_dataset_op.cc, tensorflow/core/kernels/data/reduce_dataset_op.cc",tensorflower-gardener,False
"Integrate LLVM at llvm/llvm-project@1e6ce5e284f5

Updates LLVM usage to match
[1e6ce5e284f5](https://github.com/llvm/llvm-project/commit/1e6ce5e284f5)

PiperOrigin-RevId: 623219865",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 17:57:10,third_party/llvm/workspace.bzl,tensorflower-gardener,False
"Use DenseElements to serialize/deserialize dense arrays

This avoids asan issues, makes the code a lot cleaner, and avoids depending on implementation details of how the data is laid out.

PiperOrigin-RevId: 623218059",Michael Levesque-Dion,mlevesquedion@google.com,2024-04-09 17:52:13,"third_party/stablehlo/temporary.patch, third_party/xla/third_party/stablehlo/temporary.patch",mlevesquedion,False
"[XLA] don't optimize bitcast(broadcast) if the bitcast does not have teh same
input and output types.

PiperOrigin-RevId: 623217964",Blake Hechtman,blakehechtman@google.com,2024-04-09 17:51:56,third_party/xla/xla/service/algebraic_simplifier.cc,blakehechtman,False
"Move `tsl/BUILD`, `tsl.bzl`, and `tsl.default.bzl` to XLA

PiperOrigin-RevId: 623215553",David Dunleavy,ddunleavy@google.com,2024-04-09 17:44:27,"tensorflow/BUILD, tensorflow/compiler/mlir/stablehlo/BUILD, tensorflow/core/data/service/snapshot/BUILD, tensorflow/core/platform/build_config.default.bzl, tensorflow/core/platform/build_config_root.default.bzl, tensorflow/core/platform/cloud/BUILD, tensorflow/tensorflow.bzl, tensorflow/tools/lib_package/BUILD, tensorflow/tools/pip_package/BUILD, third_party/curl.BUILD, third_party/gloo/gloo.BUILD, third_party/hwloc/hwloc.BUILD, third_party/llvm_openmp/BUILD, third_party/llvm_openmp/openmp.bzl, third_party/mkl_dnn/mkldnn_v1.BUILD, third_party/nccl/build_defs.bzl.tpl, third_party/png.BUILD, third_party/snappy.BUILD, third_party/sqlite.BUILD, third_party/vulkan_headers/vulkan_headers.BUILD, third_party/xla/third_party/gloo/gloo.BUILD, third_party/xla/third_party/llvm_openmp/BUILD, third_party/xla/third_party/llvm_openmp/openmp.bzl, third_party/xla/third_party/tsl/third_party/curl.BUILD, third_party/xla/third_party/tsl/third_party/hwloc/hwloc.BUILD, third_party/xla/third_party/tsl/third_party/llvm_openmp/BUILD, third_party/xla/third_party/tsl/third_party/llvm_openmp/openmp.bzl, third_party/xla/third_party/tsl/third_party/mkl_dnn/mkldnn_v1.BUILD, third_party/xla/third_party/tsl/third_party/nccl/build_defs.bzl.tpl, third_party/xla/third_party/tsl/third_party/snappy.BUILD, third_party/xla/third_party/tsl/third_party/zlib.BUILD, third_party/xla/third_party/tsl/tsl/concurrency/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/coordination/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/preemption/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/rpc/BUILD, third_party/xla/third_party/tsl/tsl/distributed_runtime/rpc/coordination/BUILD, third_party/xla/third_party/tsl/tsl/framework/BUILD, third_party/xla/third_party/tsl/tsl/framework/contraction/BUILD, third_party/xla/third_party/tsl/tsl/framework/convolution/BUILD, third_party/xla/third_party/tsl/tsl/framework/fixedpoint/BUILD, third_party/xla/third_party/tsl/tsl/lib/core/BUILD, third_party/xla/third_party/tsl/tsl/lib/gtl/BUILD, third_party/xla/third_party/tsl/tsl/lib/gtl/subtle/BUILD, third_party/xla/third_party/tsl/tsl/lib/hash/BUILD, third_party/xla/third_party/tsl/tsl/lib/histogram/BUILD, third_party/xla/third_party/tsl/tsl/lib/io/BUILD, third_party/xla/third_party/tsl/tsl/lib/io/snappy/BUILD, third_party/xla/third_party/tsl/tsl/lib/math/BUILD, third_party/xla/third_party/tsl/tsl/lib/monitoring/BUILD, third_party/xla/third_party/tsl/tsl/lib/random/BUILD, third_party/xla/third_party/tsl/tsl/lib/strings/BUILD, third_party/xla/third_party/tsl/tsl/platform/BUILD, third_party/xla/third_party/tsl/tsl/platform/cloud/BUILD, third_party/xla/third_party/tsl/tsl/platform/cloud/testdata/BUILD, third_party/xla/third_party/tsl/tsl/platform/default/BUILD, third_party/xla/third_party/tsl/tsl/platform/default/build_config.bzl, third_party/xla/third_party/tsl/tsl/platform/default/build_config_root.bzl, third_party/xla/third_party/tsl/tsl/platform/profile_utils/BUILD, third_party/xla/third_party/tsl/tsl/platform/windows/BUILD, third_party/xla/third_party/tsl/tsl/profiler/backends/cpu/BUILD, third_party/xla/third_party/tsl/tsl/profiler/builds/BUILD, third_party/xla/third_party/tsl/tsl/profiler/builds/build_config.bzl, third_party/xla/third_party/tsl/tsl/profiler/builds/oss/build_config.bzl, third_party/xla/third_party/tsl/tsl/profiler/convert/BUILD, third_party/xla/third_party/tsl/tsl/profiler/lib/BUILD, third_party/xla/third_party/tsl/tsl/profiler/protobuf/BUILD, third_party/xla/third_party/tsl/tsl/profiler/rpc/BUILD, third_party/xla/third_party/tsl/tsl/profiler/rpc/client/BUILD, third_party/xla/third_party/tsl/tsl/profiler/utils/BUILD, third_party/xla/third_party/tsl/tsl/protobuf/BUILD, third_party/xla/xla/BUILD, third_party/xla/xla/backends/profiler/BUILD, third_party/xla/xla/backends/profiler/cpu/BUILD, third_party/xla/xla/backends/profiler/gpu/BUILD, third_party/xla/xla/backends/profiler/tpu/BUILD, third_party/xla/xla/c/BUILD, third_party/xla/xla/client/BUILD, third_party/xla/xla/client/lib/BUILD, third_party/xla/xla/ffi/api/BUILD, third_party/xla/xla/hlo/experimental/auto_sharding/BUILD, third_party/xla/xla/hlo/ir/BUILD, third_party/xla/xla/mlir/backends/cpu/transforms/BUILD, third_party/xla/xla/mlir/framework/ir/BUILD, third_party/xla/xla/mlir/framework/transforms/BUILD, third_party/xla/xla/mlir/memref/transforms/BUILD, third_party/xla/xla/mlir/runtime/ir/BUILD, third_party/xla/xla/mlir/runtime/transforms/BUILD, third_party/xla/xla/mlir/runtime/utils/BUILD, third_party/xla/xla/mlir/utils/BUILD, third_party/xla/xla/mlir/xla_cpu/ir/BUILD, third_party/xla/xla/mlir_hlo/BUILD, third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/cpu/BUILD, third_party/xla/xla/pjrt/distributed/BUILD, third_party/xla/xla/pjrt/gpu/BUILD, third_party/xla/xla/python/BUILD, third_party/xla/xla/python/ifrt/BUILD, third_party/xla/xla/python/ifrt/ir/BUILD, third_party/xla/xla/python/ifrt/ir/transforms/BUILD, third_party/xla/xla/python/ifrt/ir/transforms/spmd_expanders/BUILD, third_party/xla/xla/python/ifrt_proxy/client/BUILD, third_party/xla/xla/python/ifrt_proxy/common/BUILD, third_party/xla/xla/python/pjrt_ifrt/BUILD, third_party/xla/xla/python/profiler/internal/BUILD, third_party/xla/xla/python/tools/BUILD, third_party/xla/xla/runtime/BUILD, third_party/xla/xla/runtime/default/BUILD, third_party/xla/xla/runtime/ffi/BUILD, third_party/xla/xla/service/BUILD, third_party/xla/xla/service/cpu/BUILD, third_party/xla/xla/service/cpu/build_defs.bzl, third_party/xla/xla/service/cpu/tests/BUILD, third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/llvm_gpu_backend/BUILD, third_party/xla/xla/service/gpu/model/BUILD, third_party/xla/xla/service/gpu/runtime/BUILD, third_party/xla/xla/service/gpu/tests/BUILD, third_party/xla/xla/service/graphcycles/BUILD, third_party/xla/xla/service/llvm_ir/BUILD, third_party/xla/xla/service/memory_space_assignment/BUILD, third_party/xla/xla/stream_executor/BUILD, third_party/xla/xla/stream_executor/cuda/BUILD, third_party/xla/xla/stream_executor/gpu/BUILD, third_party/xla/xla/stream_executor/host/BUILD, third_party/xla/xla/stream_executor/integrations/BUILD, third_party/xla/xla/stream_executor/platform/BUILD, third_party/xla/xla/stream_executor/platform/default/BUILD, third_party/xla/xla/stream_executor/rocm/BUILD, third_party/xla/xla/stream_executor/tpu/BUILD, third_party/xla/xla/tests/BUILD, third_party/xla/xla/tools/BUILD, third_party/xla/xla/tools/hlo_opt/BUILD, third_party/xla/xla/tools/multihost_hlo_runner/BUILD, third_party/xla/xla/translate/BUILD, third_party/xla/xla/translate/hlo_to_mhlo/BUILD, third_party/xla/xla/translate/mhlo_to_hlo/BUILD, third_party/xla/xla/translate/mhlo_to_hlo/tests/BUILD, third_party/xla/xla/tsl/BUILD, third_party/xla/xla/tsl/c/BUILD, third_party/xla/xla/tsl/cuda/BUILD.bazel, third_party/xla/xla/tsl/cuda/stub.bzl, third_party/xla/xla/tsl/mkl/BUILD, third_party/xla/xla/tsl/mkl/build_defs.bzl, third_party/xla/xla/tsl/tsl.bzl, third_party/xla/xla/tsl/tsl.default.bzl, third_party/xla/xla/tsl/util/BUILD, third_party/xla/xla/xla.bzl, third_party/zlib.BUILD",ddunl,False
"Make StreamExecutor::SynchronousMemcpy return an absl::Status rather than a bool.

PiperOrigin-RevId: 623214889",Kyle Lucke,klucke@google.com,2024-04-09 17:42:24,"tensorflow/c/experimental/stream_executor/stream_executor_test.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"[xla:ffi] Add XLA_FFI_Api access to C API header

PiperOrigin-RevId: 623212831",Eugene Zhulenev,ezhulenev@google.com,2024-04-09 17:35:38,"third_party/xla/xla/ffi/api/c_api.h, third_party/xla/xla/ffi/api/ffi.h, third_party/xla/xla/ffi/call_frame.cc, third_party/xla/xla/ffi/call_frame.h, third_party/xla/xla/ffi/ffi.h, third_party/xla/xla/ffi/ffi_api.cc, third_party/xla/xla/ffi/ffi_api.h",ezhulenev,False
"Make most StreamExecutor functions complete pass-throughs to the StreamExecutorInterface in preparation for having it inherit from the Interface class.

PiperOrigin-RevId: 623211916",Kyle Lucke,klucke@google.com,2024-04-09 17:33:07,third_party/xla/xla/stream_executor/stream_executor_pimpl.cc,klucke,False
"Remove deprecated usePropertiesForAttributes.

PiperOrigin-RevId: 623198562",Ionel Gog,icgog@google.com,2024-04-09 16:54:17,"third_party/xla/xla/python/ifrt/ir/ifrt_dialect.td, third_party/xla/xla/python/ifrt/ir/tests/verify_call.mlir, third_party/xla/xla/python/ifrt/ir/tests/verify_call_loaded_executable.mlir",ICGog,False
"Automated Code Change

PiperOrigin-RevId: 623193554",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 16:35:23,"tensorflow/core/kernels/data/experimental/map_and_batch_dataset_op.cc, tensorflow/core/kernels/data/experimental/parallel_interleave_dataset_op.cc, tensorflow/core/kernels/data/experimental/parse_example_dataset_op.cc, tensorflow/core/kernels/data/experimental/snapshot_dataset_op.cc",tensorflower-gardener,False
"[pjrt] Add PjRtFuture<void> specialization for stateless futures

PjRtFuture<void> (or PjRtFuture<>) is an implicit wrapper for absl::Status that will become available at some point in the future and will signal completion of an async event.

PiperOrigin-RevId: 623185064",Eugene Zhulenev,ezhulenev@google.com,2024-04-09 16:06:09,"third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/pjrt_future.h, third_party/xla/xla/pjrt/pjrt_future_test.cc",ezhulenev,False
"Eliminate StreamExecutor::live_stream_count_ as StreamExecutors are never destroyed, and the destructor is never run.

PiperOrigin-RevId: 623182306",Kyle Lucke,klucke@google.com,2024-04-09 15:57:04,"third_party/xla/xla/stream_executor/BUILD, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc, third_party/xla/xla/stream_executor/stream_executor_pimpl.h",klucke,False
"When generating strategies for slice ops, consider reversed mesh shapes as well when obtaining the tensor to mesh dim mapping for slice operand strategies.

PiperOrigin-RevId: 623182045",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 15:55:45,"third_party/xla/xla/hlo/experimental/auto_sharding/BUILD, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_util.cc, third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_util.h",tensorflower-gardener,False
"PR #11205: [ROCm] Fix link failure for rocm targets

Imported from GitHub PR https://github.com/openxla/xla/pull/11205

Copybara import of the project:

--
91df7b60a4aac6da70165948a39805d0d3921067 by Harsha HS <harsha.havanurshamsundara@amd.com>:

[ROCm] Fix build break due to 4c8a74bb5

--
85cd084e52340cc2069ab5c4c57c210e466846a1 by Harsha HS <harsha.havanurshamsundara@amd.com>:

[ROCm] Fix link failure for rocm targets

--
8ee9b5e90d4e1a3ca7734bbe1ef73140e4d879dd by Harsha H S <hsharsha@users.noreply.github.com>:

Update xla/stream_executor/gpu/gpu_timer.cc with review comment

Co-authored-by: Penporn Koanantakool <38085909+penpornk@users.noreply.github.com>

Merging this change closes #11205

PiperOrigin-RevId: 623171848",Harsha H S,hsharsha@users.noreply.github.com,2024-04-09 15:14:36,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/stream_executor/BUILD, third_party/xla/xla/stream_executor/gpu/gpu_timer.cc, third_party/xla/xla/stream_executor/rocm/BUILD, third_party/xla/xla/stream_executor/rocm/rocm_dnn.cc",hsharsha,False
"Add support for binary ops in RTVar optimization

So far we were able to fold HLO graphs composed of
constants and unary ops without compute.

This change adds support for basic binary ops like:
- Add
- Multiply
- Subtract
- Divide

PiperOrigin-RevId: 623136776",Henning Becker,hebecker@google.com,2024-04-09 12:31:54,"third_party/xla/xla/service/gpu/model/BUILD, third_party/xla/xla/service/gpu/model/indexing_map.cc, third_party/xla/xla/service/gpu/model/indexing_map_test.cc",beckerhe,False
"Automated Code Change

PiperOrigin-RevId: 623135485",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 12:26:28,"tensorflow/core/distributed_runtime/rpc/grpc_master_service.cc, tensorflow/core/distributed_runtime/rpc/grpc_remote_master.cc, tensorflow/core/distributed_runtime/rpc/grpc_worker_service.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623119862",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 11:06:15,"tensorflow/core/kernels/padding_fifo_queue.cc, tensorflow/core/kernels/padding_fifo_queue.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623116061",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 10:48:21,"tensorflow/core/profiler/lib/profiler_disabled_test.cc, tensorflow/core/profiler/lib/profiler_factory.h",tensorflower-gardener,False
"[xla:ffi] Improve error messages in custom call tests

Improve error messages in typed FFI custom call tests: print error message along with error code.
Implements #10060.

PiperOrigin-RevId: 623114833",Adam Banaś,adambanas@google.com,2024-04-09 10:40:52,third_party/xla/xla/tests/custom_call_test.cc,Adam-Banas,False
"Support arbitrary indexing for epilogue tuple elements.

The roots of a tuple can all have different indexing, something
that wasn't considered in the original design. I'm not happy
with the implementation, but it's the best I could come up with
before we switch to tensor lowerings.

PiperOrigin-RevId: 623110421",Johannes Reifferscheid,jreiffers@google.com,2024-04-09 10:19:49,"third_party/xla/xla/service/gpu/fusions/BUILD, third_party/xla/xla/service/gpu/fusions/concatenate_mlir.cc, third_party/xla/xla/service/gpu/fusions/concatenate_mlir.h, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir.cc, third_party/xla/xla/service/gpu/fusions/in_place_dynamic_update_slice_mlir.h, third_party/xla/xla/service/gpu/fusions/mlir/BUILD, third_party/xla/xla/service/gpu/fusions/mlir/computation_partitioner.cc, third_party/xla/xla/service/gpu/fusions/mlir/computation_partitioner.h, third_party/xla/xla/service/gpu/fusions/mlir/computation_partitioner_test.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir.cc, third_party/xla/xla/service/gpu/fusions/mlir/elemental_hlo_to_mlir_test.cc, third_party/xla/xla/service/gpu/fusions/mlir/mlir_fusion_emitter.cc, third_party/xla/xla/service/gpu/fusions/mlir/mlir_fusion_emitter.h, third_party/xla/xla/service/gpu/fusions/reduction_base.cc, third_party/xla/xla/service/gpu/fusions/reduction_base_test.cc, third_party/xla/xla/service/gpu/fusions/reduction_mlir.cc, third_party/xla/xla/service/gpu/fusions/reduction_mlir.h, third_party/xla/xla/service/gpu/fusions/scatter_mlir.cc, third_party/xla/xla/service/gpu/fusions/scatter_mlir.h, third_party/xla/xla/service/gpu/fusions/transpose_mlir.cc, third_party/xla/xla/service/gpu/fusions/transpose_mlir.h, third_party/xla/xla/service/gpu/model/indexing_analysis.cc",jreiffers,False
"PR #10485: [XLA:CPU][oneDNN] Scratchpad support to MatMul

Imported from GitHub PR https://github.com/openxla/xla/pull/10485

This PR enables user provided scratch memory to MatMul. It utilizes buffer assigner to allocate scratch buffers. The following is the HLO rewrites.

```
Input HLO:
result = result_shape custom-call(args), custom_call_target=""__onednn$matmul"", ...

Output HLO:
tuple = (result_shape, scratch_shape) custom-call(args), custom_call_target=""__onednn$matmul"", ...
result_from_tuple = result_shape get-tuple-element(tuple), index=0
```

Besides enabling scratch memory, this PR refactors the MatMul rewrites and kernel implementation in order to reuse common code. It also introduces the following template function so that similar features can be easily used for other oneDNN primitives.

```
template <typename PrimDesc>
std::unique_ptr<PrimDesc> CreateOneDnnPrimDesc(HloInstruction*);
```
Copybara import of the project:

--
830ace45111c7fa9d7b03ec2018e6c51d0052e81 by mdfaijul <md.faijul.amin@intel.com>:

Scratch support to matmul

--
a6e652633d7fc8eb65b76d1e18c18bd0629e7f47 by mdfaijul <md.faijul.amin@intel.com>:

Address review comments.

--
d6cb1f2e9618c6874dd28af13ba43c11bc7071b5 by mdfaijul <md.faijul.amin@intel.com>:

Use TF_ASSIGN_OR_RETURN

Merging this change closes #10485

PiperOrigin-RevId: 623103800",Faijul Amin,md.faijul.amin@intel.com,2024-04-09 09:47:08,"third_party/xla/xla/service/cpu/BUILD, third_party/xla/xla/service/cpu/backend_config.proto, third_party/xla/xla/service/cpu/ir_emitter.cc, third_party/xla/xla/service/cpu/onednn_matmul.cc, third_party/xla/xla/service/cpu/onednn_matmul.h, third_party/xla/xla/service/cpu/onednn_matmul_rewriter.cc, third_party/xla/xla/service/cpu/onednn_memory_util.cc, third_party/xla/xla/service/cpu/onednn_memory_util.h, third_party/xla/xla/service/cpu/onednn_util.cc, third_party/xla/xla/service/cpu/onednn_util.h, third_party/xla/xla/tests/onednn_matmul_test.cc",mdfaijul,False
"[XLA:GPU] Compute a graph of TiledHloInstruction for given tile parameters.

Use TiledHloInstructions in the Triton emitter.

PiperOrigin-RevId: 623103735",Oleg Shyshkov,shyshkov@google.com,2024-04-09 09:46:45,"third_party/xla/xla/service/gpu/BUILD, third_party/xla/xla/service/gpu/ir_emitter_triton.cc, third_party/xla/xla/service/gpu/model/BUILD, third_party/xla/xla/service/gpu/model/symbolic_tile_analysis.cc, third_party/xla/xla/service/gpu/model/symbolic_tile_analysis.h, third_party/xla/xla/service/gpu/model/symbolic_tile_analysis_test.cc",olegshyshkov,False
"Automated Code Change

PiperOrigin-RevId: 623100829",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 09:32:50,"tensorflow/core/profiler/lib/context_types.h, tensorflow/core/profiler/lib/traceme_encode.h",tensorflower-gardener,False
"PR #10164: [XLA:CPU] Improve Trace emitter

Imported from GitHub PR https://github.com/openxla/xla/pull/10164

This PR improves tracing a bit.

Without this PR, you would see operations in trace view as :
![image](https://github.com/openxla/xla/assets/43043975/f5ae19c9-851d-44fe-bf75-9a456425a387)

This way , it s difficult to see a) target of custom call b) can't group operations based on type of hlo operation and hence makes op list huge

This PR addresses these problems and now you should see tensorboard trace view as :
![image](https://github.com/openxla/xla/assets/43043975/5a10b3ef-ea61-4ac5-90e3-92ead1354aa4)

Copybara import of the project:

--
8cd6363890107ce7af2ed3630d577ad4d20a745b by Sachin Muradi <sachin.muradi@intel.com>:

Update Trace emitter

--
a2813ad7439da8934b98b12623193c3b120eb9ca by Sachin Muradi <sachin.muradi@intel.com>:

more update

Merging this change closes #10164

PiperOrigin-RevId: 623095394",sachinmuradi,sachin.muradi@intel.com,2024-04-09 09:08:16,"third_party/xla/xla/service/cpu/cpu_runtime.cc, third_party/xla/xla/service/cpu/cpu_runtime.h, third_party/xla/xla/service/cpu/ir_emitter.cc",sachinmuradi,False
"compat: Update forward compatibility horizon to 2024-04-09

PiperOrigin-RevId: 623094138",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 09:03:41,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Update GraphDef version to 1827.

PiperOrigin-RevId: 623093561",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 09:02:12,tensorflow/core/public/version.h,tensorflower-gardener,False
"Check the number of bias elements matches the number of output channels instead of the number of dims.

Remove unnecessary input shape checks.

PiperOrigin-RevId: 623086589",Alan Kelly,alankelly@google.com,2024-04-09 08:29:03,tensorflow/lite/delegates/xnnpack/xnnpack_delegate.cc,alankelly,False
"Integrate LLVM at llvm/llvm-project@ed4e505c219f

Updates LLVM usage to match
[ed4e505c219f](https://github.com/llvm/llvm-project/commit/ed4e505c219f)

PiperOrigin-RevId: 623075563",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 07:32:48,third_party/llvm/workspace.bzl,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623075098",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 07:30:32,"tensorflow/core/profiler/convert/op_metrics_to_record.h, tensorflow/core/profiler/convert/op_profile_builder.cc, tensorflow/core/profiler/convert/op_stats_to_input_pipeline_analysis.cc, tensorflow/core/profiler/convert/op_stats_to_op_profile.cc",tensorflower-gardener,False
"[XLA:GPU][IndexAnalysis] Get rid of LaTeX in indexing.md.

It is rendered differently in github.com, openxla.org.

PiperOrigin-RevId: 623074456",Alexander Belyaev,pifon@google.com,2024-04-09 07:26:36,"third_party/xla/docs/_toc.yaml, third_party/xla/docs/indexing.md",pifon2a,False
"Add proper `QuantizationSpec` for `WeightOnlyPtq`.

References to `*Preset` should be eliminated after `ExpandPresets`.
Apply proper `QuantizationSpec` changes to carry all information necessary for quantization passes.

Follow-up changes will include the following:
- Removal of `StaticRangePtqPreset` usage in quantization passes
- Removal of preset flag usages in pipeline and quantization passes
- Moving `stablehlo_op_quant_spec` to the beginning of the pipeline, so that individual op quantization spec information can be used to create proper `QuantizationMethod` per target quantizable block.

PiperOrigin-RevId: 623063394",Jiyoun (Jen) Ha,jiyounha@google.com,2024-04-09 06:25:38,"tensorflow/compiler/mlir/lite/quantization/stablehlo/quantization.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/config.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/config.h, tensorflow/compiler/mlir/quantization/stablehlo/cc/config_test.cc, tensorflow/compiler/mlir/quantization/stablehlo/python/quantization.py, tensorflow/compiler/mlir/quantization/stablehlo/quantization_config.proto",chococigar,False
"Use signature_name as the function name for the entry function for an inference function

This makes the debugging info more informative in TFRT serving.

PiperOrigin-RevId: 623059360",Kuangyuan Chen,chky@google.com,2024-04-09 06:01:01,"tensorflow/core/tfrt/graph_executor/graph_execution_options.h, tensorflow/core/tfrt/graph_executor/graph_executor.cc, tensorflow/core/tfrt/graph_executor/graph_executor.h, tensorflow/core/tfrt/saved_model/saved_model.cc, tensorflow/core/tfrt/saved_model/tests/saved_model_test.cc",cky9301,False
"Automated Code Change

PiperOrigin-RevId: 623059247",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 06:00:22,tensorflow/core/common_runtime/hierarchical_tree_broadcaster.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623058653",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 05:56:54,tensorflow/c/experimental/gradients/nn_grad.cc,tensorflower-gardener,False
"Capture exceptions raised from `PyFunctionLibrary` functions for debuggability.

Before this change, when there is an error raised inside a `PyFunctionLibrary` method, the program would crash with a long stack trace, something like the following:

```
<super-long c++ stack trace with no meaningful information>

libc++abi: terminating due to uncaught exception of type pybind11::error_already_set: ValueError: Failed to run graph for post-training quantization calibration.
```

The information in the raised exception is lost in this case, hindering debuggability.

This change instead returns regular value `None` back to the c++ layer to indicate error, and prints the exception chain from the python side.
It prints out the exact error message one would see when an exception is raised from regular python script.

The return values of `PyFunctionLibrary` methods are all changed to `std::optional<T>`, where `T` is the successful return value and `std::nullopt` indicates error.
To avoid conflict btw erroneous `None`, methods that do not essentially return a value now returns a dummy `True` to indicate successful run.

PiperOrigin-RevId: 623055737",Dan Suh,dansuh@google.com,2024-04-09 05:37:54,"tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/component.cc, tensorflow/compiler/mlir/quantization/stablehlo/cc/calibration/statistics.cc, tensorflow/compiler/mlir/quantization/tensorflow/python/BUILD, tensorflow/compiler/mlir/quantization/tensorflow/python/py_function_lib.h, tensorflow/compiler/mlir/quantization/tensorflow/python/py_function_lib.py, tensorflow/compiler/mlir/quantization/tensorflow/python/pywrap_function_lib.cc, tensorflow/compiler/mlir/quantization/tensorflow/python/pywrap_function_lib.pyi, tensorflow/compiler/mlir/quantization/tensorflow/python/pywrap_quantize_model.cc, tensorflow/compiler/mlir/quantization/tensorflow/python/quantize_model.cc",dansuh17,False
"Automated Code Change

PiperOrigin-RevId: 623055609",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 05:37:01,"tensorflow/core/distributed_runtime/BUILD, tensorflow/core/distributed_runtime/graph_mgr.cc, tensorflow/core/distributed_runtime/graph_mgr.h",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623054480",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 05:30:35,"tensorflow/core/profiler/convert/xplane_to_op_metrics_db_test.cc, tensorflow/core/profiler/convert/xplane_to_op_stats.cc, tensorflow/core/profiler/convert/xplane_to_step_stats.cc, tensorflow/core/profiler/convert/xplane_to_tf_functions.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623054315",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 05:29:20,tensorflow/compiler/mlir/tf2xla/api/v2/legalize_tf.cc,tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623054232",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 05:28:41,"tensorflow/core/profiler/utils/derived_timeline.cc, tensorflow/core/profiler/utils/hlo_module_map.cc, tensorflow/core/profiler/utils/op_metrics_db_utils.cc",tensorflower-gardener,False
"Automated Code Change

PiperOrigin-RevId: 623053994",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-09 05:26:52,third_party/xla/xla/execution_options_util.cc,tensorflower-gardener,False
"Internal package group change

PiperOrigin-RevId: 623031512",Chen-hao Chang,haocc@google.com,2024-04-09 03:21:02,tensorflow/BUILD,cchao,False
"Add unbounded dynamism test for DynamicSliceOp.

PiperOrigin-RevId: 623015159",Gunhyun Park,gunhyun@google.com,2024-04-09 02:01:36,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add unbounded dynamism test for SortOp.

PiperOrigin-RevId: 623013151",Gunhyun Park,gunhyun@google.com,2024-04-09 01:50:19,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add unbounded dynamism test for ReverseOp.

PiperOrigin-RevId: 623011436",Gunhyun Park,gunhyun@google.com,2024-04-09 01:40:09,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add unbounded dynamism test for TriangularSolveOp.

PiperOrigin-RevId: 623009470",Gunhyun Park,gunhyun@google.com,2024-04-09 01:30:19,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Reverts 6e7fa49a4c1b73c4634965ec8eae45e94ba66387

PiperOrigin-RevId: 623002758",David Dunleavy,ddunleavy@google.com,2024-04-09 00:56:45,third_party/xla/.github/workflows/buildifier.yml,ddunl,False
"Enforce that CLs satisfy openxla/xla's buildifier checks

PiperOrigin-RevId: 622987817",David Dunleavy,ddunleavy@google.com,2024-04-08 23:49:04,third_party/xla/.github/workflows/buildifier.yml,ddunl,False
"#tf-data copies is_legacy_prefetch_autotuned_ when snapshotting

PiperOrigin-RevId: 622972360",Jim Lin,jimlintw@google.com,2024-04-08 22:43:28,"tensorflow/core/framework/model.cc, tensorflow/core/framework/model_test.cc",jimlinntu,False
"[tsl:concurrency] Specify Isa/DynCast/Cast semantics for indirect async values

PiperOrigin-RevId: 622971220",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 22:38:56,"third_party/xla/third_party/tsl/tsl/concurrency/async_value_ptr_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc",ezhulenev,False
"Update ops-related pbtxt files.

PiperOrigin-RevId: 622965583",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 22:17:43,"tensorflow/core/ops/compat/ops_history_v2/IndexFlatMapDataset.pbtxt, tensorflow/core/ops/ops.pbtxt",tensorflower-gardener,False
"Move StreamImplementation creation into Stream::Initialize, and eliminate bool allocated_ member that's now unnecessary.

PiperOrigin-RevId: 622964979",Kyle Lucke,klucke@google.com,2024-04-08 22:14:56,"third_party/xla/xla/stream_executor/stream.cc, third_party/xla/xla/stream_executor/stream.h, third_party/xla/xla/stream_executor/stream_test.cc",klucke,False
"Add unbounded dynamism test for RngBitGeneratorOp.

PiperOrigin-RevId: 622958040",Gunhyun Park,gunhyun@google.com,2024-04-08 21:48:17,third_party/xla/xla/client/xla_builder_test.cc,ghpvnist,False
"Remove Stream::SetPriority functions from Stream.

They don't work after the stream is initialized in GpuStream (the only Stream implementation to make use of the priority).  Instead, move the parameter to Stream::Initialize, which is the only place it's actually used.

PiperOrigin-RevId: 622958008",Kyle Lucke,klucke@google.com,2024-04-08 21:48:09,"third_party/xla/xla/stream_executor/stream.cc, third_party/xla/xla/stream_executor/stream.h, third_party/xla/xla/stream_executor/stream_executor_pimpl.cc",klucke,False
"Add unbounded dynamism tests for RngNormalOp and RngUniformOp.

PiperOrigin-RevId: 622953342",Gunhyun Park,gunhyun@google.com,2024-04-08 21:30:30,third_party/xla/xla/client/xla_builder_test.cc,ghpvnist,False
"#tf-data Implement index_flat_map dataset.

This is similar to flat_map, but supports global shuffling.

In addition to a `map_func`, the user needs to provide an `index_map_fn`.
Given an index in the flattened dataset, the `index_map_fn` returns a
(element index, offset) tuple that represents the index of the element in the
unflattened dataset, and the offset in the unflattened element.

PiperOrigin-RevId: 622952111",Yang Chen,yangchen@google.com,2024-04-08 21:25:37,"tensorflow/core/api_def/base_api/api_def_IndexFlatMapDataset.pbtxt, tensorflow/core/kernels/data/experimental/BUILD, tensorflow/core/kernels/data/experimental/index_flat_map_dataset_op.cc, tensorflow/core/ops/experimental_dataset_ops.cc, tensorflow/python/data/experimental/kernel_tests/BUILD, tensorflow/python/data/experimental/kernel_tests/index_flat_map_test.py, tensorflow/python/data/experimental/ops/BUILD, tensorflow/python/data/experimental/ops/index_flat_map_op.py, tensorflow/tools/api/golden/v1/tensorflow.raw_ops.pbtxt, tensorflow/tools/api/golden/v2/tensorflow.raw_ops.pbtxt",yangustc07,False
"Add the composite lowering pass for aten.avg_pool2d

PiperOrigin-RevId: 622951871",Majid Dadashi,majiddadashi@google.com,2024-04-08 21:24:43,"tensorflow/compiler/mlir/lite/stablehlo/BUILD, tensorflow/compiler/mlir/lite/stablehlo/tests/composite-lowering.mlir, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool.h, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_avg_pool_patterns.td, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_lowering_pass.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_lowering_patterns.td, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.h, tensorflow/compiler/mlir/lite/stablehlo/transforms/composite_utils.td, tensorflow/compiler/mlir/lite/transforms/legalize_tf.cc",majiddadashi,False
"HloTopKInstruction doesn't inherit from HloDimensionsInstruction,
HloDimensionsInstruction::ClassOf should return false for kTopK.

PiperOrigin-RevId: 622950232",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 21:19:27,third_party/xla/xla/hlo/ir/hlo_instructions.h,tensorflower-gardener,False
"Reverts e664ade8a0063f2800f27df3e4c96358e376c5cf

PiperOrigin-RevId: 622949627",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 21:17:27,"tensorflow/lite/delegates/gpu/cl/BUILD, tensorflow/lite/delegates/gpu/cl/opencl_wrapper.cc",tensorflower-gardener,False
"Customize Reserved GPU HBM Size by flag in Pathways.

PiperOrigin-RevId: 622947937",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 21:11:35,"third_party/xla/xla/pjrt/gpu/gpu_helpers.cc, third_party/xla/xla/pjrt/gpu/gpu_helpers.h, third_party/xla/xla/pjrt/gpu/se_gpu_pjrt_client.cc",tensorflower-gardener,False
"Add unbounded dynamism test for CholeskyOp.

PiperOrigin-RevId: 622946035",Gunhyun Park,gunhyun@google.com,2024-04-08 21:04:56,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add the mixed_priority_policy attr to the fallback kernel and make the fallback kernel pass the policy and low priority params to the batch resource.

PiperOrigin-RevId: 622943741",Eunjae Kim,eunjaekim@google.com,2024-04-08 20:56:52,"tensorflow/core/kernels/batching_util/batch_resource_base.h, tensorflow/core/runtime_fallback/runtime/BUILD, tensorflow/core/runtime_fallback/runtime/fallback_batch_kernel.cc, tensorflow/core/runtime_fallback/runtime/fallback_batch_kernel.h, tensorflow/core/runtime_fallback/runtime/runtime_fallback_batch_tf_opkernels.cc, tensorflow/core/tfrt/mlrt/kernel/BUILD, tensorflow/core/tfrt/mlrt/kernel/batch_kernel.cc, tensorflow/core/tfrt/mlrt/kernel/kernel_test.cc",eunjaekim-0,False
"Remove usages of bridge fallback.

PiperOrigin-RevId: 622941324",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 20:47:59,tensorflow/core/tfrt/tfrt_session/tfrt_session.cc,tensorflower-gardener,False
"Add metadata matcher for unit testing.
This can be used to test if metadata is being propagated properly in hlo pass unit tests.

PiperOrigin-RevId: 622941318",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 20:47:58,"third_party/xla/xla/hlo/utils/BUILD, third_party/xla/xla/hlo/utils/hlo_matchers.cc, third_party/xla/xla/hlo/utils/hlo_matchers.h, third_party/xla/xla/hlo/utils/hlo_matchers_test.cc",tensorflower-gardener,False
"[tsl:concurrency] NFC: Fix warnings in tsl/concurrency folder

PiperOrigin-RevId: 622940632",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 20:45:21,"third_party/xla/third_party/tsl/tsl/concurrency/BUILD, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_test.cc",ezhulenev,False
"[tsl:concurrency] Specify casting rules for ErrorAsyncValue

PiperOrigin-RevId: 622938308",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 20:36:46,"third_party/xla/third_party/tsl/tsl/concurrency/async_value_ptr_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc",ezhulenev,False
"[tsl:concurrency] NFC: Add tests for various types of AndThen callbacks to AsyncValuePtr and AsyncValueRef

PiperOrigin-RevId: 622932737",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 20:16:22,"third_party/xla/third_party/tsl/tsl/concurrency/BUILD, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ptr_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc",ezhulenev,False
"[tsl:concurrency] NFC: Use port::Aligned(Malloc|Free) instead of custom ones

PiperOrigin-RevId: 622929778",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 20:05:06,"third_party/xla/third_party/tsl/tsl/concurrency/BUILD, third_party/xla/third_party/tsl/tsl/concurrency/async_value.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.h",ezhulenev,False
"Fix HLO cost analysis for simple nested fusions.

PiperOrigin-RevId: 622923960",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 19:40:09,"third_party/xla/xla/service/hlo_cost_analysis.cc, third_party/xla/xla/service/hlo_cost_analysis_test.cc",tensorflower-gardener,False
"Add e2e tests for TF models with function alias.

In addition to tf.StatefulPartitionedCall, some aliased functions are lowered as tf.PartitionedCall. We preserve (Stateful)ParittionedCall ops to preserve aliases. This CL completes the handling of such cases and added some test cases.

PiperOrigin-RevId: 622922064",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 19:33:21,"tensorflow/compiler/mlir/lite/stablehlo/tests/legalize-skip-partitioned-calls.mlir, tensorflow/compiler/mlir/lite/stablehlo/tests/legalize-skip-stateful-partition-calls.mlir, tensorflow/compiler/mlir/lite/stablehlo/transforms/tf_stablehlo_pass.cc, tensorflow/compiler/mlir/lite/stablehlo/transforms/tf_stablehlo_pass.h, tensorflow/compiler/mlir/quantization/stablehlo/passes/replace_stablehlo_ops_in_main_function_with_xla_call_module_ops.cc, tensorflow/compiler/mlir/quantization/stablehlo/python/BUILD, tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/quantize_model_test.py, tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/quantize_model_test_base.py, tensorflow/compiler/mlir/quantization/stablehlo/tests/components/tf_to_stablehlo.mlir, tensorflow/compiler/mlir/quantization/stablehlo/tests/passes/replace_stablehlo_ops_in_main_function_with_xla_call_module_ops.mlir",tensorflower-gardener,False
"KV Cache takes a third argument for input positions

PiperOrigin-RevId: 622916928",T.J. Alumbaugh,talumbau@google.com,2024-04-08 19:11:58,"tensorflow/lite/experimental/genai/BUILD, tensorflow/lite/experimental/genai/kvcache.cc, tensorflow/lite/experimental/genai/kvcache_test.cc",talumbau,False
"[tsl:concurrency] Add helper functioms to block/await on AsyncValueRef and AsyncValuePtr

PiperOrigin-RevId: 622916859",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 19:11:41,"third_party/xla/third_party/tsl/tsl/concurrency/BUILD, third_party/xla/third_party/tsl/tsl/concurrency/async_value.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ptr_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc",ezhulenev,False
"Add unbounded dynamism test for GetTupleElementOp.

PiperOrigin-RevId: 622900026",Gunhyun Park,gunhyun@google.com,2024-04-08 18:08:30,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add an XNNPACK delegate for quantized `BatchMatMul`.

PiperOrigin-RevId: 622899529",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 18:06:57,"tensorflow/lite/delegates/xnnpack/BUILD, tensorflow/lite/delegates/xnnpack/batch_matrix_multiply_test.cc, tensorflow/lite/delegates/xnnpack/batch_matrix_multiply_tester.cc, tensorflow/lite/delegates/xnnpack/batch_matrix_multiply_tester.h, tensorflow/lite/delegates/xnnpack/test_util.cc, tensorflow/lite/delegates/xnnpack/xnnpack_delegate.cc, tensorflow/lite/tools/cmake/modules/xnnpack.cmake, tensorflow/workspace2.bzl",tensorflower-gardener,False
"#shlo_ref Fix I4 tests.

PiperOrigin-RevId: 622897344",Quentin Khan,qkhan@google.com,2024-04-08 17:59:26,tensorflow/lite/experimental/shlo/i4_test.cc,qukhan,False
"Automated Code Change

PiperOrigin-RevId: 622895586",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 17:53:46,tensorflow/python/data/experimental/kernel_tests/BUILD,tensorflower-gardener,False
"#shlo_ref Add F16 wrapper type

_Float16 is not available on the GCC until version 13, which is very recent. This change transforms the F16 into a wrapper type that will always be used regardless of compiler support. It defines conversion and arithmetic operators. If _Float16 is available, that will be used as the underlying type. If it is not, we'll use a uint16_t bits format and the FP16 library for converting between float and uint16_t.

PiperOrigin-RevId: 622885647",Quentin Khan,qkhan@google.com,2024-04-08 17:21:42,"tensorflow/lite/experimental/shlo/BUILD, tensorflow/lite/experimental/shlo/bf16.h, tensorflow/lite/experimental/shlo/f16.h, tensorflow/lite/experimental/shlo/f16_test.cc, tensorflow/lite/experimental/shlo/ops/binary_elementwise.h, tensorflow/lite/experimental/shlo/ops/unary_elementwise.h",qukhan,False
"Prepare move of CUDA compilation functionality

Currently PTX to SASS compilation functions are exported by the target `stream_executor/gpu:asm_compiler`, but implemented in `stream_executor/cuda:cuda_asm_compiler`.

I'm trying to clean this up by moving everything into `:cuda_asm_compiler`. Since we can't do atomic cross cutting changes between Jaxlib and XLA, I'm only preparing `:cuda_asm_compiler` as an alias for Jaxlib to depend on.

In a subsequent change I will move all the code over.

PiperOrigin-RevId: 622885343",Henning Becker,hebecker@google.com,2024-04-08 17:20:37,"third_party/xla/xla/stream_executor/cuda/BUILD, third_party/xla/xla/stream_executor/cuda/cuda_asm_compiler.h, third_party/xla/xla/stream_executor/gpu/BUILD",beckerhe,False
"[PJRT C API] Add a build rule for building the PJRT CPU plugin.

PiperOrigin-RevId: 622881057",Jieying Luo,jieying@google.com,2024-04-08 17:07:36,"third_party/xla/xla/pjrt/c/BUILD, third_party/xla/xla/pjrt/c/pjrt_c_api_cpu_version_script.lds",jyingl3,False
"Integrate LLVM at llvm/llvm-project@8ee6ab7f69ca

Updates LLVM usage to match
[8ee6ab7f69ca](https://github.com/llvm/llvm-project/commit/8ee6ab7f69ca)

PiperOrigin-RevId: 622846080",Krasimir Georgiev,krasimir@google.com,2024-04-08 15:00:48,third_party/llvm/workspace.bzl,krasimirgg,False
"[XLA:GPU][IndexAnalysis] Check if the scatter is canonicalized when computing thread indexing.

PiperOrigin-RevId: 622844576",Alexander Belyaev,pifon@google.com,2024-04-08 14:54:04,"third_party/xla/xla/service/gpu/fusions/BUILD, third_party/xla/xla/service/gpu/fusions/scatter_mlir.cc, third_party/xla/xla/service/scatter_simplifier.cc, third_party/xla/xla/service/scatter_simplifier.h",pifon2a,False
"[XLA:GPU][Coalescing] Add coalescing for ops with runtime vars.

Add tests for gather and dynamic slice.

PiperOrigin-RevId: 622835329",Alexander Belyaev,pifon@google.com,2024-04-08 14:12:56,"third_party/xla/xla/service/gpu/model/coalescing_analysis.cc, third_party/xla/xla/service/gpu/model/coalescing_analysis_test.cc",pifon2a,False
"Remove unecessary shape checks for FC.

The shape can be inferred by XNNPack

PiperOrigin-RevId: 622830253",Alan Kelly,alankelly@google.com,2024-04-08 13:49:46,tensorflow/lite/delegates/xnnpack/xnnpack_delegate.cc,alankelly,False
"Fix clang-14 build issue (reference to local binding declared in enclosing function)

PiperOrigin-RevId: 622809520",Sergey Kozub,sergeykozub@google.com,2024-04-08 12:06:09,"third_party/triton/sparse_dot_base.patch, third_party/xla/third_party/triton/sparse_dot_base.patch",sergeykozub,False
"Fix conditions for `tfl.batch_matmul` legalization and e2e tests.

This CL also:
* Adds TFLite op check to `QuantizationConfig` preset tests in ODML.

PiperOrigin-RevId: 622785644",Jiyoun (Jen) Ha,jiyounha@google.com,2024-04-08 10:04:55,"tensorflow/compiler/mlir/lite/stablehlo/transforms/uniform_quantized_stablehlo_to_tfl_pass.cc, tensorflow/compiler/mlir/quantization/common/BUILD, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.cc, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints.h, tensorflow/compiler/mlir/quantization/common/attrs_and_constraints_test.cc",chococigar,False
"Add unbounded dynamism test for TupleOp.

PiperOrigin-RevId: 622776101",Gunhyun Park,gunhyun@google.com,2024-04-08 09:18:43,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add unbounded dynamism test for WhileOp.

PiperOrigin-RevId: 622773485",Gunhyun Park,gunhyun@google.com,2024-04-08 09:07:22,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"compat: Update forward compatibility horizon to 2024-04-08

PiperOrigin-RevId: 622772519",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 09:03:23,tensorflow/python/compat/compat.py,tensorflower-gardener,False
"Update GraphDef version to 1826.

PiperOrigin-RevId: 622772087",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 09:02:00,tensorflow/core/public/version.h,tensorflower-gardener,False
"Add unbounded dynamism test for OptimizationBarrierOp.

PiperOrigin-RevId: 622770844",Gunhyun Park,gunhyun@google.com,2024-04-08 08:55:20,third_party/xla/xla/client/xla_builder_test.cc,ghpvnist,False
"Fix a bug in algebraic simplifier that incorrectly rewrites a broadcast to transpose.

PiperOrigin-RevId: 622740441",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 06:19:04,"third_party/xla/xla/service/algebraic_simplifier.cc, third_party/xla/xla/service/algebraic_simplifier_test.cc",tensorflower-gardener,False
"Removes useless friend declaration.

PiperOrigin-RevId: 622737150",Yunlong Liu,yunlongl@google.com,2024-04-08 05:58:39,"third_party/xla/xla/pjrt/BUILD, third_party/xla/xla/pjrt/host_memory_spaces.h",yliu120,False
"Reverts b0830a79c6298d29d56449f2e5717af385d3330c

PiperOrigin-RevId: 622736119",Laurent El Shafey,shafey@google.com,2024-04-08 05:51:15,"third_party/xla/xla/hlo/utils/hlo_sharding_util.cc, third_party/xla/xla/hlo/utils/hlo_sharding_util_test.cc, third_party/xla/xla/service/sharding_propagation_test.cc",laurentes,False
"Add unbounded dynamism test for SelectAndScatterOp.

PiperOrigin-RevId: 622731814",Gunhyun Park,gunhyun@google.com,2024-04-08 05:19:17,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"Add unbounded dynamism test for ShiftRightLogicalOp.

PiperOrigin-RevId: 622728312",Gunhyun Park,gunhyun@google.com,2024-04-08 04:56:02,"third_party/xla/xla/client/xla_builder_test.cc, third_party/xla/xla/service/shape_inference_test.cc",ghpvnist,False
"[tsl:concurrency] Add LLVM-style type casting to AsyncValueRef<T>

+ cleanup ref_count header and consistently use DerivedFrom helper

Coming-next: for rvalue references we can do Cast and DynCast by moving RCReference and save wasted AddRef/DropRef
PiperOrigin-RevId: 622723868",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 04:24:50,"third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/ref_count.h",ezhulenev,False
"[tsl:concurrency] Add LLVM-style type casting to AsyncValuePtr<T>

AsyncValueRef<T> type casting coming in followup CL, it will be a bit more tricky because it's not clear when to return a ref-copy and when to return a non-owning AsyncValuePtr.

PiperOrigin-RevId: 622718726",Eugene Zhulenev,ezhulenev@google.com,2024-04-08 03:47:38,"third_party/xla/third_party/tsl/tsl/concurrency/BUILD, third_party/xla/third_party/tsl/tsl/concurrency/async_value.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ptr_test.cc, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref.h, third_party/xla/third_party/tsl/tsl/concurrency/async_value_ref_test.cc",ezhulenev,False
"[xla] hlo_computation: drop instruction_indices_

It's redundant given that we have HloInstruction.index_in_parent_.
There is only one caller (a TF_RET_CHECK) that needs it; I think
we can survive without that check.

This reduces the size of the struct from 176 to 152 bytes.

While at it, move to_be_deleted_ up in the struct so that
instructions_, instruction_count_ and to_be_deleted_ are now
contiguous.

PiperOrigin-RevId: 622709022",Emilio Cota,ecg@google.com,2024-04-08 02:51:56,"third_party/xla/xla/hlo/ir/hlo_computation.cc, third_party/xla/xla/hlo/ir/hlo_computation.h",cota,False
"Unpack per-channel hybrid quantized MHLO ops to float ops

PiperOrigin-RevId: 622701097",Doyeon Kim,doyeonkim@google.com,2024-04-08 01:56:29,"tensorflow/compiler/mlir/quantization/stablehlo/python/integration_test/quantize_model_test.py, third_party/xla/xla/mlir_hlo/mhlo/transforms/mhlo_quant_legalize_to_int/mhlo_quant_legalize_to_int.cc, third_party/xla/xla/mlir_hlo/tests/Dialect/mhlo/mhlo-quant-legalize-to-int.mlir",doyeonkim0,False
"Automated Code Change

PiperOrigin-RevId: 622697590",A. Unique TensorFlower,gardener@tensorflow.org,2024-04-08 01:31:30,"tensorflow/compiler/mlir/lite/quantization/BUILD, tensorflow/compiler/mlir/lite/quantization/numerical_utils_test.cc, tensorflow/compiler/mlir/lite/quantization/quantization_context.cc, tensorflow/compiler/mlir/lite/quantization/quantization_context.h",tensorflower-gardener,False
